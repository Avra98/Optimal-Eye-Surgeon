(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '10.542749919107028'
(3, 512, 512) torch.Size([1, 3, 512, 512]) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/8/0.5/det/-0.8/1e-09
epoch:  0 quantization_loss:  0.047934167087078094
p mean is: tensor(-0.0001, device='cuda:4')
epoch:  1000 quantization_loss:  0.037639033049345016
p mean is: tensor(-0.0089, device='cuda:4')
epoch:  2000 quantization_loss:  0.03680049628019333
p mean is: tensor(-0.0163, device='cuda:4')
epoch:  3000 quantization_loss:  0.0358528271317482
p mean is: tensor(-0.0235, device='cuda:4')
epoch:  4000 quantization_loss:  0.03533695638179779
p mean is: tensor(-0.0304, device='cuda:4')
epoch:  5000 quantization_loss:  0.03225414827466011
p mean is: tensor(-0.0377, device='cuda:4')
epoch:  6000 quantization_loss:  0.03212166205048561
p mean is: tensor(-0.0461, device='cuda:4')
epoch:  7000 quantization_loss:  0.031693343073129654
p mean is: tensor(-0.0575, device='cuda:4')
epoch:  8000 quantization_loss:  0.0284896157681942
p mean is: tensor(-0.0725, device='cuda:4')
epoch:  9000 quantization_loss:  0.02638530172407627
p mean is: tensor(-0.0904, device='cuda:4')
epoch:  10000 quantization_loss:  0.024928472936153412
p mean is: tensor(-0.1124, device='cuda:4')
epoch:  11000 quantization_loss:  0.0243255402892828
p mean is: tensor(-0.1399, device='cuda:4')
epoch:  12000 quantization_loss:  0.022671638056635857
p mean is: tensor(-0.1739, device='cuda:4')
epoch:  13000 quantization_loss:  0.021874019876122475
p mean is: tensor(-0.2140, device='cuda:4')
epoch:  14000 quantization_loss:  0.02016323246061802
p mean is: tensor(-0.2588, device='cuda:4')
epoch:  15000 quantization_loss:  0.01976810395717621
p mean is: tensor(-0.3061, device='cuda:4')
epoch:  16000 quantization_loss:  0.01935436762869358
p mean is: tensor(-0.3545, device='cuda:4')
epoch:  17000 quantization_loss:  0.019064679741859436
p mean is: tensor(-0.4024, device='cuda:4')
epoch:  18000 quantization_loss:  0.018751416355371475
p mean is: tensor(-0.4477, device='cuda:4')
epoch:  19000 quantization_loss:  0.018464546650648117
p mean is: tensor(-0.4894, device='cuda:4')
epoch:  20000 quantization_loss:  0.01836131140589714
p mean is: tensor(-0.5270, device='cuda:4')
epoch:  21000 quantization_loss:  0.01832548715174198
p mean is: tensor(-0.5602, device='cuda:4')
epoch:  22000 quantization_loss:  0.01809399574995041
p mean is: tensor(-0.5893, device='cuda:4')
epoch:  23000 quantization_loss:  0.01797468401491642
p mean is: tensor(-0.6146, device='cuda:4')
epoch:  24000 quantization_loss:  0.017938386648893356
p mean is: tensor(-0.6366, device='cuda:4')
epoch:  25000 quantization_loss:  0.017809027805924416
p mean is: tensor(-0.6557, device='cuda:4')
epoch:  26000 quantization_loss:  0.017790919169783592
p mean is: tensor(-0.6721, device='cuda:4')
epoch:  27000 quantization_loss:  0.01773478277027607
p mean is: tensor(-0.6863, device='cuda:4')
epoch:  28000 quantization_loss:  0.017689425498247147
p mean is: tensor(-0.6986, device='cuda:4')
epoch:  29000 quantization_loss:  0.017666354775428772
p mean is: tensor(-0.7094, device='cuda:4')
epoch:  30000 quantization_loss:  0.017562922090291977
p mean is: tensor(-0.7187, device='cuda:4')
epoch:  31000 quantization_loss:  0.01754109375178814
p mean is: tensor(-0.7268, device='cuda:4')
epoch:  32000 quantization_loss:  0.017517250031232834
p mean is: tensor(-0.7339, device='cuda:4')
epoch:  33000 quantization_loss:  0.017488259822130203
p mean is: tensor(-0.7402, device='cuda:4')
epoch:  34000 quantization_loss:  0.01743653230369091
p mean is: tensor(-0.7457, device='cuda:4')
epoch:  35000 quantization_loss:  0.017443954944610596
p mean is: tensor(-0.7507, device='cuda:4')
epoch:  36000 quantization_loss:  0.017411895096302032
p mean is: tensor(-0.7550, device='cuda:4')
epoch:  37000 quantization_loss:  0.017400559037923813
p mean is: tensor(-0.7588, device='cuda:4')
epoch:  38000 quantization_loss:  0.01734749786555767
p mean is: tensor(-0.7624, device='cuda:4')
epoch:  39000 quantization_loss:  0.017336424440145493
p mean is: tensor(-0.7655, device='cuda:4')
epoch:  40000 quantization_loss:  0.01732267625629902
p mean is: tensor(-0.7683, device='cuda:4')
epoch:  41000 quantization_loss:  0.017290150746703148
p mean is: tensor(-0.7709, device='cuda:4')
epoch:  42000 quantization_loss:  0.01728905364871025
p mean is: tensor(-0.7732, device='cuda:4')
epoch:  43000 quantization_loss:  0.017279518768191338
p mean is: tensor(-0.7754, device='cuda:4')
epoch:  44000 quantization_loss:  0.017257148399949074
p mean is: tensor(-0.7774, device='cuda:4')
epoch:  45000 quantization_loss:  0.017244132235646248
p mean is: tensor(-0.7793, device='cuda:4')
epoch:  46000 quantization_loss:  0.017226237803697586
p mean is: tensor(-0.7809, device='cuda:4')
epoch:  47000 quantization_loss:  0.01723652333021164
p mean is: tensor(-0.7824, device='cuda:4')
epoch:  48000 quantization_loss:  0.017211657017469406
p mean is: tensor(-0.7839, device='cuda:4')
epoch:  49000 quantization_loss:  0.017210576683282852
p mean is: tensor(-0.7852, device='cuda:4')
epoch:  50000 quantization_loss:  0.01718984544277191
p mean is: tensor(-0.7865, device='cuda:4')
epoch:  51000 quantization_loss:  0.01719287782907486
p mean is: tensor(-0.7876, device='cuda:4')
epoch:  52000 quantization_loss:  0.017183499410748482
p mean is: tensor(-0.7888, device='cuda:4')
epoch:  53000 quantization_loss:  0.01717996597290039
p mean is: tensor(-0.7899, device='cuda:4')
epoch:  54000 quantization_loss:  0.01716851443052292
p mean is: tensor(-0.7910, device='cuda:4')
epoch:  55000 quantization_loss:  0.017171626910567284
p mean is: tensor(-0.7919, device='cuda:4')
epoch:  56000 quantization_loss:  0.017158901318907738
p mean is: tensor(-0.7929, device='cuda:4')
epoch:  57000 quantization_loss:  0.01715782657265663
p mean is: tensor(-0.7937, device='cuda:4')
epoch:  58000 quantization_loss:  0.01715465448796749
p mean is: tensor(-0.7946, device='cuda:4')
epoch:  59000 quantization_loss:  0.01715645007789135
p mean is: tensor(-0.7954, device='cuda:4')
epoch:  60000 quantization_loss:  0.017145277932286263
p mean is: tensor(-0.7961, device='cuda:4')
epoch:  61000 quantization_loss:  0.017147744074463844
p mean is: tensor(-0.7969, device='cuda:4')
epoch:  62000 quantization_loss:  0.017142878845334053
p mean is: tensor(-0.7976, device='cuda:4')
epoch:  63000 quantization_loss:  0.01713784970343113
p mean is: tensor(-0.7983, device='cuda:4')
epoch:  64000 quantization_loss:  0.01713322103023529
p mean is: tensor(-0.7990, device='cuda:4')
epoch:  65000 quantization_loss:  0.0171307735145092
p mean is: tensor(-0.7996, device='cuda:4')
epoch:  66000 quantization_loss:  0.017135629430413246
p mean is: tensor(-0.8002, device='cuda:4')
epoch:  67000 quantization_loss:  0.017128555104136467
p mean is: tensor(-0.8008, device='cuda:4')
epoch:  68000 quantization_loss:  0.017141830176115036
p mean is: tensor(-0.8014, device='cuda:4')
epoch:  69000 quantization_loss:  0.017124949023127556
p mean is: tensor(-0.8020, device='cuda:4')
epoch:  70000 quantization_loss:  0.017129087820649147
p mean is: tensor(-0.8025, device='cuda:4')
epoch:  71000 quantization_loss:  0.01712268777191639
p mean is: tensor(-0.8031, device='cuda:4')
epoch:  72000 quantization_loss:  0.017114710062742233
p mean is: tensor(-0.8036, device='cuda:4')
epoch:  73000 quantization_loss:  0.01711718738079071
p mean is: tensor(-0.8042, device='cuda:4')
epoch:  74000 quantization_loss:  0.017110832035541534
p mean is: tensor(-0.8047, device='cuda:4')
epoch:  75000 quantization_loss:  0.01711873523890972
p mean is: tensor(-0.8051, device='cuda:4')
epoch:  76000 quantization_loss:  0.01711266301572323
p mean is: tensor(-0.8056, device='cuda:4')
epoch:  77000 quantization_loss:  0.017109530046582222
p mean is: tensor(-0.8060, device='cuda:4')
epoch:  78000 quantization_loss:  0.01710963249206543
p mean is: tensor(-0.8065, device='cuda:4')
epoch:  79000 quantization_loss:  0.017116086557507515
p mean is: tensor(-0.8070, device='cuda:4')
here
1.1.1.weight         | nonzeros =    1156 /   12800             (  9.03%) | total_pruned =   11644 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =      11 /      16             ( 68.75%) | total_pruned =       5 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =     116 /    6400             (  1.81%) | total_pruned =    6284 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       3 /      16             ( 18.75%) | total_pruned =      13 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =      89 /   12800             (  0.70%) | total_pruned =   12711 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =       9 /      32             ( 28.12%) | total_pruned =      23 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =     197 /   25600             (  0.77%) | total_pruned =   25403 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       7 /      32             ( 21.88%) | total_pruned =      25 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =     216 /   51200             (  0.42%) | total_pruned =   50984 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      24 /      64             ( 37.50%) | total_pruned =      40 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =     314 /  102400             (  0.31%) | total_pruned =  102086 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      18 /      64             ( 28.12%) | total_pruned =      46 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =     133 /  204800             (  0.06%) | total_pruned =  204667 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      66 /     128             ( 51.56%) | total_pruned =      62 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =     213 /  409600             (  0.05%) | total_pruned =  409387 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      67 /     128             ( 52.34%) | total_pruned =      61 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =     352 /  409600             (  0.09%) | total_pruned =  409248 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    3874 /  409600             (  0.95%) | total_pruned =  405726 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      97 /     128             ( 75.78%) | total_pruned =      31 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   12633 /  409600             (  3.08%) | total_pruned =  396967 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     105 /     128             ( 82.03%) | total_pruned =      23 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   34981 /  409600             (  8.54%) | total_pruned =  374619 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   28653 /  147456             ( 19.43%) | total_pruned =  118803 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   26290 /  147456             ( 17.83%) | total_pruned =  121166 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   21336 /  147456             ( 14.47%) | total_pruned =  126120 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      69 /     128             ( 53.91%) | total_pruned =      59 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      69 /     128             ( 53.91%) | total_pruned =      59 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    9027 /   73728             ( 12.24%) | total_pruned =   64701 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2670 /   18432             ( 14.49%) | total_pruned =   15762 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1230 /    4608             ( 26.69%) | total_pruned =    3378 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      26 /      48             ( 54.17%) | total_pruned =      22 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       2 /       3             ( 66.67%) | total_pruned =       1 | shape = torch.Size([3])
alive: 144762, pruned : 2864105, total: 3008867, Compression rate :      20.78x  ( 95.19% pruned)
PSNR of output image is:  14.629997213322714
Experiment done
