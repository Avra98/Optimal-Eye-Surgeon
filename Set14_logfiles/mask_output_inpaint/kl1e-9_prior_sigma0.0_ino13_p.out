(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '7.898016276851473'
(3, 512, 512) torch.Size([1, 3, 512, 512]) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/13/0.5/det/0.0/1e-09
epoch:  0 quantization_loss:  0.026574324816465378
p mean is: tensor(-3.2343e-06, device='cuda:2')
epoch:  1000 quantization_loss:  0.019595010206103325
p mean is: tensor(6.5484e-05, device='cuda:2')
epoch:  2000 quantization_loss:  0.019374964758753777
p mean is: tensor(4.4282e-05, device='cuda:2')
epoch:  3000 quantization_loss:  0.01870596595108509
p mean is: tensor(-4.3846e-05, device='cuda:2')
epoch:  4000 quantization_loss:  0.018478812649846077
p mean is: tensor(4.1318e-05, device='cuda:2')
epoch:  5000 quantization_loss:  0.018602151423692703
p mean is: tensor(3.4272e-05, device='cuda:2')
epoch:  6000 quantization_loss:  0.018127113580703735
p mean is: tensor(2.1954e-05, device='cuda:2')
epoch:  7000 quantization_loss:  0.01809004880487919
p mean is: tensor(-0.0003, device='cuda:2')
epoch:  8000 quantization_loss:  0.01821107789874077
p mean is: tensor(-0.0007, device='cuda:2')
epoch:  9000 quantization_loss:  0.01717590168118477
p mean is: tensor(-0.0012, device='cuda:2')
epoch:  10000 quantization_loss:  0.01528914924710989
p mean is: tensor(-0.0015, device='cuda:2')
epoch:  11000 quantization_loss:  0.013574165292084217
p mean is: tensor(-0.0021, device='cuda:2')
epoch:  12000 quantization_loss:  0.011457584798336029
p mean is: tensor(-0.0025, device='cuda:2')
epoch:  13000 quantization_loss:  0.008733700960874557
p mean is: tensor(-0.0030, device='cuda:2')
epoch:  14000 quantization_loss:  0.007989919744431973
p mean is: tensor(-0.0034, device='cuda:2')
epoch:  15000 quantization_loss:  0.007864268496632576
p mean is: tensor(-0.0035, device='cuda:2')
epoch:  16000 quantization_loss:  0.0073775784112513065
p mean is: tensor(-0.0035, device='cuda:2')
epoch:  17000 quantization_loss:  0.007011414505541325
p mean is: tensor(-0.0034, device='cuda:2')
epoch:  18000 quantization_loss:  0.006770364940166473
p mean is: tensor(-0.0030, device='cuda:2')
epoch:  19000 quantization_loss:  0.006550528574734926
p mean is: tensor(-0.0025, device='cuda:2')
epoch:  20000 quantization_loss:  0.006390666589140892
p mean is: tensor(-0.0021, device='cuda:2')
epoch:  21000 quantization_loss:  0.0058798473328351974
p mean is: tensor(-0.0014, device='cuda:2')
epoch:  22000 quantization_loss:  0.0065848869271576405
p mean is: tensor(-0.0007, device='cuda:2')
epoch:  23000 quantization_loss:  0.005632894113659859
p mean is: tensor(-4.8581e-05, device='cuda:2')
epoch:  24000 quantization_loss:  0.005624343175441027
p mean is: tensor(0.0007, device='cuda:2')
epoch:  25000 quantization_loss:  0.005512996111065149
p mean is: tensor(0.0014, device='cuda:2')
epoch:  26000 quantization_loss:  0.005479822866618633
p mean is: tensor(0.0020, device='cuda:2')
epoch:  27000 quantization_loss:  0.005434415303170681
p mean is: tensor(0.0026, device='cuda:2')
epoch:  28000 quantization_loss:  0.005428004078567028
p mean is: tensor(0.0031, device='cuda:2')
epoch:  29000 quantization_loss:  0.005354895722121
p mean is: tensor(0.0035, device='cuda:2')
epoch:  30000 quantization_loss:  0.005313831847161055
p mean is: tensor(0.0039, device='cuda:2')
epoch:  31000 quantization_loss:  0.005299240816384554
p mean is: tensor(0.0043, device='cuda:2')
epoch:  32000 quantization_loss:  0.005275728181004524
p mean is: tensor(0.0045, device='cuda:2')
epoch:  33000 quantization_loss:  0.0052904910407960415
p mean is: tensor(0.0047, device='cuda:2')
epoch:  34000 quantization_loss:  0.005240150261670351
p mean is: tensor(0.0050, device='cuda:2')
epoch:  35000 quantization_loss:  0.00522058829665184
p mean is: tensor(0.0052, device='cuda:2')
epoch:  36000 quantization_loss:  0.005190273746848106
p mean is: tensor(0.0052, device='cuda:2')
epoch:  37000 quantization_loss:  0.005175750236958265
p mean is: tensor(0.0054, device='cuda:2')
epoch:  38000 quantization_loss:  0.00516856275498867
p mean is: tensor(0.0055, device='cuda:2')
epoch:  39000 quantization_loss:  0.0051711625419557095
p mean is: tensor(0.0056, device='cuda:2')
epoch:  40000 quantization_loss:  0.0051309941336512566
p mean is: tensor(0.0057, device='cuda:2')
epoch:  41000 quantization_loss:  0.005130286328494549
p mean is: tensor(0.0057, device='cuda:2')
epoch:  42000 quantization_loss:  0.00511273555457592
p mean is: tensor(0.0057, device='cuda:2')
epoch:  43000 quantization_loss:  0.005098552908748388
p mean is: tensor(0.0058, device='cuda:2')
epoch:  44000 quantization_loss:  0.00509518850594759
p mean is: tensor(0.0057, device='cuda:2')
epoch:  45000 quantization_loss:  0.005105503834784031
p mean is: tensor(0.0057, device='cuda:2')
epoch:  46000 quantization_loss:  0.005082286894321442
p mean is: tensor(0.0057, device='cuda:2')
epoch:  47000 quantization_loss:  0.0050775595009326935
p mean is: tensor(0.0057, device='cuda:2')
epoch:  48000 quantization_loss:  0.0050987303256988525
p mean is: tensor(0.0057, device='cuda:2')
epoch:  49000 quantization_loss:  0.005052284337580204
p mean is: tensor(0.0057, device='cuda:2')
epoch:  50000 quantization_loss:  0.0050537786446511745
p mean is: tensor(0.0056, device='cuda:2')
epoch:  51000 quantization_loss:  0.005042726639658213
p mean is: tensor(0.0056, device='cuda:2')
epoch:  52000 quantization_loss:  0.005047616083174944
p mean is: tensor(0.0055, device='cuda:2')
epoch:  53000 quantization_loss:  0.005035680718719959
p mean is: tensor(0.0054, device='cuda:2')
epoch:  54000 quantization_loss:  0.005024648737162352
p mean is: tensor(0.0053, device='cuda:2')
epoch:  55000 quantization_loss:  0.005028878804296255
p mean is: tensor(0.0053, device='cuda:2')
epoch:  56000 quantization_loss:  0.005012237932533026
p mean is: tensor(0.0053, device='cuda:2')
epoch:  57000 quantization_loss:  0.005011777859181166
p mean is: tensor(0.0052, device='cuda:2')
epoch:  58000 quantization_loss:  0.005010118708014488
p mean is: tensor(0.0051, device='cuda:2')
epoch:  59000 quantization_loss:  0.00500079058110714
p mean is: tensor(0.0051, device='cuda:2')
epoch:  60000 quantization_loss:  0.005008075386285782
p mean is: tensor(0.0051, device='cuda:2')
epoch:  61000 quantization_loss:  0.005001355428248644
p mean is: tensor(0.0051, device='cuda:2')
epoch:  62000 quantization_loss:  0.004993126727640629
p mean is: tensor(0.0050, device='cuda:2')
epoch:  63000 quantization_loss:  0.005088945385068655
p mean is: tensor(0.0050, device='cuda:2')
epoch:  64000 quantization_loss:  0.00498849106952548
p mean is: tensor(0.0050, device='cuda:2')
epoch:  65000 quantization_loss:  0.004987569060176611
p mean is: tensor(0.0050, device='cuda:2')
epoch:  66000 quantization_loss:  0.004993352573364973
p mean is: tensor(0.0049, device='cuda:2')
epoch:  67000 quantization_loss:  0.004987165331840515
p mean is: tensor(0.0049, device='cuda:2')
epoch:  68000 quantization_loss:  0.0050156391225755215
p mean is: tensor(0.0048, device='cuda:2')
epoch:  69000 quantization_loss:  0.004974342882633209
p mean is: tensor(0.0048, device='cuda:2')
epoch:  70000 quantization_loss:  0.004977733828127384
p mean is: tensor(0.0048, device='cuda:2')
epoch:  71000 quantization_loss:  0.004984080325812101
p mean is: tensor(0.0047, device='cuda:2')
epoch:  72000 quantization_loss:  0.004973051603883505
p mean is: tensor(0.0047, device='cuda:2')
epoch:  73000 quantization_loss:  0.004977199714630842
p mean is: tensor(0.0046, device='cuda:2')
epoch:  74000 quantization_loss:  0.004970991052687168
p mean is: tensor(0.0046, device='cuda:2')
epoch:  75000 quantization_loss:  0.00497652031481266
p mean is: tensor(0.0046, device='cuda:2')
epoch:  76000 quantization_loss:  0.00496872840449214
p mean is: tensor(0.0045, device='cuda:2')
epoch:  77000 quantization_loss:  0.004965612199157476
p mean is: tensor(0.0045, device='cuda:2')
epoch:  78000 quantization_loss:  0.004961969330906868
p mean is: tensor(0.0044, device='cuda:2')
epoch:  79000 quantization_loss:  0.004962788429111242
p mean is: tensor(0.0044, device='cuda:2')
here
1.1.1.weight         | nonzeros =    6529 /   12800             ( 51.01%) | total_pruned =    6271 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =      10 /      16             ( 62.50%) | total_pruned =       6 | shape = torch.Size([16])
1.2.weight           | nonzeros =       4 /      16             ( 25.00%) | total_pruned =      12 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    3125 /    6400             ( 48.83%) | total_pruned =    3275 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       5 /      16             ( 31.25%) | total_pruned =      11 | shape = torch.Size([16])
1.5.weight           | nonzeros =       8 /      16             ( 50.00%) | total_pruned =       8 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    6413 /   12800             ( 50.10%) | total_pruned =    6387 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       1 /      32             (  3.12%) | total_pruned =      31 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      15 /      32             ( 46.88%) | total_pruned =      17 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =   12927 /   25600             ( 50.50%) | total_pruned =   12673 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       1 /      32             (  3.12%) | total_pruned =      31 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   25543 /   51200             ( 49.89%) | total_pruned =   25657 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      28 /      64             ( 43.75%) | total_pruned =      36 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =   51392 /  102400             ( 50.19%) | total_pruned =   51008 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      36 /      64             ( 56.25%) | total_pruned =      28 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =  102759 /  204800             ( 50.18%) | total_pruned =  102041 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      67 /     128             ( 52.34%) | total_pruned =      61 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =  204598 /  409600             ( 49.95%) | total_pruned =  205002 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      71 /     128             ( 55.47%) | total_pruned =      57 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  202201 /  409600             ( 49.37%) | total_pruned =  207399 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      86 /     128             ( 67.19%) | total_pruned =      42 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  195845 /  409600             ( 47.81%) | total_pruned =  213755 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  194565 /  409600             ( 47.50%) | total_pruned =  215035 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      98 /     128             ( 76.56%) | total_pruned =      30 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  191576 /  409600             ( 46.77%) | total_pruned =  218024 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      95 /     128             ( 74.22%) | total_pruned =      33 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   67310 /  147456             ( 45.65%) | total_pruned =   80146 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       7 /     128             (  5.47%) | total_pruned =     121 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      93 /     128             ( 72.66%) | total_pruned =      35 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   63572 /  147456             ( 43.11%) | total_pruned =   83884 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      17 /     128             ( 13.28%) | total_pruned =     111 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      74 /     128             ( 57.81%) | total_pruned =      54 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      72 /     128             ( 56.25%) | total_pruned =      56 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   56690 /  147456             ( 38.45%) | total_pruned =   90766 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      13 /     128             ( 10.16%) | total_pruned =     115 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      66 /     128             ( 51.56%) | total_pruned =      62 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      64 /     128             ( 50.00%) | total_pruned =      64 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   29083 /   73728             ( 39.45%) | total_pruned =   44645 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      17 /      64             ( 26.56%) | total_pruned =      47 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      40 /      64             ( 62.50%) | total_pruned =      24 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      39 /      64             ( 60.94%) | total_pruned =      25 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    8028 /   18432             ( 43.55%) | total_pruned =   10404 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      14 /      32             ( 43.75%) | total_pruned =      18 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      23 /      32             ( 71.88%) | total_pruned =       9 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      23 /      32             ( 71.88%) | total_pruned =       9 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    2138 /    4608             ( 46.40%) | total_pruned =    2470 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
4.weight             | nonzeros =      15 /      16             ( 93.75%) | total_pruned =       1 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      29 /      48             ( 60.42%) | total_pruned =      19 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       1 /       3             ( 33.33%) | total_pruned =       2 | shape = torch.Size([3])
alive: 1425721, pruned : 1583146, total: 3008867, Compression rate :       2.11x  ( 52.62% pruned)
PSNR of output image is:  19.66001024915429
Experiment done
