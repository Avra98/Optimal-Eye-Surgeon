Starting random mask  training on 4 using ADAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '19.75117546655436'
1.1.1.weight         | nonzeros =    2576 /   12800             ( 20.12%) | total_pruned =   10224 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       2 /      16             ( 12.50%) | total_pruned =      14 | shape = torch.Size([16])
1.2.weight           | nonzeros =       2 /      16             ( 12.50%) | total_pruned =      14 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    1290 /    6400             ( 20.16%) | total_pruned =    5110 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       2 /      16             ( 12.50%) | total_pruned =      14 | shape = torch.Size([16])
1.5.weight           | nonzeros =       3 /      16             ( 18.75%) | total_pruned =      13 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    2637 /   12800             ( 20.60%) | total_pruned =   10163 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       7 /      32             ( 21.88%) | total_pruned =      25 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      10 /      32             ( 31.25%) | total_pruned =      22 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =    5103 /   25600             ( 19.93%) | total_pruned =   20497 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       5 /      32             ( 15.62%) | total_pruned =      27 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       6 /      32             ( 18.75%) | total_pruned =      26 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   10248 /   51200             ( 20.02%) | total_pruned =   40952 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      12 /      64             ( 18.75%) | total_pruned =      52 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =       9 /      64             ( 14.06%) | total_pruned =      55 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =   20539 /  102400             ( 20.06%) | total_pruned =   81861 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =      13 /      64             ( 20.31%) | total_pruned =      51 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      15 /      64             ( 23.44%) | total_pruned =      49 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =   40957 /  204800             ( 20.00%) | total_pruned =  163843 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      22 /     128             ( 17.19%) | total_pruned =     106 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =   82350 /  409600             ( 20.10%) | total_pruned =  327250 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =      22 /     128             ( 17.19%) | total_pruned =     106 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      26 /     128             ( 20.31%) | total_pruned =     102 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   81643 /  409600             ( 19.93%) | total_pruned =  327957 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =      22 /     128             ( 17.19%) | total_pruned =     106 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   81820 /  409600             ( 19.98%) | total_pruned =  327780 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =      28 /     128             ( 21.88%) | total_pruned =     100 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      31 /     128             ( 24.22%) | total_pruned =      97 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   81737 /  409600             ( 19.96%) | total_pruned =  327863 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   81678 /  409600             ( 19.94%) | total_pruned =  327922 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      36 /     128             ( 28.12%) | total_pruned =      92 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      34 /     128             ( 26.56%) | total_pruned =      94 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   29580 /  147456             ( 20.06%) | total_pruned =  117876 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      37 /     128             ( 28.91%) | total_pruned =      91 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   29468 /  147456             ( 19.98%) | total_pruned =  117988 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      31 /     128             ( 24.22%) | total_pruned =      97 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   29541 /  147456             ( 20.03%) | total_pruned =  117915 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      20 /     128             ( 15.62%) | total_pruned =     108 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      24 /     128             ( 18.75%) | total_pruned =     104 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   14773 /   73728             ( 20.04%) | total_pruned =   58955 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      19 /      64             ( 29.69%) | total_pruned =      45 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      15 /      64             ( 23.44%) | total_pruned =      49 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      16 /      64             ( 25.00%) | total_pruned =      48 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    3739 /   18432             ( 20.29%) | total_pruned =   14693 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       4 /      32             ( 12.50%) | total_pruned =      28 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =       5 /      32             ( 15.62%) | total_pruned =      27 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =       5 /      32             ( 15.62%) | total_pruned =      27 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =     930 /    4608             ( 20.18%) | total_pruned =    3678 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       6 /      16             ( 37.50%) | total_pruned =      10 | shape = torch.Size([16])
4.weight             | nonzeros =       4 /      16             ( 25.00%) | total_pruned =      12 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      13 /      48             ( 27.08%) | total_pruned =      35 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       2 /       3             ( 66.67%) | total_pruned =       1 | shape = torch.Size([3])
alive: 601354, pruned : 2407513, total: 3008867, Compression rate :       5.00x  ( 80.01% pruned)
Initial PSNR of output image is:  12.154568340064515
epoch:  0 loss:  0.06305575370788574 PSNR:  12.154568340064515
epoch:  200 loss:  0.03989169001579285 PSNR:  14.608217292169742
epoch:  400 loss:  0.041171714663505554 PSNR:  14.435318335151342
epoch:  600 loss:  0.03897826373577118 PSNR:  14.748992553768577
epoch:  800 loss:  0.0388004295527935 PSNR:  14.77554882767523
epoch:  1000 loss:  0.03875076025724411 PSNR:  14.783274375219005
epoch:  1200 loss:  0.03867003321647644 PSNR:  14.796321561414967
epoch:  1400 loss:  0.03862332925200462 PSNR:  14.801802267836115
epoch:  1600 loss:  0.03859435394406319 PSNR:  14.807207574568725
epoch:  1800 loss:  0.03858024999499321 PSNR:  14.808761687666143
epoch:  2000 loss:  0.03861349821090698 PSNR:  14.804206903133919
epoch:  2200 loss:  0.038609474897384644 PSNR:  14.804857759759065
epoch:  2400 loss:  0.03863837569952011 PSNR:  14.80083905007692
epoch:  2600 loss:  0.03854215890169144 PSNR:  14.814475297625442
epoch:  2800 loss:  0.038526635617017746 PSNR:  14.817791647505754
epoch:  3000 loss:  0.03857309743762016 PSNR:  14.810412879668815
epoch:  3200 loss:  0.03847426176071167 PSNR:  14.825848168914817
epoch:  3400 loss:  0.038426026701927185 PSNR:  14.832855278591136
epoch:  3600 loss:  0.03846541792154312 PSNR:  14.826662476375095
epoch:  3800 loss:  0.03849373012781143 PSNR:  14.821685688638448
epoch:  4000 loss:  0.038419466465711594 PSNR:  14.833900254159653
epoch:  4200 loss:  0.038408100605010986 PSNR:  14.835302879184479
epoch:  4400 loss:  0.03899570554494858 PSNR:  14.742868580166778
epoch:  4600 loss:  0.0388677716255188 PSNR:  14.76217792477712
epoch:  4800 loss:  0.038822613656520844 PSNR:  14.768622726693046
epoch:  5000 loss:  0.03872767090797424 PSNR:  14.783596470128215
epoch:  5200 loss:  0.03866630047559738 PSNR:  14.793154259195651
epoch:  5400 loss:  0.03865198418498039 PSNR:  14.7960050253237
epoch:  5600 loss:  0.038622092455625534 PSNR:  14.801003188988691
epoch:  5800 loss:  0.03864743560552597 PSNR:  14.79662836327352
epoch:  6000 loss:  0.03863462433218956 PSNR:  14.799369401547642
epoch:  6200 loss:  0.03856294974684715 PSNR:  14.810490643074491
epoch:  6400 loss:  0.03856275975704193 PSNR:  14.809513535580923
epoch:  6600 loss:  0.03855534642934799 PSNR:  14.811417385510136
epoch:  6800 loss:  0.03851497173309326 PSNR:  14.81765002264682
epoch:  7000 loss:  0.03861715644598007 PSNR:  14.801225396837081
epoch:  7200 loss:  0.0384565070271492 PSNR:  14.826590972755485
epoch:  7400 loss:  0.038456495851278305 PSNR:  14.826161157102424
epoch:  7600 loss:  0.038455571979284286 PSNR:  14.82667857849764
epoch:  7800 loss:  0.03843197226524353 PSNR:  14.83048444734947
epoch:  8000 loss:  0.03842737525701523 PSNR:  14.831143352278264
epoch:  8200 loss:  0.03850771486759186 PSNR:  14.81875509146716
epoch:  8400 loss:  0.03846512734889984 PSNR:  14.825395781216542
epoch:  8600 loss:  0.03841422498226166 PSNR:  14.833185445112129
epoch:  8800 loss:  0.03844092786312103 PSNR:  14.829813898415384
epoch:  9000 loss:  0.038402706384658813 PSNR:  14.834381962402453
epoch:  9200 loss:  0.03838876634836197 PSNR:  14.836971854834648
epoch:  9400 loss:  0.03836539387702942 PSNR:  14.840996772869628
epoch:  9600 loss:  0.038399502635002136 PSNR:  14.83616901444767
epoch:  9800 loss:  0.0383714996278286 PSNR:  14.839520591184352
epoch:  10000 loss:  0.038444213569164276 PSNR:  14.828908343699991
epoch:  10200 loss:  0.03836716711521149 PSNR:  14.840708724727925
epoch:  10400 loss:  0.03837784379720688 PSNR:  14.838691554127994
epoch:  10600 loss:  0.038399502635002136 PSNR:  14.83505075606849
epoch:  10800 loss:  0.038413796573877335 PSNR:  14.833432266448277
epoch:  11000 loss:  0.03837081044912338 PSNR:  14.839870427159475
epoch:  11200 loss:  0.03836981952190399 PSNR:  14.839735197705856
epoch:  11400 loss:  0.03847499191761017 PSNR:  14.824496602777494
epoch:  11600 loss:  0.03838896378874779 PSNR:  14.8374643005644
epoch:  11800 loss:  0.038344353437423706 PSNR:  14.843927351974113
epoch:  12000 loss:  0.03836888074874878 PSNR:  14.840312005285414
epoch:  12200 loss:  0.03835365176200867 PSNR:  14.842105881840254
epoch:  12400 loss:  0.038339585065841675 PSNR:  14.844525817799115
epoch:  12600 loss:  0.03834405913949013 PSNR:  14.843450337322679
epoch:  12800 loss:  0.03837777301669121 PSNR:  14.838699217001086
epoch:  13000 loss:  0.03835785388946533 PSNR:  14.842460856540809
epoch:  13200 loss:  0.038386255502700806 PSNR:  14.837775117278857
epoch:  13400 loss:  0.03833503648638725 PSNR:  14.845196449603
epoch:  13600 loss:  0.03833388537168503 PSNR:  14.8451758933505
epoch:  13800 loss:  0.03835443779826164 PSNR:  14.842469895627275
epoch:  14000 loss:  0.038325436413288116 PSNR:  14.846946554535336
epoch:  14200 loss:  0.03832194581627846 PSNR:  14.847413258628013
epoch:  14400 loss:  0.03833897411823273 PSNR:  14.84468476489079
epoch:  14600 loss:  0.03836493194103241 PSNR:  14.8409474857111
epoch:  14800 loss:  0.03834883123636246 PSNR:  14.843546229225336
epoch:  15000 loss:  0.03834586963057518 PSNR:  14.843998593581297
epoch:  15200 loss:  0.03836974501609802 PSNR:  14.840103119274001
epoch:  15400 loss:  0.038319166749715805 PSNR:  14.84787260804307
epoch:  15600 loss:  0.038325365632772446 PSNR:  14.847089412212657
epoch:  15800 loss:  0.038356758654117584 PSNR:  14.842141487561214
epoch:  16000 loss:  0.03833974525332451 PSNR:  14.844257539266184
epoch:  16200 loss:  0.03833149001002312 PSNR:  14.845522073620216
epoch:  16400 loss:  0.038354694843292236 PSNR:  14.84250796956162
epoch:  16600 loss:  0.0383281484246254 PSNR:  14.846643031844817
epoch:  16800 loss:  0.038310348987579346 PSNR:  14.84912475329667
epoch:  17000 loss:  0.03831232339143753 PSNR:  14.848747837425334
epoch:  17200 loss:  0.038327656686306 PSNR:  14.846341449459198
epoch:  17400 loss:  0.03829941153526306 PSNR:  14.85044394209607
epoch:  17600 loss:  0.03829225152730942 PSNR:  14.85203309789306
epoch:  17800 loss:  0.0394754521548748 PSNR:  14.67561901449385
epoch:  18000 loss:  0.03832497075200081 PSNR:  14.84653254059454
epoch:  18200 loss:  0.038342200219631195 PSNR:  14.844345776137507
epoch:  18400 loss:  0.038330044597387314 PSNR:  14.845998219352463
epoch:  18600 loss:  0.03830030560493469 PSNR:  14.850589384685852
epoch:  18800 loss:  0.03830615431070328 PSNR:  14.849766737725858
epoch:  19000 loss:  0.038314055651426315 PSNR:  14.848806265472575
epoch:  19200 loss:  0.03833705931901932 PSNR:  14.845159722500238
epoch:  19400 loss:  0.03833557292819023 PSNR:  14.84607059149512
epoch:  19600 loss:  0.03829360008239746 PSNR:  14.851275500320265
epoch:  19800 loss:  0.03829794377088547 PSNR:  14.851226370837976
Output directory: data/denoising/Set14/mask/4/pai_ceil/rand_global/sparse_0.8
PSNR of output image is:  14.851226370837976
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
