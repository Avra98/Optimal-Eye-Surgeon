(3, 512, 512)
Starting random mask  training on 2 using ADAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '20.437370885444853'
Pruning with threshold : 0.024268640205264085
1.1.1.weight         | nonzeros =    4006 /   12800             ( 31.30%) | total_pruned =    8794 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.2.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    3233 /    6400             ( 50.52%) | total_pruned =    3167 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.5.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    6594 /   12800             ( 51.52%) | total_pruned =    6206 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      22 /      32             ( 68.75%) | total_pruned =      10 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =    8010 /   25600             ( 31.29%) | total_pruned =   17590 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       8 /      32             ( 25.00%) | total_pruned =      24 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   15953 /   51200             ( 31.16%) | total_pruned =   35247 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      19 /      64             ( 29.69%) | total_pruned =      45 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =    2984 /  102400             (  2.91%) | total_pruned =   99416 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       1 /      64             (  1.56%) | total_pruned =      63 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =    5972 /  204800             (  2.92%) | total_pruned =  198828 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       6 /     128             (  4.69%) | total_pruned =     122 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25827 /  147456             ( 17.52%) | total_pruned =  121629 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25970 /  147456             ( 17.61%) | total_pruned =  121486 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   26027 /  147456             ( 17.65%) | total_pruned =  121429 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      27 /     128             ( 21.09%) | total_pruned =     101 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   13051 /   73728             ( 17.70%) | total_pruned =   60677 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      12 /      64             ( 18.75%) | total_pruned =      52 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    7730 /   18432             ( 41.94%) | total_pruned =   10702 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      14 /      32             ( 43.75%) | total_pruned =      18 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    2653 /    4608             ( 57.57%) | total_pruned =    1955 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =      12 /      16             ( 75.00%) | total_pruned =       4 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      46 /      48             ( 95.83%) | total_pruned =       2 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       3 /       3             (100.00%) | total_pruned =       0 | shape = torch.Size([3])
alive: 150338, pruned : 2858529, total: 3008867, Compression rate :      20.01x  ( 95.00% pruned)
Initial PSNR of output image is:  10.764570135738758
epoch:  0 loss:  0.08934596180915833 PSNR:  10.764570135738758
epoch:  200 loss:  0.06602239608764648 PSNR:  12.224841851952808
epoch:  400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  1000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  1200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  1400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  1600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  1800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  2000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  2200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  2400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  2600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  2800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  3000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  3200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  3400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  3600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  3800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  4000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  4200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  4400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  4600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  4800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  5000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  5200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  5400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  5600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  5800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  6000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  6200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  6400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  6600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  6800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  7000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  7200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  7400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  7600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  7800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  8000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  8200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  8400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  8600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  8800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  9000 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  9200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  9400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  9600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  9800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  10000 loss:  0.06602233648300171 PSNR:  12.224920164352383
epoch:  10200 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  10400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  10600 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  10800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  11000 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  11200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  11400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  11600 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  11800 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  12000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  12200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  12400 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  12600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  12800 loss:  0.06602233648300171 PSNR:  12.224925025168558
epoch:  13000 loss:  0.06602233648300171 PSNR:  12.224928265715695
epoch:  13200 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  13400 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  13600 loss:  0.06602233648300171 PSNR:  12.22492880580712
epoch:  13800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  14000 loss:  0.06602233648300171 PSNR:  12.224924755123073
epoch:  14200 loss:  0.0660223439335823 PSNR:  12.224923404895895
epoch:  14400 loss:  0.06602233648300171 PSNR:  12.224921784623836
epoch:  14600 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  14800 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  15000 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  15200 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  15400 loss:  0.06602233648300171 PSNR:  12.22492772562434
epoch:  15600 loss:  0.0660223439335823 PSNR:  12.224906392069435
epoch:  15800 loss:  0.06602233648300171 PSNR:  12.22491314318307
epoch:  16000 loss:  0.06602233648300171 PSNR:  12.224929885990171
epoch:  16200 loss:  0.06602233648300171 PSNR:  12.224916113676393
epoch:  16400 loss:  0.06602233648300171 PSNR:  12.224904501759497
epoch:  16600 loss:  0.06602233648300171 PSNR:  12.22491152291484
epoch:  16800 loss:  0.06602233648300171 PSNR:  12.224927185533048
epoch:  17000 loss:  0.0660223439335823 PSNR:  12.224919354216883
epoch:  17200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  17400 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  17600 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  17800 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  18000 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  18200 loss:  0.0660223588347435 PSNR:  12.224925565259579
epoch:  18400 loss:  0.06602233648300171 PSNR:  12.224925835305116
epoch:  18600 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  18800 loss:  0.06602233648300171 PSNR:  12.224921784623836
epoch:  19000 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  19200 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  19400 loss:  0.0660223737359047 PSNR:  12.224860754816518
epoch:  19600 loss:  0.06602233648300171 PSNR:  12.224921244533284
epoch:  19800 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  20000 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  20200 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  20400 loss:  0.06602233648300171 PSNR:  12.224920704442802
epoch:  20600 loss:  0.06602233648300171 PSNR:  12.224913683272614
epoch:  20800 loss:  0.06602233648300171 PSNR:  12.224925835305116
epoch:  21000 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  21200 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  21400 loss:  0.06602233648300171 PSNR:  12.2249244850776
epoch:  21600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  21800 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  22000 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  22200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  22400 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  22600 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  22800 loss:  0.0660223662853241 PSNR:  12.224926645441824
epoch:  23000 loss:  0.0660223588347435 PSNR:  12.224917193856289
epoch:  23200 loss:  0.06602233648300171 PSNR:  12.224934206725065
epoch:  23400 loss:  0.06602233648300171 PSNR:  12.224917463901303
epoch:  23600 loss:  0.0660223513841629 PSNR:  12.224922594759791
epoch:  23800 loss:  0.06602233648300171 PSNR:  12.224925565259579
epoch:  24000 loss:  0.06602233648300171 PSNR:  12.224920434397584
epoch:  24200 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  24400 loss:  0.06602233648300171 PSNR:  12.22491152291484
epoch:  24600 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  24800 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  25000 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  25200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  25400 loss:  0.06602233648300171 PSNR:  12.224925835305116
epoch:  25600 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  25800 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  26000 loss:  0.0660223513841629 PSNR:  12.224901261230091
epoch:  26200 loss:  0.0660223439335823 PSNR:  12.22493663714033
epoch:  26400 loss:  0.06602233648300171 PSNR:  12.224924755123073
epoch:  26600 loss:  0.06602233648300171 PSNR:  12.224915033496767
epoch:  26800 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  27000 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  27200 loss:  0.06602233648300171 PSNR:  12.22491908417175
epoch:  27400 loss:  0.06602233648300171 PSNR:  12.2249244850776
epoch:  27600 loss:  0.06602233648300171 PSNR:  12.224924755123073
epoch:  27800 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  28000 loss:  0.0660223737359047 PSNR:  12.224885598705376
epoch:  28200 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  28400 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  28600 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  28800 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  29000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  29200 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  29400 loss:  0.06602233648300171 PSNR:  12.224921784623836
epoch:  29600 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  29800 loss:  0.06602233648300171 PSNR:  12.224918544081532
epoch:  30000 loss:  0.0660223439335823 PSNR:  12.224910712780952
epoch:  30200 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  30400 loss:  0.06602233648300171 PSNR:  12.224926105350669
epoch:  30600 loss:  0.06602233648300171 PSNR:  12.224923674941298
epoch:  30800 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  31000 loss:  0.06602233648300171 PSNR:  12.224922324714456
epoch:  31200 loss:  0.0660223662853241 PSNR:  12.22487911767719
epoch:  31400 loss:  0.0660223588347435 PSNR:  12.224960131224684
epoch:  31600 loss:  0.06602233648300171 PSNR:  12.224919354216883
epoch:  31800 loss:  0.06602233648300171 PSNR:  12.224925835305116
epoch:  32000 loss:  0.06602233648300171 PSNR:  12.22492880580712
epoch:  32200 loss:  0.06602233648300171 PSNR:  12.22494230811457
epoch:  32400 loss:  0.0660223513841629 PSNR:  12.224899640966294
epoch:  32600 loss:  0.0660223662853241 PSNR:  12.224916383721343
epoch:  32800 loss:  0.0660223513841629 PSNR:  12.2249244850776
epoch:  33000 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  33200 loss:  0.06602233648300171 PSNR:  12.224923404895895
epoch:  33400 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  33600 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  33800 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  34000 loss:  0.06602233648300171 PSNR:  12.224926645441824
epoch:  34200 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  34400 loss:  0.06602233648300171 PSNR:  12.224922594759791
epoch:  34600 loss:  0.0660223513841629 PSNR:  12.224923404895895
epoch:  34800 loss:  0.0660223662853241 PSNR:  12.224917463901303
epoch:  35000 loss:  0.06602233648300171 PSNR:  12.224921514578552
epoch:  35200 loss:  0.06602233648300171 PSNR:  12.224920704442802
epoch:  35400 loss:  0.0660223588347435 PSNR:  12.224879657762502
epoch:  35600 loss:  0.06602233648300171 PSNR:  12.224938797510596
epoch:  35800 loss:  0.0660223513841629 PSNR:  12.22491530354165
epoch:  36000 loss:  0.0660223439335823 PSNR:  12.22490963260267
epoch:  36200 loss:  0.0660223439335823 PSNR:  12.224903151538618
epoch:  36400 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  36600 loss:  0.06602233648300171 PSNR:  12.22492799567001
epoch:  36800 loss:  0.06602233648300171 PSNR:  12.224923944986717
epoch:  37000 loss:  0.06602233648300171 PSNR:  12.224926915487428
epoch:  37200 loss:  0.06602233648300171 PSNR:  12.224918003991386
epoch:  37400 loss:  0.06602233648300171 PSNR:  12.224919624262034
epoch:  37600 loss:  0.06602233648300171 PSNR:  12.22491908417175
epoch:  37800 loss:  0.06602233648300171 PSNR:  12.2249244850776
epoch:  38000 loss:  0.06602233648300171 PSNR:  12.224920704442802
epoch:  38200 loss:  0.06602233648300171 PSNR:  12.224921784623836
epoch:  38400 loss:  0.0660223588347435 PSNR:  12.224925565259579
epoch:  38600 loss:  0.0660223513841629 PSNR:  12.2249304260818
epoch:  38800 loss:  0.06602233648300171 PSNR:  12.224920704442802
epoch:  39000 loss:  0.06602233648300171 PSNR:  12.224918003991386
epoch:  39200 loss:  0.0660223513841629 PSNR:  12.224942848207743
epoch:  39400 loss:  0.06602233648300171 PSNR:  12.224926645441824
epoch:  39600 loss:  0.06602233648300171 PSNR:  12.22492286480514
epoch:  39800 loss:  0.06602233648300171 PSNR:  12.224922324714456
Output directory: data/denoising/Set14/mask/2/pai/mag_global/sparse_0.95
PSNR of output image is:  12.224922324714456
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
(3, 512, 512)
Starting random mask  training on 2 using ADAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '20.43417906484923'
Pruning with threshold : 0.024266627617180347
1.1.1.weight         | nonzeros =    4013 /   12800             ( 31.35%) | total_pruned =    8787 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.2.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    3269 /    6400             ( 51.08%) | total_pruned =    3131 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       8 /      16             ( 50.00%) | total_pruned =       8 | shape = torch.Size([16])
1.5.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    6576 /   12800             ( 51.38%) | total_pruned =    6224 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =    7952 /   25600             ( 31.06%) | total_pruned =   17648 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       8 /      32             ( 25.00%) | total_pruned =      24 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   16181 /   51200             ( 31.60%) | total_pruned =   35019 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      18 /      64             ( 28.12%) | total_pruned =      46 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =    2905 /  102400             (  2.84%) | total_pruned =   99495 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       4 /      64             (  6.25%) | total_pruned =      60 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =    5985 /  204800             (  2.92%) | total_pruned =  198815 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       3 /     128             (  2.34%) | total_pruned =     125 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   26014 /  147456             ( 17.64%) | total_pruned =  121442 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25932 /  147456             ( 17.59%) | total_pruned =  121524 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      23 /     128             ( 17.97%) | total_pruned =     105 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   26000 /  147456             ( 17.63%) | total_pruned =  121456 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      29 /     128             ( 22.66%) | total_pruned =      99 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   12944 /   73728             ( 17.56%) | total_pruned =   60784 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      13 /      64             ( 20.31%) | total_pruned =      51 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    7548 /   18432             ( 40.95%) | total_pruned =   10884 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      13 /      32             ( 40.62%) | total_pruned =      19 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    2703 /    4608             ( 58.66%) | total_pruned =    1905 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       8 /      16             ( 50.00%) | total_pruned =       8 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      46 /      48             ( 95.83%) | total_pruned =       2 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       3 /       3             (100.00%) | total_pruned =       0 | shape = torch.Size([3])
alive: 150338, pruned : 2858529, total: 3008867, Compression rate :      20.01x  ( 95.00% pruned)
Initial PSNR of output image is:  10.157236972213365
epoch:  0 loss:  0.10185891389846802 PSNR:  10.157236972213365
epoch:  200 loss:  0.06606472283601761 PSNR:  12.224253203944695
epoch:  400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  600 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  800 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  1000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  1200 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  1400 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  1600 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  1800 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  2000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  2200 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  2400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  2600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  2800 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  3000 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  3200 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  3400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  3600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  3800 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  4000 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  4200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  4400 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  4600 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  4800 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  5000 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  5200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  5400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  5600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  5800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  6000 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  6200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  6400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  6600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  6800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  7000 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  7200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  7400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  7600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  7800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  8000 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  8200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  8400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  8600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  8800 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  9000 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  9200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  9400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  9600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  9800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  10000 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  10200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  10400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  10600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  10800 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  11000 loss:  0.0660625547170639 PSNR:  12.224871556489862
epoch:  11200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  11400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  11600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  11800 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  12000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  12200 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  12400 loss:  0.0660625621676445 PSNR:  12.224873716827755
epoch:  12600 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  12800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  13000 loss:  0.0660625770688057 PSNR:  12.22484266207385
epoch:  13200 loss:  0.0660625621676445 PSNR:  12.224866425691674
epoch:  13400 loss:  0.0660625696182251 PSNR:  12.224891539656378
epoch:  13600 loss:  0.0660625696182251 PSNR:  12.224885598705376
epoch:  13800 loss:  0.0660625770688057 PSNR:  12.224896400440512
epoch:  14000 loss:  0.0660625621676445 PSNR:  12.224868315985038
epoch:  14200 loss:  0.0660625696182251 PSNR:  12.224869936237148
epoch:  14400 loss:  0.0660625696182251 PSNR:  12.224883438361573
epoch:  14600 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  14800 loss:  0.0660625621676445 PSNR:  12.22488370840449
epoch:  15000 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  15200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  15400 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  15600 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  15800 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  16000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  16200 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  16400 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  16600 loss:  0.0660625696182251 PSNR:  12.22483375075069
epoch:  16800 loss:  0.0660625696182251 PSNR:  12.224862915149037
epoch:  17000 loss:  0.0660625696182251 PSNR:  12.224889379309618
epoch:  17200 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  17400 loss:  0.0660625621676445 PSNR:  12.22487047632132
epoch:  17600 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  17800 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  18000 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  18200 loss:  0.0660625621676445 PSNR:  12.224863995315701
epoch:  18400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  18600 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  18800 loss:  0.0660625621676445 PSNR:  12.224881548061626
epoch:  19000 loss:  0.0660625696182251 PSNR:  12.2248599446921
epoch:  19200 loss:  0.0660625621676445 PSNR:  12.224866425691674
epoch:  19400 loss:  0.0660625621676445 PSNR:  12.224892349786689
epoch:  19600 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  19800 loss:  0.0660625696182251 PSNR:  12.224851303374377
epoch:  20000 loss:  0.0660625621676445 PSNR:  12.22487695733661
epoch:  20200 loss:  0.0660625621676445 PSNR:  12.224880197847883
epoch:  20400 loss:  0.0660625547170639 PSNR:  12.224875067039484
epoch:  20600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  20800 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  21000 loss:  0.0660625621676445 PSNR:  12.22487911767719
epoch:  21200 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  21400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  21600 loss:  0.0660625547170639 PSNR:  12.224872636658674
epoch:  21800 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  22000 loss:  0.0660625696182251 PSNR:  12.224875877166724
epoch:  22200 loss:  0.0660625621676445 PSNR:  12.224885598705376
epoch:  22400 loss:  0.0660625621676445 PSNR:  12.224875067039484
epoch:  22600 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  22800 loss:  0.0660625621676445 PSNR:  12.224869936237148
epoch:  23000 loss:  0.0660625621676445 PSNR:  12.224875067039484
epoch:  23200 loss:  0.0660625621676445 PSNR:  12.224874256912397
epoch:  23400 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  23600 loss:  0.0660625547170639 PSNR:  12.224867775901135
epoch:  23800 loss:  0.0660625696182251 PSNR:  12.224848873006868
epoch:  24000 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  24200 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  24400 loss:  0.0660625621676445 PSNR:  12.2248599446921
epoch:  24600 loss:  0.0660625621676445 PSNR:  12.224868315985038
epoch:  24800 loss:  0.0660625621676445 PSNR:  12.224878577591944
epoch:  25000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  25200 loss:  0.0660625621676445 PSNR:  12.224879387719838
epoch:  25400 loss:  0.0660625621676445 PSNR:  12.22487614720917
epoch:  25600 loss:  0.0660625621676445 PSNR:  12.224866695733533
epoch:  25800 loss:  0.06606258451938629 PSNR:  12.22485265357914
epoch:  26000 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  26200 loss:  0.0660625621676445 PSNR:  12.22487317674318
epoch:  26400 loss:  0.0660625696182251 PSNR:  12.224890999569586
epoch:  26600 loss:  0.0660625621676445 PSNR:  12.224878307549346
epoch:  26800 loss:  0.0660625621676445 PSNR:  12.224874796997105
epoch:  27000 loss:  0.0660625621676445 PSNR:  12.22487317674318
epoch:  27200 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  27400 loss:  0.0660625621676445 PSNR:  12.224869666195088
epoch:  27600 loss:  0.06606258451938629 PSNR:  12.224911792959503
epoch:  27800 loss:  0.0660625696182251 PSNR:  12.224896940527977
epoch:  28000 loss:  0.06606258451938629 PSNR:  12.224908282380193
epoch:  28200 loss:  0.0660625621676445 PSNR:  12.22485562403109
epoch:  28400 loss:  0.0660625621676445 PSNR:  12.224894510134925
epoch:  28600 loss:  0.0660625621676445 PSNR:  12.224856974237193
epoch:  28800 loss:  0.0660625621676445 PSNR:  12.224863185190678
epoch:  29000 loss:  0.0660625696182251 PSNR:  12.224904231715287
epoch:  29200 loss:  0.0660625621676445 PSNR:  12.224869936237148
epoch:  29400 loss:  0.0660625621676445 PSNR:  12.2248672358173
epoch:  29600 loss:  0.0660625621676445 PSNR:  12.22487047632132
epoch:  29800 loss:  0.0660625621676445 PSNR:  12.224868586027014
epoch:  30000 loss:  0.0660625621676445 PSNR:  12.224861294899547
epoch:  30200 loss:  0.0660625621676445 PSNR:  12.224848873006868
epoch:  30400 loss:  0.0660625621676445 PSNR:  12.22487317674318
epoch:  30600 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  30800 loss:  0.06606258451938629 PSNR:  12.224910712780952
epoch:  31000 loss:  0.0660625621676445 PSNR:  12.224886678877683
epoch:  31200 loss:  0.0660625621676445 PSNR:  12.224877227379123
epoch:  31400 loss:  0.0660625621676445 PSNR:  12.22487182653204
epoch:  31600 loss:  0.0660625621676445 PSNR:  12.224869396153045
epoch:  31800 loss:  0.0660625621676445 PSNR:  12.224873986870069
epoch:  32000 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  32200 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  32400 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  32600 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  32800 loss:  0.0660625621676445 PSNR:  12.224873716827755
epoch:  33000 loss:  0.0660625621676445 PSNR:  12.22487047632132
epoch:  33200 loss:  0.0660625621676445 PSNR:  12.224871016405556
epoch:  33400 loss:  0.0660625696182251 PSNR:  12.224872096574234
epoch:  33600 loss:  0.0660625621676445 PSNR:  12.224868315985038
epoch:  33800 loss:  0.0660625696182251 PSNR:  12.224890189439527
epoch:  34000 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  34200 loss:  0.0660625621676445 PSNR:  12.224862105024217
epoch:  34400 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  34600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  34800 loss:  0.0660625621676445 PSNR:  12.224871016405556
epoch:  35000 loss:  0.0660625621676445 PSNR:  12.224875067039484
epoch:  35200 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  35400 loss:  0.0660625621676445 PSNR:  12.224870746363429
epoch:  35600 loss:  0.0660625696182251 PSNR:  12.22487317674318
epoch:  35800 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  36000 loss:  0.0660625547170639 PSNR:  12.224875877166724
epoch:  36200 loss:  0.0660625696182251 PSNR:  12.224889379309618
epoch:  36400 loss:  0.0660625621676445 PSNR:  12.224875067039484
epoch:  36600 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  36800 loss:  0.0660625621676445 PSNR:  12.22487290670092
epoch:  37000 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  37200 loss:  0.0660625621676445 PSNR:  12.224874796997105
epoch:  37400 loss:  0.0660625696182251 PSNR:  12.224849143047633
epoch:  37600 loss:  0.0660625621676445 PSNR:  12.224868856069008
epoch:  37800 loss:  0.0660625621676445 PSNR:  12.224872636658674
epoch:  38000 loss:  0.0660625696182251 PSNR:  12.224845632518967
epoch:  38200 loss:  0.0660625621676445 PSNR:  12.224873986870069
epoch:  38400 loss:  0.0660625621676445 PSNR:  12.224875877166724
epoch:  38600 loss:  0.0660625621676445 PSNR:  12.224886678877683
epoch:  38800 loss:  0.0660625621676445 PSNR:  12.224872096574234
epoch:  39000 loss:  0.0660625621676445 PSNR:  12.224883978447423
epoch:  39200 loss:  0.0660625621676445 PSNR:  12.22488289827579
epoch:  39400 loss:  0.0660625696182251 PSNR:  12.224844012275923
epoch:  39600 loss:  0.0660625621676445 PSNR:  12.224871556489862
epoch:  39800 loss:  0.0660625621676445 PSNR:  12.22487290670092
Output directory: data/denoising/Set14/mask/2/pai/mag_global/sparse_0.95
PSNR of output image is:  12.22487290670092
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
(3, 512, 512)
Starting random mask  training on 2 using ADAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '20.428720222111146'
Pruning with threshold : 0.024287222512066366
1.1.1.weight         | nonzeros =    3974 /   12800             ( 31.05%) | total_pruned =    8826 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.2.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    3267 /    6400             ( 51.05%) | total_pruned =    3133 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =      11 /      16             ( 68.75%) | total_pruned =       5 | shape = torch.Size([16])
1.5.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    6614 /   12800             ( 51.67%) | total_pruned =    6186 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =    8140 /   25600             ( 31.80%) | total_pruned =   17460 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       5 /      32             ( 15.62%) | total_pruned =      27 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   16043 /   51200             ( 31.33%) | total_pruned =   35157 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      18 /      64             ( 28.12%) | total_pruned =      46 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =    2988 /  102400             (  2.92%) | total_pruned =   99412 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       1 /      64             (  1.56%) | total_pruned =      63 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =    5825 /  204800             (  2.84%) | total_pruned =  198975 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       6 /     128             (  4.69%) | total_pruned =     122 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25788 /  147456             ( 17.49%) | total_pruned =  121668 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      17 /     128             ( 13.28%) | total_pruned =     111 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   26019 /  147456             ( 17.65%) | total_pruned =  121437 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   25990 /  147456             ( 17.63%) | total_pruned =  121466 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   13097 /   73728             ( 17.76%) | total_pruned =   60631 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      11 /      64             ( 17.19%) | total_pruned =      53 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    7637 /   18432             ( 41.43%) | total_pruned =   10795 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      11 /      32             ( 34.38%) | total_pruned =      21 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    2655 /    4608             ( 57.62%) | total_pruned =    1953 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =      10 /      16             ( 62.50%) | total_pruned =       6 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      42 /      48             ( 87.50%) | total_pruned =       6 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       2 /       3             ( 66.67%) | total_pruned =       1 | shape = torch.Size([3])
alive: 150338, pruned : 2858529, total: 3008867, Compression rate :      20.01x  ( 95.00% pruned)
Initial PSNR of output image is:  10.691712049493432
epoch:  0 loss:  0.09077267348766327 PSNR:  10.691712049493432
epoch:  200 loss:  0.07559934258460999 PSNR:  11.565176556571949
epoch:  400 loss:  0.07559794187545776 PSNR:  11.565492069219019
epoch:  600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  1000 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  1200 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  1400 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  1600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  1800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  2000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  2200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  2400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  2600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  2800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  3000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  3200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  3400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  3600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  3800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  4000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  4200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  4400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  4600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  4800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  5000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  5200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  5400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  5600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  5800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  6000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  6200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  6400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  6600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  6800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  7000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  7200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  7400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  7600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  7800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  8000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  8200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  8400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  8600 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  8800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  9000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  9200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  9400 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  9600 loss:  0.07559795677661896 PSNR:  11.565490677201119
epoch:  9800 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  10000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  10200 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  10400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  10600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  10800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  11000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  11200 loss:  0.07559794187545776 PSNR:  11.565491141207037
epoch:  11400 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  11600 loss:  0.07559794187545776 PSNR:  11.565491141207037
epoch:  11800 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  12000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  12200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  12400 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  12600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  12800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  13000 loss:  0.07559794187545776 PSNR:  11.565491141207037
epoch:  13200 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  13400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  13600 loss:  0.07559794932603836 PSNR:  11.565492533225086
epoch:  13800 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  14000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  14200 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  14400 loss:  0.07559795677661896 PSNR:  11.565495781268938
epoch:  14600 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  14800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  15000 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  15200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  15400 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  15600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  15800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  16000 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  16200 loss:  0.07559797167778015 PSNR:  11.56548974918943
epoch:  16400 loss:  0.07559798657894135 PSNR:  11.565489285183661
epoch:  16600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  16800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  17000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  17200 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  17400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  17600 loss:  0.07559794187545776 PSNR:  11.56548974918943
epoch:  17800 loss:  0.07559794932603836 PSNR:  11.565495781268938
epoch:  18000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  18200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  18400 loss:  0.07559796422719955 PSNR:  11.565491141207037
epoch:  18600 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  18800 loss:  0.07559795677661896 PSNR:  11.565472581008997
epoch:  19000 loss:  0.07559794932603836 PSNR:  11.565492997231201
epoch:  19200 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  19400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  19600 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  19800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  20000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  20200 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  20400 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  20600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  20800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  21000 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  21200 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  21400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  21600 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  21800 loss:  0.07559794932603836 PSNR:  11.565489285183661
epoch:  22000 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  22200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  22400 loss:  0.07559795677661896 PSNR:  11.565492533225086
epoch:  22600 loss:  0.07559794187545776 PSNR:  11.565493925243581
epoch:  22800 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  23000 loss:  0.07559794932603836 PSNR:  11.565488821177944
epoch:  23200 loss:  0.07559795677661896 PSNR:  11.565487429161081
epoch:  23400 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  23600 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  23800 loss:  0.07559794932603836 PSNR:  11.565497173288474
epoch:  24000 loss:  0.07559797167778015 PSNR:  11.565464228945759
epoch:  24200 loss:  0.07559794932603836 PSNR:  11.565487429161081
epoch:  24400 loss:  0.07559794187545776 PSNR:  11.565492069219019
epoch:  24600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  24800 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  25000 loss:  0.07559795677661896 PSNR:  11.565488357172274
epoch:  25200 loss:  0.07559795677661896 PSNR:  11.565493461237367
epoch:  25400 loss:  0.07559794932603836 PSNR:  11.565489285183661
epoch:  25600 loss:  0.07559795677661896 PSNR:  11.56550552541507
epoch:  25800 loss:  0.07559795677661896 PSNR:  11.565480005078694
epoch:  26000 loss:  0.07559795677661896 PSNR:  11.565485573139295
epoch:  26200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  26400 loss:  0.07559794187545776 PSNR:  11.565492069219019
epoch:  26600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  26800 loss:  0.07559795677661896 PSNR:  11.565490213195249
epoch:  27000 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  27200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  27400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  27600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  27800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  28000 loss:  0.07559795677661896 PSNR:  11.565505061407615
epoch:  28200 loss:  0.07559795677661896 PSNR:  11.56550691743773
epoch:  28400 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  28600 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  28800 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  29000 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  29200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  29400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  29600 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  29800 loss:  0.07559796422719955 PSNR:  11.565464228945759
epoch:  30000 loss:  0.07559795677661896 PSNR:  11.56549485325616
epoch:  30200 loss:  0.07559795677661896 PSNR:  11.56547722105107
epoch:  30400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  30600 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  30800 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  31000 loss:  0.07559794932603836 PSNR:  11.565492533225086
epoch:  31200 loss:  0.07559794932603836 PSNR:  11.565488357172274
epoch:  31400 loss:  0.07559794932603836 PSNR:  11.565488357172274
epoch:  31600 loss:  0.07559794187545776 PSNR:  11.565492533225086
epoch:  31800 loss:  0.07559795677661896 PSNR:  11.565490677201119
epoch:  32000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  32200 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  32400 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  32600 loss:  0.07559796422719955 PSNR:  11.565490677201119
epoch:  32800 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  33000 loss:  0.07559795677661896 PSNR:  11.565491605213003
epoch:  33200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  33400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  33600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  33800 loss:  0.07559794187545776 PSNR:  11.565491141207037
epoch:  34000 loss:  0.07559794187545776 PSNR:  11.565492069219019
epoch:  34200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  34400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  34600 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  34800 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  35000 loss:  0.07559800148010254 PSNR:  11.565488357172274
epoch:  35200 loss:  0.07559795677661896 PSNR:  11.565492069219019
epoch:  35400 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  35600 loss:  0.07559794932603836 PSNR:  11.565490677201119
epoch:  35800 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  36000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  36200 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  36400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  36600 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  36800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  37000 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  37200 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  37400 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  37600 loss:  0.07559794187545776 PSNR:  11.565491605213003
epoch:  37800 loss:  0.07559794932603836 PSNR:  11.565492069219019
epoch:  38000 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  38200 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  38400 loss:  0.07559794932603836 PSNR:  11.565491141207037
epoch:  38600 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  38800 loss:  0.07559794932603836 PSNR:  11.565491605213003
epoch:  39000 loss:  0.07559795677661896 PSNR:  11.565491141207037
epoch:  39200 loss:  0.07559795677661896 PSNR:  11.56547907706929
epoch:  39400 loss:  0.07559795677661896 PSNR:  11.565480005078694
epoch:  39600 loss:  0.07559794932603836 PSNR:  11.565480933088299
epoch:  39800 loss:  0.07559794932603836 PSNR:  11.565489285183661
Output directory: data/denoising/Set14/mask/2/pai/mag_global/sparse_0.95
PSNR of output image is:  11.565489285183661
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
(3, 512, 512)
Starting random mask  training on 2 using ADAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '20.424342473353235'
Pruning with threshold : 0.024285665713250637
1.1.1.weight         | nonzeros =    4045 /   12800             ( 31.60%) | total_pruned =    8755 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       2 /      16             ( 12.50%) | total_pruned =      14 | shape = torch.Size([16])
1.2.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    3343 /    6400             ( 52.23%) | total_pruned =    3057 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.5.weight           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =    6521 /   12800             ( 50.95%) | total_pruned =    6279 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =    8011 /   25600             ( 31.29%) | total_pruned =   17589 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       8 /      32             ( 25.00%) | total_pruned =      24 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   16046 /   51200             ( 31.34%) | total_pruned =   35154 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      19 /      64             ( 29.69%) | total_pruned =      45 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =    2968 /  102400             (  2.90%) | total_pruned =   99432 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       3 /      64             (  4.69%) | total_pruned =      61 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =    5820 /  204800             (  2.84%) | total_pruned =  198980 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       5 /     128             (  3.91%) | total_pruned =     123 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25762 /  147456             ( 17.47%) | total_pruned =  121694 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      20 /     128             ( 15.62%) | total_pruned =     108 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   26356 /  147456             ( 17.87%) | total_pruned =  121100 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =      19 /     128             ( 14.84%) | total_pruned =     109 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   25978 /  147456             ( 17.62%) | total_pruned =  121478 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =      25 /     128             ( 19.53%) | total_pruned =     103 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   12864 /   73728             ( 17.45%) | total_pruned =   60864 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      12 /      64             ( 18.75%) | total_pruned =      52 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    7659 /   18432             ( 41.55%) | total_pruned =   10773 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      18 /      32             ( 56.25%) | total_pruned =      14 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    2662 /    4608             ( 57.77%) | total_pruned =    1946 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       8 /      16             ( 50.00%) | total_pruned =       8 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      43 /      48             ( 89.58%) | total_pruned =       5 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       2 /       3             ( 66.67%) | total_pruned =       1 | shape = torch.Size([3])
alive: 150338, pruned : 2858529, total: 3008867, Compression rate :      20.01x  ( 95.00% pruned)
Initial PSNR of output image is:  10.247194348843124
epoch:  0 loss:  0.099830262362957 PSNR:  10.247194348843124
epoch:  200 loss:  0.07872324436903 PSNR:  11.36527131071861
epoch:  400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  1000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  1200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  1400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  1600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  1800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  2000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  2200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  2400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  2600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  2800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  3000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  3200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  3400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  3600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  3800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  4000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  4200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  4400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  4600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  4800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  5000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  5200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  5400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  5600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  5800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  6000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  6200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  6400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  6600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  6800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  7000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  7200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  7400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  7600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  7800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  8000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  8200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  8400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  8600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  8800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  9000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  9200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  9400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  9600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  9800 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  10000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  10200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  10400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  10600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  10800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  11000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  11200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  11400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  11600 loss:  0.07872198522090912 PSNR:  11.365561993918877
epoch:  11800 loss:  0.07872200012207031 PSNR:  11.365550915696403
epoch:  12000 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  12200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  12400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  12600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  12800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  13000 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  13200 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  13400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  13600 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  13800 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  14000 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  14200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  14400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  14600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  14800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  15000 loss:  0.07872198522090912 PSNR:  11.36555357446722
epoch:  15200 loss:  0.07872198522090912 PSNR:  11.365554017595848
epoch:  15400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  15600 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  15800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  16000 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  16200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  16400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  16600 loss:  0.07872198522090912 PSNR:  11.365533633725766
epoch:  16800 loss:  0.07872197777032852 PSNR:  11.365556233239664
epoch:  17000 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  17200 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  17400 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  17600 loss:  0.07872200012207031 PSNR:  11.365552245081608
epoch:  17800 loss:  0.07872197031974792 PSNR:  11.36556110766004
epoch:  18000 loss:  0.07872197031974792 PSNR:  11.365554903853239
epoch:  18200 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  18400 loss:  0.07872197031974792 PSNR:  11.365555790110811
epoch:  18600 loss:  0.07872197777032852 PSNR:  11.365561993918877
epoch:  18800 loss:  0.07872197031974792 PSNR:  11.36556066453069
epoch:  19000 loss:  0.07872197031974792 PSNR:  11.365561993918877
epoch:  19200 loss:  0.07872197031974792 PSNR:  11.365559778272123
epoch:  19400 loss:  0.07872197031974792 PSNR:  11.365556676368563
epoch:  19600 loss:  0.07872199267148972 PSNR:  11.36555135882476
epoch:  19800 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  20000 loss:  0.07872197031974792 PSNR:  11.365554460724521
epoch:  20200 loss:  0.07872199267148972 PSNR:  11.365529202462323
epoch:  20400 loss:  0.07872199267148972 PSNR:  11.365530974967157
epoch:  20600 loss:  0.07872199267148972 PSNR:  11.365584150448608
epoch:  20800 loss:  0.07872197777032852 PSNR:  11.365557119497506
epoch:  21000 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  21200 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  21400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  21600 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  21800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  22000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  22200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  22400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  22600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  22800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  23000 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  23200 loss:  0.07872197031974792 PSNR:  11.365554903853239
epoch:  23400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  23600 loss:  0.07872197777032852 PSNR:  11.365576174084884
epoch:  23800 loss:  0.07872197031974792 PSNR:  11.365565982085888
epoch:  24000 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  24200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  24400 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  24600 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  24800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  25000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  25200 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  25400 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  25600 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  25800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  26000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  26200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  26400 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  26600 loss:  0.07872199267148972 PSNR:  11.36553008871465
epoch:  26800 loss:  0.07872199267148972 PSNR:  11.365583264185249
epoch:  27000 loss:  0.07872197031974792 PSNR:  11.365549586311605
epoch:  27200 loss:  0.07872197031974792 PSNR:  11.365554460724521
epoch:  27400 loss:  0.07872197031974792 PSNR:  11.365560221401383
epoch:  27600 loss:  0.07872198522090912 PSNR:  11.365552245081608
epoch:  27800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  28000 loss:  0.0787220150232315 PSNR:  11.365562880177897
epoch:  28200 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  28400 loss:  0.07872197031974792 PSNR:  11.365554903853239
epoch:  28600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  28800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  29000 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  29200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  29400 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  29600 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  29800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  30000 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  30200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  30400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  30600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  30800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  31000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  31200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  31400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  31600 loss:  0.07872198522090912 PSNR:  11.365556233239664
epoch:  31800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  32000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  32200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  32400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  32600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  32800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  33000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  33200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  33400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  33600 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  33800 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  34000 loss:  0.07872197031974792 PSNR:  11.365567311475706
epoch:  34200 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  34400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  34600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  34800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  35000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  35200 loss:  0.07872197031974792 PSNR:  11.365559778272123
epoch:  35400 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  35600 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  35800 loss:  0.07872200012207031 PSNR:  11.365550472568092
epoch:  36000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  36200 loss:  0.07872197031974792 PSNR:  11.365571299647597
epoch:  36400 loss:  0.07872197031974792 PSNR:  11.365544711904159
epoch:  36600 loss:  0.07872197031974792 PSNR:  11.365557562626499
epoch:  36800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  37000 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  37200 loss:  0.07872197031974792 PSNR:  11.365556676368563
epoch:  37400 loss:  0.07872198522090912 PSNR:  11.365553131338636
epoch:  37600 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  37800 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  38000 loss:  0.07872199267148972 PSNR:  11.365552245081608
epoch:  38200 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  38400 loss:  0.07872197031974792 PSNR:  11.365558005755531
epoch:  38600 loss:  0.07872197031974792 PSNR:  11.365558892013736
epoch:  38800 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  39000 loss:  0.07872197031974792 PSNR:  11.365558448884611
epoch:  39200 loss:  0.07872197031974792 PSNR:  11.365559335142908
epoch:  39400 loss:  0.07872197031974792 PSNR:  11.36556110766004
epoch:  39600 loss:  0.07872199267148972 PSNR:  11.365562880177897
epoch:  39800 loss:  0.07872197031974792 PSNR:  11.365554903853239
Output directory: data/denoising/Set14/mask/2/pai/mag_global/sparse_0.95
PSNR of output image is:  11.365554903853239
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
