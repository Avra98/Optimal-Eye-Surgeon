(3, 512, 512)
Noisy PSNR is '20.133098175752874'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Starting optimization with optimizer 'SAM'
Output directory: data/denoising/Set14/mask/6/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/0.5/1e-09
epoch:  0 quantization_loss:  0.06102297082543373
p mean is: tensor(9.4192e-05, device='cuda:3')
epoch:  1000 quantization_loss:  0.048162057995796204
p mean is: tensor(0.0051, device='cuda:3')
epoch:  2000 quantization_loss:  0.048165254294872284
p mean is: tensor(0.0096, device='cuda:3')
epoch:  3000 quantization_loss:  0.04658210277557373
p mean is: tensor(0.0144, device='cuda:3')
epoch:  4000 quantization_loss:  0.045476481318473816
p mean is: tensor(0.0188, device='cuda:3')
epoch:  5000 quantization_loss:  0.04517575725913048
p mean is: tensor(0.0233, device='cuda:3')
epoch:  6000 quantization_loss:  0.045360345393419266
p mean is: tensor(0.0284, device='cuda:3')
epoch:  7000 quantization_loss:  0.04227544367313385
p mean is: tensor(0.0336, device='cuda:3')
epoch:  8000 quantization_loss:  0.04083365201950073
p mean is: tensor(0.0408, device='cuda:3')
epoch:  9000 quantization_loss:  0.039165396243333817
p mean is: tensor(0.0502, device='cuda:3')
epoch:  10000 quantization_loss:  0.038209762424230576
p mean is: tensor(0.0618, device='cuda:3')
epoch:  11000 quantization_loss:  0.03567507117986679
p mean is: tensor(0.0753, device='cuda:3')
epoch:  12000 quantization_loss:  0.03476988524198532
p mean is: tensor(0.0918, device='cuda:3')
epoch:  13000 quantization_loss:  0.03356783464550972
p mean is: tensor(0.1118, device='cuda:3')
epoch:  14000 quantization_loss:  0.032608069479465485
p mean is: tensor(0.1355, device='cuda:3')
epoch:  15000 quantization_loss:  0.03154892846941948
p mean is: tensor(0.1624, device='cuda:3')
epoch:  16000 quantization_loss:  0.03079225867986679
p mean is: tensor(0.1915, device='cuda:3')
epoch:  17000 quantization_loss:  0.02880960889160633
p mean is: tensor(0.2210, device='cuda:3')
epoch:  18000 quantization_loss:  0.028068941086530685
p mean is: tensor(0.2494, device='cuda:3')
epoch:  19000 quantization_loss:  0.02731173485517502
p mean is: tensor(0.2761, device='cuda:3')
epoch:  20000 quantization_loss:  0.026929520070552826
p mean is: tensor(0.3010, device='cuda:3')
epoch:  21000 quantization_loss:  0.02661219611763954
p mean is: tensor(0.3237, device='cuda:3')
epoch:  22000 quantization_loss:  0.02602561004459858
p mean is: tensor(0.3441, device='cuda:3')
epoch:  23000 quantization_loss:  0.025700893253087997
p mean is: tensor(0.3624, device='cuda:3')
epoch:  24000 quantization_loss:  0.02550492435693741
p mean is: tensor(0.3786, device='cuda:3')
epoch:  25000 quantization_loss:  0.02532082609832287
p mean is: tensor(0.3928, device='cuda:3')
epoch:  26000 quantization_loss:  0.0250831451267004
p mean is: tensor(0.4053, device='cuda:3')
epoch:  27000 quantization_loss:  0.024955878034234047
p mean is: tensor(0.4163, device='cuda:3')
epoch:  28000 quantization_loss:  0.024846825748682022
p mean is: tensor(0.4258, device='cuda:3')
epoch:  29000 quantization_loss:  0.02479700557887554
p mean is: tensor(0.4341, device='cuda:3')
epoch:  30000 quantization_loss:  0.02462182007730007
p mean is: tensor(0.4413, device='cuda:3')
epoch:  31000 quantization_loss:  0.02452336624264717
p mean is: tensor(0.4476, device='cuda:3')
epoch:  32000 quantization_loss:  0.02445981279015541
p mean is: tensor(0.4530, device='cuda:3')
epoch:  33000 quantization_loss:  0.024361971765756607
p mean is: tensor(0.4577, device='cuda:3')
epoch:  34000 quantization_loss:  0.024344269186258316
p mean is: tensor(0.4620, device='cuda:3')
epoch:  35000 quantization_loss:  0.0242592915892601
p mean is: tensor(0.4657, device='cuda:3')
epoch:  36000 quantization_loss:  0.024217266589403152
p mean is: tensor(0.4690, device='cuda:3')
epoch:  37000 quantization_loss:  0.024208080023527145
p mean is: tensor(0.4719, device='cuda:3')
epoch:  38000 quantization_loss:  0.024096563458442688
p mean is: tensor(0.4746, device='cuda:3')
epoch:  39000 quantization_loss:  0.024062281474471092
p mean is: tensor(0.4770, device='cuda:3')
epoch:  40000 quantization_loss:  0.024037068709731102
p mean is: tensor(0.4790, device='cuda:3')
epoch:  41000 quantization_loss:  0.024009568616747856
p mean is: tensor(0.4809, device='cuda:3')
epoch:  42000 quantization_loss:  0.023970959708094597
p mean is: tensor(0.4826, device='cuda:3')
epoch:  43000 quantization_loss:  0.023912571370601654
p mean is: tensor(0.4842, device='cuda:3')
epoch:  44000 quantization_loss:  0.02348737232387066
p mean is: tensor(0.4856, device='cuda:3')
epoch:  45000 quantization_loss:  0.02335432730615139
p mean is: tensor(0.4868, device='cuda:3')
epoch:  46000 quantization_loss:  0.023243654519319534
p mean is: tensor(0.4879, device='cuda:3')
epoch:  47000 quantization_loss:  0.023199159651994705
p mean is: tensor(0.4890, device='cuda:3')
epoch:  48000 quantization_loss:  0.02315131574869156
p mean is: tensor(0.4900, device='cuda:3')
epoch:  49000 quantization_loss:  0.023142261430621147
p mean is: tensor(0.4910, device='cuda:3')
epoch:  50000 quantization_loss:  0.02310544066131115
p mean is: tensor(0.4919, device='cuda:3')
epoch:  51000 quantization_loss:  0.023078767582774162
p mean is: tensor(0.4927, device='cuda:3')
epoch:  52000 quantization_loss:  0.023032842203974724
p mean is: tensor(0.4935, device='cuda:3')
epoch:  53000 quantization_loss:  0.02303137630224228
p mean is: tensor(0.4943, device='cuda:3')
epoch:  54000 quantization_loss:  0.022996028885245323
p mean is: tensor(0.4950, device='cuda:3')
epoch:  55000 quantization_loss:  0.022995412349700928
p mean is: tensor(0.4957, device='cuda:3')
epoch:  56000 quantization_loss:  0.022978652268648148
p mean is: tensor(0.4963, device='cuda:3')
epoch:  57000 quantization_loss:  0.02296399138867855
p mean is: tensor(0.4970, device='cuda:3')
epoch:  58000 quantization_loss:  0.022955769672989845
p mean is: tensor(0.4976, device='cuda:3')
epoch:  59000 quantization_loss:  0.02295304834842682
p mean is: tensor(0.4982, device='cuda:3')
epoch:  60000 quantization_loss:  0.022938840091228485
p mean is: tensor(0.4987, device='cuda:3')
epoch:  61000 quantization_loss:  0.023001383990049362
p mean is: tensor(0.4992, device='cuda:3')
epoch:  62000 quantization_loss:  0.022935714572668076
p mean is: tensor(0.4997, device='cuda:3')
epoch:  63000 quantization_loss:  0.022910408675670624
p mean is: tensor(0.5001, device='cuda:3')
epoch:  64000 quantization_loss:  0.022925235331058502
p mean is: tensor(0.5005, device='cuda:3')
epoch:  65000 quantization_loss:  0.022902201861143112
p mean is: tensor(0.5010, device='cuda:3')
epoch:  66000 quantization_loss:  0.022900652140378952
p mean is: tensor(0.5013, device='cuda:3')
epoch:  67000 quantization_loss:  0.022890305146574974
p mean is: tensor(0.5018, device='cuda:3')
epoch:  68000 quantization_loss:  0.02288759872317314
p mean is: tensor(0.5022, device='cuda:3')
epoch:  69000 quantization_loss:  0.02287187986075878
p mean is: tensor(0.5026, device='cuda:3')
epoch:  70000 quantization_loss:  0.02287721075117588
p mean is: tensor(0.5030, device='cuda:3')
epoch:  71000 quantization_loss:  0.023074904456734657
p mean is: tensor(0.5034, device='cuda:3')
epoch:  72000 quantization_loss:  0.022863108664751053
p mean is: tensor(0.5037, device='cuda:3')
epoch:  73000 quantization_loss:  0.022913463413715363
p mean is: tensor(0.5040, device='cuda:3')
epoch:  74000 quantization_loss:  0.022861629724502563
p mean is: tensor(0.5043, device='cuda:3')
epoch:  75000 quantization_loss:  0.02286406233906746
p mean is: tensor(0.5047, device='cuda:3')
epoch:  76000 quantization_loss:  0.02285039611160755
p mean is: tensor(0.5050, device='cuda:3')
epoch:  77000 quantization_loss:  0.0228414349257946
p mean is: tensor(0.5054, device='cuda:3')
epoch:  78000 quantization_loss:  0.022860124707221985
p mean is: tensor(0.5056, device='cuda:3')
epoch:  79000 quantization_loss:  0.022844774648547173
p mean is: tensor(0.5059, device='cuda:3')
1.1.1.weight         | nonzeros =   10923 /   12800             ( 85.34%) | total_pruned =    1877 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.weight           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    6054 /    6400             ( 94.59%) | total_pruned =     346 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.weight           | nonzeros =      10 /      16             ( 62.50%) | total_pruned =       6 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =   12382 /   12800             ( 96.73%) | total_pruned =     418 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =   25026 /   25600             ( 97.76%) | total_pruned =     574 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      18 /      32             ( 56.25%) | total_pruned =      14 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   50358 /   51200             ( 98.36%) | total_pruned =     842 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      39 /      64             ( 60.94%) | total_pruned =      25 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =  100977 /  102400             ( 98.61%) | total_pruned =    1423 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      42 /      64             ( 65.62%) | total_pruned =      22 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =  203153 /  204800             ( 99.20%) | total_pruned =    1647 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      78 /     128             ( 60.94%) | total_pruned =      50 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =  406341 /  409600             ( 99.20%) | total_pruned =    3259 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  403622 /  409600             ( 98.54%) | total_pruned =    5978 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  392013 /  409600             ( 95.71%) | total_pruned =   17587 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     100 /     128             ( 78.12%) | total_pruned =      28 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  374048 /  409600             ( 91.32%) | total_pruned =   35552 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      99 /     128             ( 77.34%) | total_pruned =      29 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  345586 /  409600             ( 84.37%) | total_pruned =   64014 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     102 /     128             ( 79.69%) | total_pruned =      26 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      94 /     128             ( 73.44%) | total_pruned =      34 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  110381 /  147456             ( 74.86%) | total_pruned =   37075 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     107 /     128             ( 83.59%) | total_pruned =      21 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      96 /     128             ( 75.00%) | total_pruned =      32 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  118597 /  147456             ( 80.43%) | total_pruned =   28859 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      85 /     128             ( 66.41%) | total_pruned =      43 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      70 /     128             ( 54.69%) | total_pruned =      58 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =  125923 /  147456             ( 85.40%) | total_pruned =   21533 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      82 /     128             ( 64.06%) | total_pruned =      46 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      70 /     128             ( 54.69%) | total_pruned =      58 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   64625 /   73728             ( 87.65%) | total_pruned =    9103 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      30 /      64             ( 46.88%) | total_pruned =      34 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =   16211 /   18432             ( 87.95%) | total_pruned =    2221 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      17 /      32             ( 53.12%) | total_pruned =      15 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    3459 /    4608             ( 75.07%) | total_pruned =    1149 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.weight             | nonzeros =      15 /      16             ( 93.75%) | total_pruned =       1 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      27 /      48             ( 56.25%) | total_pruned =      21 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       3 /       3             (100.00%) | total_pruned =       0 | shape = torch.Size([3])
alive: 2772609, pruned : 236258, total: 3008867, Compression rate :       1.09x  (  7.85% pruned)
(3, 512, 512) (3, 512, 512) (3, 512, 512)
PSNR of output image is:  18.735203665731646
Experiment done
