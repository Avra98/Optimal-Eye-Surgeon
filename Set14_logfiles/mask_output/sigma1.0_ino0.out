(3, 512, 512)
Noisy PSNR is '20.312169255655288'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Starting optimization with optimizer 'SAM'
Output directory: data/denoising/Set14/mask/0/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/1.0/1e-09
epoch:  0 quantization_loss:  0.08104996383190155
p mean is: tensor(0.0002, device='cuda:3')
epoch:  1000 quantization_loss:  0.07075072079896927
p mean is: tensor(0.0067, device='cuda:3')
epoch:  2000 quantization_loss:  0.0662868395447731
p mean is: tensor(0.0116, device='cuda:3')
epoch:  3000 quantization_loss:  0.0648922249674797
p mean is: tensor(0.0165, device='cuda:3')
epoch:  4000 quantization_loss:  0.06553097069263458
p mean is: tensor(0.0214, device='cuda:3')
epoch:  5000 quantization_loss:  0.06555593758821487
p mean is: tensor(0.0267, device='cuda:3')
epoch:  6000 quantization_loss:  0.06472793966531754
p mean is: tensor(0.0323, device='cuda:3')
epoch:  7000 quantization_loss:  0.06505343317985535
p mean is: tensor(0.0383, device='cuda:3')
epoch:  8000 quantization_loss:  0.06424026191234589
p mean is: tensor(0.0450, device='cuda:3')
epoch:  9000 quantization_loss:  0.06349367648363113
p mean is: tensor(0.0520, device='cuda:3')
epoch:  10000 quantization_loss:  0.056494370102882385
p mean is: tensor(0.0597, device='cuda:3')
epoch:  11000 quantization_loss:  0.04718974977731705
p mean is: tensor(0.0686, device='cuda:3')
epoch:  12000 quantization_loss:  0.04272828251123428
p mean is: tensor(0.0799, device='cuda:3')
epoch:  13000 quantization_loss:  0.04026849567890167
p mean is: tensor(0.0951, device='cuda:3')
epoch:  14000 quantization_loss:  0.03614223375916481
p mean is: tensor(0.1154, device='cuda:3')
epoch:  15000 quantization_loss:  0.033474911004304886
p mean is: tensor(0.1415, device='cuda:3')
epoch:  16000 quantization_loss:  0.03181052580475807
p mean is: tensor(0.1741, device='cuda:3')
epoch:  17000 quantization_loss:  0.029960626736283302
p mean is: tensor(0.2133, device='cuda:3')
epoch:  18000 quantization_loss:  0.029418345540761948
p mean is: tensor(0.2587, device='cuda:3')
epoch:  19000 quantization_loss:  0.028478970751166344
p mean is: tensor(0.3092, device='cuda:3')
epoch:  20000 quantization_loss:  0.028016790747642517
p mean is: tensor(0.3631, device='cuda:3')
epoch:  21000 quantization_loss:  0.027675054967403412
p mean is: tensor(0.4182, device='cuda:3')
epoch:  22000 quantization_loss:  0.027365587651729584
p mean is: tensor(0.4728, device='cuda:3')
epoch:  23000 quantization_loss:  0.02729823626577854
p mean is: tensor(0.5250, device='cuda:3')
epoch:  24000 quantization_loss:  0.027724822983145714
p mean is: tensor(0.5737, device='cuda:3')
epoch:  25000 quantization_loss:  0.026739414781332016
p mean is: tensor(0.6183, device='cuda:3')
epoch:  26000 quantization_loss:  0.02661035768687725
p mean is: tensor(0.6589, device='cuda:3')
epoch:  27000 quantization_loss:  0.026687372475862503
p mean is: tensor(0.6950, device='cuda:3')
epoch:  28000 quantization_loss:  0.026147743687033653
p mean is: tensor(0.7270, device='cuda:3')
epoch:  29000 quantization_loss:  0.026069821789860725
p mean is: tensor(0.7555, device='cuda:3')
epoch:  30000 quantization_loss:  0.025963203981518745
p mean is: tensor(0.7805, device='cuda:3')
epoch:  31000 quantization_loss:  0.025860754773020744
p mean is: tensor(0.8025, device='cuda:3')
epoch:  32000 quantization_loss:  0.02579936571419239
p mean is: tensor(0.8220, device='cuda:3')
epoch:  33000 quantization_loss:  0.025754911825060844
p mean is: tensor(0.8391, device='cuda:3')
epoch:  34000 quantization_loss:  0.02565580978989601
p mean is: tensor(0.8543, device='cuda:3')
epoch:  35000 quantization_loss:  0.025558292865753174
p mean is: tensor(0.8676, device='cuda:3')
epoch:  36000 quantization_loss:  0.02554553933441639
p mean is: tensor(0.8794, device='cuda:3')
epoch:  37000 quantization_loss:  0.025474373251199722
p mean is: tensor(0.8900, device='cuda:3')
epoch:  38000 quantization_loss:  0.02542039379477501
p mean is: tensor(0.8995, device='cuda:3')
epoch:  39000 quantization_loss:  0.02538110502064228
p mean is: tensor(0.9078, device='cuda:3')
epoch:  40000 quantization_loss:  0.025359133258461952
p mean is: tensor(0.9152, device='cuda:3')
epoch:  41000 quantization_loss:  0.025306224822998047
p mean is: tensor(0.9219, device='cuda:3')
epoch:  42000 quantization_loss:  0.02529706247150898
p mean is: tensor(0.9279, device='cuda:3')
epoch:  43000 quantization_loss:  0.025244684889912605
p mean is: tensor(0.9334, device='cuda:3')
epoch:  44000 quantization_loss:  0.025234224274754524
p mean is: tensor(0.9384, device='cuda:3')
epoch:  45000 quantization_loss:  0.0251998882740736
p mean is: tensor(0.9428, device='cuda:3')
epoch:  46000 quantization_loss:  0.025177044793963432
p mean is: tensor(0.9470, device='cuda:3')
epoch:  47000 quantization_loss:  0.025159258395433426
p mean is: tensor(0.9508, device='cuda:3')
epoch:  48000 quantization_loss:  0.025163082405924797
p mean is: tensor(0.9543, device='cuda:3')
epoch:  49000 quantization_loss:  0.0251235943287611
p mean is: tensor(0.9574, device='cuda:3')
epoch:  50000 quantization_loss:  0.025114718824625015
p mean is: tensor(0.9604, device='cuda:3')
epoch:  51000 quantization_loss:  0.025095315650105476
p mean is: tensor(0.9631, device='cuda:3')
epoch:  52000 quantization_loss:  0.026049649342894554
p mean is: tensor(0.9656, device='cuda:3')
epoch:  53000 quantization_loss:  0.0250705499202013
p mean is: tensor(0.9679, device='cuda:3')
epoch:  54000 quantization_loss:  0.02506219409406185
p mean is: tensor(0.9701, device='cuda:3')
epoch:  55000 quantization_loss:  0.025038326159119606
p mean is: tensor(0.9721, device='cuda:3')
epoch:  56000 quantization_loss:  0.025049788877367973
p mean is: tensor(0.9740, device='cuda:3')
epoch:  57000 quantization_loss:  0.025023899972438812
p mean is: tensor(0.9757, device='cuda:3')
epoch:  58000 quantization_loss:  0.025018678978085518
p mean is: tensor(0.9774, device='cuda:3')
epoch:  59000 quantization_loss:  0.025004712864756584
p mean is: tensor(0.9790, device='cuda:3')
epoch:  60000 quantization_loss:  0.025005558505654335
p mean is: tensor(0.9805, device='cuda:3')
epoch:  61000 quantization_loss:  0.02500084973871708
p mean is: tensor(0.9820, device='cuda:3')
epoch:  62000 quantization_loss:  0.02500501647591591
p mean is: tensor(0.9833, device='cuda:3')
epoch:  63000 quantization_loss:  0.024988068267703056
p mean is: tensor(0.9847, device='cuda:3')
epoch:  64000 quantization_loss:  0.024985522031784058
p mean is: tensor(0.9859, device='cuda:3')
epoch:  65000 quantization_loss:  0.024982254952192307
p mean is: tensor(0.9871, device='cuda:3')
epoch:  66000 quantization_loss:  0.024976123124361038
p mean is: tensor(0.9881, device='cuda:3')
epoch:  67000 quantization_loss:  0.02497241646051407
p mean is: tensor(0.9892, device='cuda:3')
epoch:  68000 quantization_loss:  0.024958081543445587
p mean is: tensor(0.9903, device='cuda:3')
epoch:  69000 quantization_loss:  0.0249536894261837
p mean is: tensor(0.9913, device='cuda:3')
epoch:  70000 quantization_loss:  0.024953916668891907
p mean is: tensor(0.9923, device='cuda:3')
epoch:  71000 quantization_loss:  0.024948325008153915
p mean is: tensor(0.9932, device='cuda:3')
epoch:  72000 quantization_loss:  0.024948203936219215
p mean is: tensor(0.9941, device='cuda:3')
epoch:  73000 quantization_loss:  0.02494162879884243
p mean is: tensor(0.9949, device='cuda:3')
epoch:  74000 quantization_loss:  0.02496901899576187
p mean is: tensor(0.9957, device='cuda:3')
epoch:  75000 quantization_loss:  0.024937979876995087
p mean is: tensor(0.9965, device='cuda:3')
epoch:  76000 quantization_loss:  0.0249410979449749
p mean is: tensor(0.9973, device='cuda:3')
epoch:  77000 quantization_loss:  0.024927204474806786
p mean is: tensor(0.9981, device='cuda:3')
epoch:  78000 quantization_loss:  0.024925431236624718
p mean is: tensor(0.9989, device='cuda:3')
epoch:  79000 quantization_loss:  0.024930262938141823
p mean is: tensor(0.9996, device='cuda:3')
1.1.1.weight         | nonzeros =   11128 /   12800             ( 86.94%) | total_pruned =    1672 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.weight           | nonzeros =      13 /      16             ( 81.25%) | total_pruned =       3 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    6217 /    6400             ( 97.14%) | total_pruned =     183 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.weight           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =   12711 /   12800             ( 99.30%) | total_pruned =      89 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      18 /      32             ( 56.25%) | total_pruned =      14 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =   25481 /   25600             ( 99.54%) | total_pruned =     119 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      20 /      32             ( 62.50%) | total_pruned =      12 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   51080 /   51200             ( 99.77%) | total_pruned =     120 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      45 /      64             ( 70.31%) | total_pruned =      19 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =  102282 /  102400             ( 99.88%) | total_pruned =     118 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      41 /      64             ( 64.06%) | total_pruned =      23 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =  204704 /  204800             ( 99.95%) | total_pruned =      96 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =  409425 /  409600             ( 99.96%) | total_pruned =     175 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  409174 /  409600             ( 99.90%) | total_pruned =     426 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     102 /     128             ( 79.69%) | total_pruned =      26 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  406038 /  409600             ( 99.13%) | total_pruned =    3562 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      95 /     128             ( 74.22%) | total_pruned =      33 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  396643 /  409600             ( 96.84%) | total_pruned =   12957 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     102 /     128             ( 79.69%) | total_pruned =      26 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  370519 /  409600             ( 90.46%) | total_pruned =   39081 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     101 /     128             ( 78.91%) | total_pruned =      27 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  118214 /  147456             ( 80.17%) | total_pruned =   29242 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      96 /     128             ( 75.00%) | total_pruned =      32 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      86 /     128             ( 67.19%) | total_pruned =      42 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  120122 /  147456             ( 81.46%) | total_pruned =   27334 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =  124771 /  147456             ( 84.62%) | total_pruned =   22685 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      71 /     128             ( 55.47%) | total_pruned =      57 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   65307 /   73728             ( 88.58%) | total_pruned =    8421 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      35 /      64             ( 54.69%) | total_pruned =      29 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      29 /      64             ( 45.31%) | total_pruned =      35 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =   15960 /   18432             ( 86.59%) | total_pruned =    2472 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    3189 /    4608             ( 69.21%) | total_pruned =    1419 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      32 /      48             ( 66.67%) | total_pruned =      16 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       0 /       3             (  0.00%) | total_pruned =       3 | shape = torch.Size([3])
alive: 2855928, pruned : 152939, total: 3008867, Compression rate :       1.05x  (  5.08% pruned)
(3, 512, 512) (3, 512, 512) (3, 512, 512)
PSNR of output image is:  17.575902341243832
Experiment done
