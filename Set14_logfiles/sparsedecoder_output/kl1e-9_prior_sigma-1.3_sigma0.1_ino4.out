(3, 512, 512)
Starting vanilla DIP on 4 using SAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '19.75459704935201'
[128, 128, 128, 128, 128]
Number of params in decoder: 100224
torch.Size([1, 128, 16, 16])
Starting optimization with optimizer 'SAM'
Output directory where image taken from: data/denoising/Set14/decoder_mask/4/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/-1.3/1e-09
Output directory where results stored: data/denoising/Set14/decoder_mask/4/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/-1.3/1e-09/out_sparsenet/0.1
1.1.weight           | nonzeros =    5379 /   16384             ( 32.83%) | total_pruned =   11005 | shape = torch.Size([128, 128, 1, 1])
4.weight             | nonzeros =      82 /     128             ( 64.06%) | total_pruned =      46 | shape = torch.Size([128])
4.bias               | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
5.1.weight           | nonzeros =    4074 /   16384             ( 24.87%) | total_pruned =   12310 | shape = torch.Size([128, 128, 1, 1])
8.weight             | nonzeros =      95 /     128             ( 74.22%) | total_pruned =      33 | shape = torch.Size([128])
8.bias               | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
9.1.weight           | nonzeros =    4923 /   16384             ( 30.05%) | total_pruned =   11461 | shape = torch.Size([128, 128, 1, 1])
12.weight            | nonzeros =     103 /     128             ( 80.47%) | total_pruned =      25 | shape = torch.Size([128])
12.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
13.1.weight          | nonzeros =    4114 /   16384             ( 25.11%) | total_pruned =   12270 | shape = torch.Size([128, 128, 1, 1])
16.weight            | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
16.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
17.1.weight          | nonzeros =    3090 /   16384             ( 18.86%) | total_pruned =   13294 | shape = torch.Size([128, 128, 1, 1])
20.weight            | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
20.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
21.1.weight          | nonzeros =    3974 /   16384             ( 24.26%) | total_pruned =   12410 | shape = torch.Size([128, 128, 1, 1])
23.weight            | nonzeros =     115 /     128             ( 89.84%) | total_pruned =      13 | shape = torch.Size([128])
23.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
24.1.weight          | nonzeros =     210 /     384             ( 54.69%) | total_pruned =     174 | shape = torch.Size([3, 128, 1, 1])
alive: 26321, pruned : 73903, total: 100224, Compression rate :       3.81x  ( 73.74% pruned)
Initial PSNR of output image is:  18.629265352719656
epoch:  0 loss:  0.021495435386896133 PSNR:  18.629265352719656
epoch:  200 loss:  0.013026571832597256 PSNR:  23.848321123703627
epoch:  400 loss:  0.011756944470107555 PSNR:  25.533171733775134
epoch:  600 loss:  0.011371364817023277 PSNR:  26.15571155612769
epoch:  800 loss:  0.011403035372495651 PSNR:  25.931807622157706
epoch:  1000 loss:  0.011891400441527367 PSNR:  25.339160562129337
epoch:  1200 loss:  0.011625236831605434 PSNR:  25.678278192683482
epoch:  1400 loss:  0.01134621724486351 PSNR:  26.197025554614637
epoch:  1600 loss:  0.012050159275531769 PSNR:  25.15154553167597
epoch:  1800 loss:  0.01140372734516859 PSNR:  26.143842757890855
epoch:  2000 loss:  0.011183632537722588 PSNR:  26.528655118719936
epoch:  2200 loss:  0.01123033370822668 PSNR:  26.34150046123004
epoch:  2400 loss:  0.011022895574569702 PSNR:  26.724427385681796
epoch:  2600 loss:  0.010903237387537956 PSNR:  26.929805399174064
epoch:  2800 loss:  0.016346463933587074 PSNR:  21.067640392104675
epoch:  3000 loss:  0.012239239178597927 PSNR:  24.814359022223208
epoch:  3200 loss:  0.011762868613004684 PSNR:  25.530708560470273
epoch:  3400 loss:  0.01161965262144804 PSNR:  25.767337067724814
epoch:  3600 loss:  0.011371317319571972 PSNR:  26.04712061242356
epoch:  3800 loss:  0.011103115975856781 PSNR:  26.60532968367442
epoch:  4000 loss:  0.011085986159741879 PSNR:  26.615115523025775
epoch:  4200 loss:  0.011091373860836029 PSNR:  26.528220992184064
epoch:  4400 loss:  0.010990319773554802 PSNR:  26.66105544316857
epoch:  4600 loss:  0.010901659727096558 PSNR:  26.889416909981637
epoch:  4800 loss:  0.010938400402665138 PSNR:  26.8252524585365
epoch:  5000 loss:  0.010838553309440613 PSNR:  26.953078238562803
epoch:  5200 loss:  0.01081843487918377 PSNR:  27.080037771734382
epoch:  5400 loss:  0.010758250951766968 PSNR:  27.10097765700095
epoch:  5600 loss:  0.01083641778677702 PSNR:  26.887294268229226
epoch:  5800 loss:  0.01075603999197483 PSNR:  27.09154577544043
epoch:  6000 loss:  0.011219421401619911 PSNR:  26.16143964179125
epoch:  6200 loss:  0.011086042039096355 PSNR:  26.477465485017603
epoch:  6400 loss:  0.010772760026156902 PSNR:  27.038409657067014
epoch:  6600 loss:  0.010688792914152145 PSNR:  27.26327374665052
epoch:  6800 loss:  0.01069618295878172 PSNR:  27.197033111594383
epoch:  7000 loss:  0.010582000017166138 PSNR:  27.445587179292176
epoch:  7200 loss:  0.010592808946967125 PSNR:  27.435689576061915
epoch:  7400 loss:  0.01086685061454773 PSNR:  27.103394943798836
epoch:  7600 loss:  0.010660036467015743 PSNR:  27.422786700824663
epoch:  7800 loss:  0.010603927075862885 PSNR:  27.534269242384276
epoch:  8000 loss:  0.010678578168153763 PSNR:  27.256253043214407
epoch:  8200 loss:  0.010745219886302948 PSNR:  27.32793326487561
epoch:  8400 loss:  0.010550725273787975 PSNR:  27.56315644940947
epoch:  8600 loss:  0.010602841153740883 PSNR:  27.361925266853643
epoch:  8800 loss:  0.010503603145480156 PSNR:  27.56987485409295
epoch:  9000 loss:  0.01070362702012062 PSNR:  27.07156466888651
epoch:  9200 loss:  0.011791495606303215 PSNR:  25.27500597865346
epoch:  9400 loss:  0.010496030561625957 PSNR:  27.576092517222182
epoch:  9600 loss:  0.01044803112745285 PSNR:  27.627755462424396
epoch:  9800 loss:  0.010454520583152771 PSNR:  27.620141425052246
epoch:  10000 loss:  0.010473272763192654 PSNR:  27.55830082326089
epoch:  10200 loss:  0.010419830679893494 PSNR:  27.639994576306783
epoch:  10400 loss:  0.01253286562860012 PSNR:  24.457299592784707
epoch:  10600 loss:  0.011723730713129044 PSNR:  25.593106095582737
epoch:  10800 loss:  0.011420357041060925 PSNR:  26.05598393711301
epoch:  11000 loss:  0.011119826696813107 PSNR:  26.516106189327612
epoch:  11200 loss:  0.011005095206201077 PSNR:  26.749950357446256
epoch:  11400 loss:  0.01098763756453991 PSNR:  26.800897101850296
epoch:  11600 loss:  0.01098007895052433 PSNR:  26.632573694442165
epoch:  11800 loss:  0.011039406061172485 PSNR:  26.732565910342036
epoch:  12000 loss:  0.01111516635864973 PSNR:  26.60009757236212
epoch:  12200 loss:  0.011043354868888855 PSNR:  26.440135428020227
epoch:  12400 loss:  0.010793393477797508 PSNR:  27.13835017088989
epoch:  12600 loss:  0.010681942105293274 PSNR:  27.274549713982598
epoch:  12800 loss:  0.010632979683578014 PSNR:  27.341517757076428
epoch:  13000 loss:  0.010661294683814049 PSNR:  27.28399089589361
epoch:  13200 loss:  0.01071392372250557 PSNR:  27.13656481958292
epoch:  13400 loss:  0.010581839829683304 PSNR:  27.420788779499404
epoch:  13600 loss:  0.01055847480893135 PSNR:  27.45791118791356
epoch:  13800 loss:  0.010567080229520798 PSNR:  27.368340168903778
epoch:  14000 loss:  0.011005394160747528 PSNR:  26.66383267538282
epoch:  14200 loss:  0.01052914373576641 PSNR:  27.44896721225636
epoch:  14400 loss:  0.010621349327266216 PSNR:  27.406940857880755
epoch:  14600 loss:  0.010684657841920853 PSNR:  27.053290849004767
epoch:  14800 loss:  0.010597482323646545 PSNR:  27.186164281533696
epoch:  15000 loss:  0.010578400455415249 PSNR:  27.323224083512375
epoch:  15200 loss:  0.010599479079246521 PSNR:  27.16044397891068
epoch:  15400 loss:  0.013388278894126415 PSNR:  23.012620251472903
epoch:  15600 loss:  0.010560138151049614 PSNR:  27.23953721992759
epoch:  15800 loss:  0.010500012896955013 PSNR:  27.460417979574913
epoch:  16000 loss:  0.010472316294908524 PSNR:  27.520658864540568
epoch:  16200 loss:  0.010469064116477966 PSNR:  27.4938131677373
epoch:  16400 loss:  0.010516504757106304 PSNR:  27.381490280569302
epoch:  16600 loss:  0.010411866009235382 PSNR:  27.639715838604367
epoch:  16800 loss:  0.010416317731142044 PSNR:  27.624433540685473
epoch:  17000 loss:  0.010472405701875687 PSNR:  27.490173804526247
epoch:  17200 loss:  0.010501695796847343 PSNR:  27.425542946895813
epoch:  17400 loss:  0.010460086166858673 PSNR:  27.45701558593419
epoch:  17600 loss:  0.01042881514877081 PSNR:  27.541362779452633
epoch:  17800 loss:  0.010523982346057892 PSNR:  27.3403737966982
epoch:  18000 loss:  0.010393580421805382 PSNR:  27.641043833704174
epoch:  18200 loss:  0.010475262068212032 PSNR:  27.362960827023223
epoch:  18400 loss:  0.010413561016321182 PSNR:  27.609692051166643
epoch:  18600 loss:  0.010628371499478817 PSNR:  27.109929962675242
epoch:  18800 loss:  0.01048845611512661 PSNR:  27.292448574076857
epoch:  19000 loss:  0.010440507903695107 PSNR:  27.499639343322364
epoch:  19200 loss:  0.01035384926944971 PSNR:  27.68843439678442
epoch:  19400 loss:  0.011165156029164791 PSNR:  26.19792552184654
epoch:  19600 loss:  0.01037980243563652 PSNR:  27.637804603732814
epoch:  19800 loss:  0.01034638937562704 PSNR:  27.662862018278453
epoch:  20000 loss:  0.010462055914103985 PSNR:  27.457067785239136
epoch:  20200 loss:  0.010358244180679321 PSNR:  27.645321740145306
epoch:  20400 loss:  0.010637853294610977 PSNR:  26.890807979818383
epoch:  20600 loss:  0.010453338734805584 PSNR:  27.474939271500418
epoch:  20800 loss:  0.010388130322098732 PSNR:  27.55203476057957
epoch:  21000 loss:  0.010419651865959167 PSNR:  27.491003499990107
epoch:  21200 loss:  0.010381970554590225 PSNR:  27.50920938892503
epoch:  21400 loss:  0.01097396295517683 PSNR:  26.22012862814551
epoch:  21600 loss:  0.010494068264961243 PSNR:  27.394300750294384
epoch:  21800 loss:  0.010444441810250282 PSNR:  27.354953135993277
epoch:  22000 loss:  0.010370496660470963 PSNR:  27.60716557327307
epoch:  22200 loss:  0.010489260777831078 PSNR:  27.331228390584215
epoch:  22400 loss:  0.01037766132503748 PSNR:  27.534141654628634
epoch:  22600 loss:  0.010315495543181896 PSNR:  27.770837061300426
epoch:  22800 loss:  0.010471566580235958 PSNR:  27.20850803069876
epoch:  23000 loss:  0.01034117117524147 PSNR:  27.589267334515505
epoch:  23200 loss:  0.010455356910824776 PSNR:  27.37603573093417
epoch:  23400 loss:  0.010347800329327583 PSNR:  27.583958881593915
epoch:  23600 loss:  0.01041263248771429 PSNR:  27.498846498841957
epoch:  23800 loss:  0.01045021042227745 PSNR:  27.307283447171052
epoch:  24000 loss:  0.0103029515594244 PSNR:  27.766273340814145
epoch:  24200 loss:  0.010840478353202343 PSNR:  26.355885606526364
epoch:  24400 loss:  0.011459640227258205 PSNR:  25.247947117724244
epoch:  24600 loss:  0.01030891202390194 PSNR:  27.720787039622792
epoch:  24800 loss:  0.010350262746214867 PSNR:  27.636862658756016
epoch:  25000 loss:  0.010426959954202175 PSNR:  27.39069977581014
epoch:  25200 loss:  0.010524166747927666 PSNR:  27.2065806025717
epoch:  25400 loss:  0.010400824248790741 PSNR:  27.555496778386193
epoch:  25600 loss:  0.0103105204179883 PSNR:  27.645788545288124
epoch:  25800 loss:  0.010268298909068108 PSNR:  27.828992664291178
epoch:  26000 loss:  0.010295659303665161 PSNR:  27.746460567611905
epoch:  26200 loss:  0.010392948053777218 PSNR:  27.478881905215907
epoch:  26400 loss:  0.01027292013168335 PSNR:  27.79550455649421
epoch:  26600 loss:  0.010261215269565582 PSNR:  27.805603088572827
epoch:  26800 loss:  0.010315893217921257 PSNR:  27.568495962687585
epoch:  27000 loss:  0.010489102452993393 PSNR:  27.220041762211554
epoch:  27200 loss:  0.010276173241436481 PSNR:  27.69531292938268
epoch:  27400 loss:  0.010260282084345818 PSNR:  27.73529292785982
epoch:  27600 loss:  0.010269351303577423 PSNR:  27.68504203583688
epoch:  27800 loss:  0.01028756145387888 PSNR:  27.660342751417932
epoch:  28000 loss:  0.010327677242457867 PSNR:  27.595385702485295
epoch:  28200 loss:  0.010443823412060738 PSNR:  27.32102756555524
epoch:  28400 loss:  0.010249613784253597 PSNR:  27.80821857492065
epoch:  28600 loss:  0.010283831506967545 PSNR:  27.788284801760412
epoch:  28800 loss:  0.010361038148403168 PSNR:  27.562535107871685
epoch:  29000 loss:  0.01039055921137333 PSNR:  27.40421646005872
epoch:  29200 loss:  0.010518942028284073 PSNR:  26.959429799601825
epoch:  29400 loss:  0.0102318050339818 PSNR:  27.795078479271055
epoch:  29600 loss:  0.010270863771438599 PSNR:  27.67966793096356
epoch:  29800 loss:  0.010290057398378849 PSNR:  27.746177585229592
epoch:  30000 loss:  0.010288441553711891 PSNR:  27.694440962128894
epoch:  30200 loss:  0.010516120120882988 PSNR:  27.134437469755767
epoch:  30400 loss:  0.01031577493995428 PSNR:  27.602964505202088
epoch:  30600 loss:  0.01035241223871708 PSNR:  27.383239716492863
epoch:  30800 loss:  0.010261880233883858 PSNR:  27.6918333688538
epoch:  31000 loss:  0.010608534328639507 PSNR:  27.085724974344622
epoch:  31200 loss:  0.01049138605594635 PSNR:  27.208598063181107
epoch:  31400 loss:  0.01022501289844513 PSNR:  27.807445283996636
epoch:  31600 loss:  0.010361501947045326 PSNR:  27.409669130090858
epoch:  31800 loss:  0.010318679735064507 PSNR:  27.58387456034238
epoch:  32000 loss:  0.010269946418702602 PSNR:  27.694000257708105
epoch:  32200 loss:  0.010263731703162193 PSNR:  27.72744825567439
epoch:  32400 loss:  0.01035168394446373 PSNR:  27.466414064903816
epoch:  32600 loss:  0.010559113696217537 PSNR:  26.880117167439366
epoch:  32800 loss:  0.010230263695120811 PSNR:  27.813067827268174
epoch:  33000 loss:  0.01037471741437912 PSNR:  27.5037501252881
epoch:  33200 loss:  0.010264115408062935 PSNR:  27.76328919992053
epoch:  33400 loss:  0.01028699055314064 PSNR:  27.621948473488665
epoch:  33600 loss:  0.010234219953417778 PSNR:  27.730372910352237
epoch:  33800 loss:  0.010237228125333786 PSNR:  27.74467444605424
epoch:  34000 loss:  0.01028073113411665 PSNR:  27.617809635923503
epoch:  34200 loss:  0.010508492588996887 PSNR:  27.291003670565548
epoch:  34400 loss:  0.010488593950867653 PSNR:  27.20908102337139
epoch:  34600 loss:  0.010202107019722462 PSNR:  27.84387709707203
epoch:  34800 loss:  0.010235248133540154 PSNR:  27.71856823883698
epoch:  35000 loss:  0.010239969938993454 PSNR:  27.787443885417925
epoch:  35200 loss:  0.010210569016635418 PSNR:  27.81517896523993
epoch:  35400 loss:  0.010297291912138462 PSNR:  27.592998145908346
epoch:  35600 loss:  0.01033350732177496 PSNR:  27.395298760547618
epoch:  35800 loss:  0.010219592601060867 PSNR:  27.834594092623142
epoch:  36000 loss:  0.010313010774552822 PSNR:  27.58502430254413
epoch:  36200 loss:  0.010378527455031872 PSNR:  27.299253482159138
epoch:  36400 loss:  0.010312681086361408 PSNR:  27.580716589047015
epoch:  36600 loss:  0.010234532877802849 PSNR:  27.760915162550702
epoch:  36800 loss:  0.01020753849297762 PSNR:  27.812820503402843
epoch:  37000 loss:  0.010452928952872753 PSNR:  27.318810963409
epoch:  37200 loss:  0.010221530683338642 PSNR:  27.742020504721296
epoch:  37400 loss:  0.010464857332408428 PSNR:  27.230450481247885
epoch:  37600 loss:  0.010240393690764904 PSNR:  27.658487901161052
epoch:  37800 loss:  0.010245164856314659 PSNR:  27.71021557199465
epoch:  38000 loss:  0.010944905690848827 PSNR:  26.245681695730553
epoch:  38200 loss:  0.010218324139714241 PSNR:  27.723787975747832
epoch:  38400 loss:  0.010263659060001373 PSNR:  27.68484867134907
epoch:  38600 loss:  0.010303075425326824 PSNR:  27.574193015577677
epoch:  38800 loss:  0.010243070311844349 PSNR:  27.643996678652254
epoch:  39000 loss:  0.010565835982561111 PSNR:  27.051585101684612
epoch:  39200 loss:  0.010423089377582073 PSNR:  27.142989474139267
epoch:  39400 loss:  0.010198084637522697 PSNR:  27.789126555777557
epoch:  39600 loss:  0.010294139385223389 PSNR:  27.5588284431997
epoch:  39800 loss:  0.010205446742475033 PSNR:  27.74652872669079
PSNR of output image is:  27.74652872669079
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
