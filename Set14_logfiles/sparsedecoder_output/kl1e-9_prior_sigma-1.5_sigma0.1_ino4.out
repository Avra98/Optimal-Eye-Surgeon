(3, 512, 512)
Starting vanilla DIP on 4 using SAM(sigma=0.1,lr=0.01,decay=0,beta=0)
Noisy PSNR is '19.75097233519681'
[128, 128, 128, 128, 128]
Number of params in decoder: 100224
torch.Size([1, 128, 16, 16])
Starting optimization with optimizer 'SAM'
Output directory where image taken from: data/denoising/Set14/decoder_mask/4/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/-1.5/1e-09
Output directory where results stored: data/denoising/Set14/decoder_mask/4/SAM(sigma=0.1,lr=0.01,decay=0,beta=0)/det/-1.5/1e-09/out_sparsenet/0.1
1.1.weight           | nonzeros =    4980 /   16384             ( 30.40%) | total_pruned =   11404 | shape = torch.Size([128, 128, 1, 1])
4.weight             | nonzeros =      75 /     128             ( 58.59%) | total_pruned =      53 | shape = torch.Size([128])
4.bias               | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
5.1.weight           | nonzeros =    3842 /   16384             ( 23.45%) | total_pruned =   12542 | shape = torch.Size([128, 128, 1, 1])
8.weight             | nonzeros =      99 /     128             ( 77.34%) | total_pruned =      29 | shape = torch.Size([128])
8.bias               | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
9.1.weight           | nonzeros =    4585 /   16384             ( 27.98%) | total_pruned =   11799 | shape = torch.Size([128, 128, 1, 1])
12.weight            | nonzeros =      95 /     128             ( 74.22%) | total_pruned =      33 | shape = torch.Size([128])
12.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
13.1.weight          | nonzeros =    3846 /   16384             ( 23.47%) | total_pruned =   12538 | shape = torch.Size([128, 128, 1, 1])
16.weight            | nonzeros =      84 /     128             ( 65.62%) | total_pruned =      44 | shape = torch.Size([128])
16.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
17.1.weight          | nonzeros =    3345 /   16384             ( 20.42%) | total_pruned =   13039 | shape = torch.Size([128, 128, 1, 1])
20.weight            | nonzeros =      84 /     128             ( 65.62%) | total_pruned =      44 | shape = torch.Size([128])
20.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
21.1.weight          | nonzeros =    4395 /   16384             ( 26.82%) | total_pruned =   11989 | shape = torch.Size([128, 128, 1, 1])
23.weight            | nonzeros =     122 /     128             ( 95.31%) | total_pruned =       6 | shape = torch.Size([128])
23.bias              | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
24.1.weight          | nonzeros =     223 /     384             ( 58.07%) | total_pruned =     161 | shape = torch.Size([3, 128, 1, 1])
alive: 25775, pruned : 74449, total: 100224, Compression rate :       3.89x  ( 74.28% pruned)
Initial PSNR of output image is:  18.978562091205436
epoch:  0 loss:  0.020517468452453613 PSNR:  18.978562091205436
epoch:  200 loss:  0.012751959264278412 PSNR:  24.141047470540457
epoch:  400 loss:  0.013076040893793106 PSNR:  23.718270242637605
epoch:  600 loss:  0.011975998990237713 PSNR:  25.197279350186275
epoch:  800 loss:  0.011610324494540691 PSNR:  25.775305614993247
epoch:  1000 loss:  0.011343139223754406 PSNR:  26.12953273113083
epoch:  1200 loss:  0.011086533777415752 PSNR:  26.65139284282607
epoch:  1400 loss:  0.011018052697181702 PSNR:  26.788174212017914
epoch:  1600 loss:  0.010903268121182919 PSNR:  26.97234200974129
epoch:  1800 loss:  0.011003177613019943 PSNR:  26.718488729712835
epoch:  2000 loss:  0.011031785979866982 PSNR:  26.638510625813353
epoch:  2200 loss:  0.010841351002454758 PSNR:  27.027522436224597
epoch:  2400 loss:  0.010868228040635586 PSNR:  26.92010009255837
epoch:  2600 loss:  0.012413306161761284 PSNR:  24.62165004598813
epoch:  2800 loss:  0.011208925396203995 PSNR:  26.50634580616203
epoch:  3000 loss:  0.011476680636405945 PSNR:  26.087452526063796
epoch:  3200 loss:  0.011005024425685406 PSNR:  26.894064787042325
epoch:  3400 loss:  0.010922199115157127 PSNR:  26.957008849604232
epoch:  3600 loss:  0.010895091108977795 PSNR:  26.962433619588566
epoch:  3800 loss:  0.010709922760725021 PSNR:  27.366675399102377
epoch:  4000 loss:  0.01148517057299614 PSNR:  26.07559300372095
epoch:  4200 loss:  0.01103814598172903 PSNR:  26.792557483842575
epoch:  4400 loss:  0.010864700190722942 PSNR:  27.071692808959895
epoch:  4600 loss:  0.010958394035696983 PSNR:  26.829550243975753
epoch:  4800 loss:  0.011081118136644363 PSNR:  26.490341917595273
epoch:  5000 loss:  0.010676814243197441 PSNR:  27.323632966350544
epoch:  5200 loss:  0.010571344755589962 PSNR:  27.577644147039756
epoch:  5400 loss:  0.010608232580125332 PSNR:  27.447687617427118
epoch:  5600 loss:  0.010647615417838097 PSNR:  27.232347277711696
epoch:  5800 loss:  0.010594951920211315 PSNR:  27.42639111202739
epoch:  6000 loss:  0.010690162889659405 PSNR:  27.096181633749474
epoch:  6200 loss:  0.010489046573638916 PSNR:  27.602504865911946
epoch:  6400 loss:  0.010474763810634613 PSNR:  27.60680319634295
epoch:  6600 loss:  0.010557753965258598 PSNR:  27.382397478215278
epoch:  6800 loss:  0.010491900146007538 PSNR:  27.535545644411474
epoch:  7000 loss:  0.010443302802741528 PSNR:  27.626439648923217
epoch:  7200 loss:  0.010491735301911831 PSNR:  27.43494532660959
epoch:  7400 loss:  0.010419162921607494 PSNR:  27.651950503333556
epoch:  7600 loss:  0.01052447222173214 PSNR:  27.327963606506735
epoch:  7800 loss:  0.010552413761615753 PSNR:  27.25225000836838
epoch:  8000 loss:  0.010355688631534576 PSNR:  27.794202803887753
epoch:  8200 loss:  0.010362900793552399 PSNR:  27.70454419271493
epoch:  8400 loss:  0.01055009663105011 PSNR:  27.30090556792305
epoch:  8600 loss:  0.010361253283917904 PSNR:  27.744031595361804
epoch:  8800 loss:  0.010333376005291939 PSNR:  27.81392661522815
epoch:  9000 loss:  0.010450741276144981 PSNR:  27.539082451272442
epoch:  9200 loss:  0.010338189080357552 PSNR:  27.72842436355726
epoch:  9400 loss:  0.010346872732043266 PSNR:  27.782452674059122
epoch:  9600 loss:  0.01049829926341772 PSNR:  27.28713410680387
epoch:  9800 loss:  0.010465002618730068 PSNR:  27.347239949868467
epoch:  10000 loss:  0.010313315317034721 PSNR:  27.797948634685916
epoch:  10200 loss:  0.010379582643508911 PSNR:  27.600242611066403
epoch:  10400 loss:  0.010284435003995895 PSNR:  27.826018894979576
epoch:  10600 loss:  0.010255862027406693 PSNR:  27.948314808035125
epoch:  10800 loss:  0.010391727089881897 PSNR:  27.608669760735367
epoch:  11000 loss:  0.010297926142811775 PSNR:  27.82063208347647
epoch:  11200 loss:  0.010351662524044514 PSNR:  27.677707794767183
epoch:  11400 loss:  0.010355934500694275 PSNR:  27.646767040267886
epoch:  11600 loss:  0.010304747149348259 PSNR:  27.772203416069235
epoch:  11800 loss:  0.010265707969665527 PSNR:  27.87751895483983
epoch:  12000 loss:  0.010301928967237473 PSNR:  27.731785529316625
epoch:  12200 loss:  0.010523883625864983 PSNR:  27.217987621665888
epoch:  12400 loss:  0.010276539251208305 PSNR:  27.817717014636877
epoch:  12600 loss:  0.010362111032009125 PSNR:  27.51765649630654
epoch:  12800 loss:  0.010273738764226437 PSNR:  27.85581743901097
epoch:  13000 loss:  0.010259641334414482 PSNR:  27.849515901421515
epoch:  13200 loss:  0.010308205150067806 PSNR:  27.7454626941675
epoch:  13400 loss:  0.010419580154120922 PSNR:  27.332231447658337
epoch:  13600 loss:  0.010238539427518845 PSNR:  27.874843516236446
epoch:  13800 loss:  0.010353773832321167 PSNR:  27.510243653505846
epoch:  14000 loss:  0.010259347967803478 PSNR:  27.831961996923432
epoch:  14200 loss:  0.010273456573486328 PSNR:  27.816756625659803
epoch:  14400 loss:  0.010270809754729271 PSNR:  27.774512342790295
epoch:  14600 loss:  0.010283466428518295 PSNR:  27.77703446920784
epoch:  14800 loss:  0.01023383904248476 PSNR:  27.864325398230694
epoch:  15000 loss:  0.010286456905305386 PSNR:  27.704124630108176
epoch:  15200 loss:  0.01026834174990654 PSNR:  27.80976896012525
epoch:  15400 loss:  0.010320598259568214 PSNR:  27.672084921278014
epoch:  15600 loss:  0.01023743487894535 PSNR:  27.891054602718516
epoch:  15800 loss:  0.0102206626906991 PSNR:  27.899823341912693
epoch:  16000 loss:  0.01023106835782528 PSNR:  27.86049034632117
epoch:  16200 loss:  0.01022270880639553 PSNR:  27.8502963781877
epoch:  16400 loss:  0.010250037536025047 PSNR:  27.786425761418407
epoch:  16600 loss:  0.010253708809614182 PSNR:  27.69706168359123
epoch:  16800 loss:  0.010168967768549919 PSNR:  27.990617495156656
epoch:  17000 loss:  0.010209890082478523 PSNR:  27.89914396193277
epoch:  17200 loss:  0.010277672670781612 PSNR:  27.61182351384381
epoch:  17400 loss:  0.010290640406310558 PSNR:  27.690941648096256
epoch:  17600 loss:  0.01019444689154625 PSNR:  27.888170944177276
epoch:  17800 loss:  0.01019606925547123 PSNR:  27.902292569979355
epoch:  18000 loss:  0.010267145931720734 PSNR:  27.67756211095344
epoch:  18200 loss:  0.010284479707479477 PSNR:  27.581990310929058
epoch:  18400 loss:  0.010182803496718407 PSNR:  27.940183384267616
epoch:  18600 loss:  0.010288868099451065 PSNR:  27.60017574044737
epoch:  18800 loss:  0.010198703035712242 PSNR:  27.873947137924624
epoch:  19000 loss:  0.010252896696329117 PSNR:  27.779384008093242
epoch:  19200 loss:  0.010178375989198685 PSNR:  27.912147446400155
epoch:  19400 loss:  0.010162647813558578 PSNR:  27.97759645519981
epoch:  19600 loss:  0.010225660167634487 PSNR:  27.774248710746924
epoch:  19800 loss:  0.010319408029317856 PSNR:  27.475877818709314
epoch:  20000 loss:  0.010198861360549927 PSNR:  27.830704117314255
epoch:  20200 loss:  0.010286632925271988 PSNR:  27.61936294131185
epoch:  20400 loss:  0.010167798958718777 PSNR:  27.926977390428092
epoch:  20600 loss:  0.010259825736284256 PSNR:  27.72958207101169
epoch:  20800 loss:  0.010201940312981606 PSNR:  27.832115338689583
epoch:  21000 loss:  0.010212264955043793 PSNR:  27.809200127508127
epoch:  21200 loss:  0.010230774991214275 PSNR:  27.79267518659652
epoch:  21400 loss:  0.010216018185019493 PSNR:  27.827024560910107
epoch:  21600 loss:  0.010225342586636543 PSNR:  27.800152898182464
epoch:  21800 loss:  0.010214084759354591 PSNR:  27.73150916185645
epoch:  22000 loss:  0.01013847067952156 PSNR:  28.018022302377194
epoch:  22200 loss:  0.010176334530115128 PSNR:  27.909461696975022
epoch:  22400 loss:  0.010166555643081665 PSNR:  27.92939380652009
epoch:  22600 loss:  0.010150676593184471 PSNR:  27.954794751944704
epoch:  22800 loss:  0.010237426497042179 PSNR:  27.698445663566538
epoch:  23000 loss:  0.010133401490747929 PSNR:  27.985382789434542
epoch:  23200 loss:  0.010172946378588676 PSNR:  27.86622805258673
epoch:  23400 loss:  0.010148349218070507 PSNR:  27.952371872634735
epoch:  23600 loss:  0.010129706002771854 PSNR:  27.98828335093336
epoch:  23800 loss:  0.010219461284577847 PSNR:  27.682223126580602
epoch:  24000 loss:  0.010162691585719585 PSNR:  27.88567247030921
epoch:  24200 loss:  0.010137233883142471 PSNR:  27.995770761988688
epoch:  24400 loss:  0.010260054841637611 PSNR:  27.63329808545931
epoch:  24600 loss:  0.010150730609893799 PSNR:  27.95243388204979
epoch:  24800 loss:  0.010141085833311081 PSNR:  27.91647624649083
epoch:  25000 loss:  0.010216907598078251 PSNR:  27.79272280042384
epoch:  25200 loss:  0.010133955627679825 PSNR:  27.941471983177696
epoch:  25400 loss:  0.010139397345483303 PSNR:  27.98120097367752
epoch:  25600 loss:  0.010244587436318398 PSNR:  27.71564322657017
epoch:  25800 loss:  0.010166388005018234 PSNR:  27.877604353671018
epoch:  26000 loss:  0.010150070302188396 PSNR:  27.87266878555608
epoch:  26200 loss:  0.010160421952605247 PSNR:  27.945589815935868
epoch:  26400 loss:  0.010128270834684372 PSNR:  27.97865546785982
epoch:  26600 loss:  0.010148628614842892 PSNR:  27.926653840464006
epoch:  26800 loss:  0.01024733204394579 PSNR:  27.588387081552565
epoch:  27000 loss:  0.01014090608805418 PSNR:  27.893538203474357
epoch:  27200 loss:  0.010175387375056744 PSNR:  27.821881949350946
epoch:  27400 loss:  0.010136142373085022 PSNR:  27.982187141101477
epoch:  27600 loss:  0.010147939436137676 PSNR:  27.921968725548428
epoch:  27800 loss:  0.010220135562121868 PSNR:  27.761550123942314
epoch:  28000 loss:  0.010198982432484627 PSNR:  27.692609443575734
epoch:  28200 loss:  0.010135546326637268 PSNR:  27.926481452855796
epoch:  28400 loss:  0.010126017034053802 PSNR:  27.968168361570946
epoch:  28600 loss:  0.010143275372684002 PSNR:  27.901598260653714
epoch:  28800 loss:  0.010232653468847275 PSNR:  27.652472296163694
epoch:  29000 loss:  0.010144961066544056 PSNR:  27.903572398458792
epoch:  29200 loss:  0.010180513374507427 PSNR:  27.782066951048083
epoch:  29400 loss:  0.010155059397220612 PSNR:  27.841090828786427
epoch:  29600 loss:  0.010146412067115307 PSNR:  27.849129649814035
epoch:  29800 loss:  0.010131455026566982 PSNR:  27.891604894251817
epoch:  30000 loss:  0.010135790333151817 PSNR:  27.91468481888615
epoch:  30200 loss:  0.010189846158027649 PSNR:  27.814296173646373
epoch:  30400 loss:  0.010227292776107788 PSNR:  27.750884772939575
epoch:  30600 loss:  0.010160892270505428 PSNR:  27.889041951838713
epoch:  30800 loss:  0.010183757171034813 PSNR:  27.78699397939914
epoch:  31000 loss:  0.01012088917195797 PSNR:  27.97251678599272
epoch:  31200 loss:  0.01012660376727581 PSNR:  27.93403635811373
epoch:  31400 loss:  0.01013126876205206 PSNR:  27.961152033870576
epoch:  31600 loss:  0.010092402808368206 PSNR:  28.019566537073352
epoch:  31800 loss:  0.010119760408997536 PSNR:  27.97616358697117
epoch:  32000 loss:  0.010079729370772839 PSNR:  28.06612487175636
epoch:  32200 loss:  0.010189540684223175 PSNR:  27.715721851574145
epoch:  32400 loss:  0.010181340388953686 PSNR:  27.792508711147615
epoch:  32600 loss:  0.010191243141889572 PSNR:  27.779090119973354
epoch:  32800 loss:  0.010158476419746876 PSNR:  27.802370464829252
epoch:  33000 loss:  0.010086111724376678 PSNR:  28.048141787794478
epoch:  33200 loss:  0.01013505645096302 PSNR:  27.935171338946667
epoch:  33400 loss:  0.010170473717153072 PSNR:  27.820907043501336
epoch:  33600 loss:  0.01023489236831665 PSNR:  27.56533024279324
epoch:  33800 loss:  0.010149840265512466 PSNR:  27.91852320643336
epoch:  34000 loss:  0.010165126994252205 PSNR:  27.810978400761574
epoch:  34200 loss:  0.01010815054178238 PSNR:  27.986372731695738
epoch:  34400 loss:  0.010136992670595646 PSNR:  27.880685344083282
epoch:  34600 loss:  0.010097663849592209 PSNR:  27.984916140281484
epoch:  34800 loss:  0.010202008299529552 PSNR:  27.739649722461905
epoch:  35000 loss:  0.010160866193473339 PSNR:  27.753966159955525
epoch:  35200 loss:  0.010081141255795956 PSNR:  28.01577505427786
epoch:  35400 loss:  0.010169032029807568 PSNR:  27.745612343866068
epoch:  35600 loss:  0.010213276371359825 PSNR:  27.745069888241364
epoch:  35800 loss:  0.010118089616298676 PSNR:  27.95149893009478
epoch:  36000 loss:  0.010156091302633286 PSNR:  27.76294743294428
epoch:  36200 loss:  0.010089979507029057 PSNR:  28.023297590164454
epoch:  36400 loss:  0.010163197293877602 PSNR:  27.76581924603758
epoch:  36600 loss:  0.010216489434242249 PSNR:  27.726082605178327
epoch:  36800 loss:  0.010172860696911812 PSNR:  27.686664396635585
epoch:  37000 loss:  0.010159075260162354 PSNR:  27.858675573740626
epoch:  37200 loss:  0.010136643424630165 PSNR:  27.82171707018947
epoch:  37400 loss:  0.010116665624082088 PSNR:  27.95275165040358
epoch:  37600 loss:  0.010128426365554333 PSNR:  27.85777704136219
epoch:  37800 loss:  0.010112123563885689 PSNR:  27.940407673622314
epoch:  38000 loss:  0.010126333683729172 PSNR:  27.898050532180992
epoch:  38200 loss:  0.010125454515218735 PSNR:  27.894821331595857
epoch:  38400 loss:  0.01010512001812458 PSNR:  27.96019905895715
epoch:  38600 loss:  0.010119074955582619 PSNR:  27.90423064385932
epoch:  38800 loss:  0.010181734338402748 PSNR:  27.711737323017836
epoch:  39000 loss:  0.010178936645388603 PSNR:  27.701205027910905
epoch:  39200 loss:  0.010116804391145706 PSNR:  27.895203370502507
epoch:  39400 loss:  0.010101016610860825 PSNR:  27.930666309821426
epoch:  39600 loss:  0.010121030732989311 PSNR:  27.92453621088482
epoch:  39800 loss:  0.010090801864862442 PSNR:  28.000323679178575
PSNR of output image is:  28.000323679178575
(3, 512, 512) (1, 3, 512, 512) (3, 512, 512)
Experiment done
