(3, 512, 512)
4
Noisy PSNR is '20.217724214759798'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Starting optimization with optimizer 'SAM'
Output directory: data/denoising/face/mask/4/unet/det/-0.8/1e-09
epoch:  0 quantization_loss:  0.08505123853683472
p mean is: tensor(-0.0001, device='cuda:2')
epoch:  1000 quantization_loss:  0.07564723491668701
p mean is: tensor(-0.0044, device='cuda:2')
epoch:  2000 quantization_loss:  0.07152319699525833
p mean is: tensor(-0.0076, device='cuda:2')
epoch:  3000 quantization_loss:  0.07252964377403259
p mean is: tensor(-0.0109, device='cuda:2')
epoch:  4000 quantization_loss:  0.07095564156770706
p mean is: tensor(-0.0141, device='cuda:2')
epoch:  5000 quantization_loss:  0.07068221271038055
p mean is: tensor(-0.0174, device='cuda:2')
epoch:  6000 quantization_loss:  0.06807012110948563
p mean is: tensor(-0.0208, device='cuda:2')
epoch:  7000 quantization_loss:  0.052862271666526794
p mean is: tensor(-0.0240, device='cuda:2')
epoch:  8000 quantization_loss:  0.0455867163836956
p mean is: tensor(-0.0281, device='cuda:2')
epoch:  9000 quantization_loss:  0.04064776003360748
p mean is: tensor(-0.0335, device='cuda:2')
epoch:  10000 quantization_loss:  0.03411901742219925
p mean is: tensor(-0.0413, device='cuda:2')
epoch:  11000 quantization_loss:  0.029320189729332924
p mean is: tensor(-0.0519, device='cuda:2')
epoch:  12000 quantization_loss:  0.02807021327316761
p mean is: tensor(-0.0661, device='cuda:2')
epoch:  13000 quantization_loss:  0.02710806019604206
p mean is: tensor(-0.0846, device='cuda:2')
epoch:  14000 quantization_loss:  0.026811983436346054
p mean is: tensor(-0.1084, device='cuda:2')
epoch:  15000 quantization_loss:  0.026268042623996735
p mean is: tensor(-0.1383, device='cuda:2')
epoch:  16000 quantization_loss:  0.025958646088838577
p mean is: tensor(-0.1742, device='cuda:2')
epoch:  17000 quantization_loss:  0.025769853964447975
p mean is: tensor(-0.2155, device='cuda:2')
epoch:  18000 quantization_loss:  0.025531679391860962
p mean is: tensor(-0.2609, device='cuda:2')
epoch:  19000 quantization_loss:  0.02539730817079544
p mean is: tensor(-0.3087, device='cuda:2')
epoch:  20000 quantization_loss:  0.025167765095829964
p mean is: tensor(-0.3566, device='cuda:2')
epoch:  21000 quantization_loss:  0.025050921365618706
p mean is: tensor(-0.4027, device='cuda:2')
epoch:  22000 quantization_loss:  0.024938445538282394
p mean is: tensor(-0.4457, device='cuda:2')
epoch:  23000 quantization_loss:  0.0249636247754097
p mean is: tensor(-0.4850, device='cuda:2')
epoch:  24000 quantization_loss:  0.024767473340034485
p mean is: tensor(-0.5203, device='cuda:2')
epoch:  25000 quantization_loss:  0.02469494566321373
p mean is: tensor(-0.5518, device='cuda:2')
epoch:  26000 quantization_loss:  0.024604929611086845
p mean is: tensor(-0.5796, device='cuda:2')
epoch:  27000 quantization_loss:  0.025616871193051338
p mean is: tensor(-0.6040, device='cuda:2')
epoch:  28000 quantization_loss:  0.0245174840092659
p mean is: tensor(-0.6255, device='cuda:2')
epoch:  29000 quantization_loss:  0.02455262653529644
p mean is: tensor(-0.6443, device='cuda:2')
epoch:  30000 quantization_loss:  0.02443624660372734
p mean is: tensor(-0.6607, device='cuda:2')
epoch:  31000 quantization_loss:  0.024450726807117462
p mean is: tensor(-0.6749, device='cuda:2')
epoch:  32000 quantization_loss:  0.024390431120991707
p mean is: tensor(-0.6875, device='cuda:2')
epoch:  33000 quantization_loss:  0.024366088211536407
p mean is: tensor(-0.6985, device='cuda:2')
epoch:  34000 quantization_loss:  0.024361107498407364
p mean is: tensor(-0.7083, device='cuda:2')
epoch:  35000 quantization_loss:  0.02431238815188408
p mean is: tensor(-0.7168, device='cuda:2')
epoch:  36000 quantization_loss:  0.024312226101756096
p mean is: tensor(-0.7244, device='cuda:2')
epoch:  37000 quantization_loss:  0.02429751679301262
p mean is: tensor(-0.7311, device='cuda:2')
epoch:  38000 quantization_loss:  0.024302799254655838
p mean is: tensor(-0.7371, device='cuda:2')
epoch:  39000 quantization_loss:  0.024272702634334564
p mean is: tensor(-0.7423, device='cuda:2')
epoch:  40000 quantization_loss:  0.02423868700861931
p mean is: tensor(-0.7470, device='cuda:2')
epoch:  41000 quantization_loss:  0.024245597422122955
p mean is: tensor(-0.7513, device='cuda:2')
epoch:  42000 quantization_loss:  0.024223361164331436
p mean is: tensor(-0.7552, device='cuda:2')
epoch:  43000 quantization_loss:  0.024223309010267258
p mean is: tensor(-0.7586, device='cuda:2')
epoch:  44000 quantization_loss:  0.024206189438700676
p mean is: tensor(-0.7618, device='cuda:2')
epoch:  45000 quantization_loss:  0.02420426718890667
p mean is: tensor(-0.7647, device='cuda:2')
epoch:  46000 quantization_loss:  0.024195471778512
p mean is: tensor(-0.7675, device='cuda:2')
epoch:  47000 quantization_loss:  0.024202939122915268
p mean is: tensor(-0.7699, device='cuda:2')
epoch:  48000 quantization_loss:  0.024214379489421844
p mean is: tensor(-0.7722, device='cuda:2')
epoch:  49000 quantization_loss:  0.024175798520445824
p mean is: tensor(-0.7742, device='cuda:2')
epoch:  50000 quantization_loss:  0.024174608290195465
p mean is: tensor(-0.7762, device='cuda:2')
epoch:  51000 quantization_loss:  0.02416049875319004
p mean is: tensor(-0.7780, device='cuda:2')
epoch:  52000 quantization_loss:  0.024152982980012894
p mean is: tensor(-0.7797, device='cuda:2')
epoch:  53000 quantization_loss:  0.0241521168500185
p mean is: tensor(-0.7813, device='cuda:2')
epoch:  54000 quantization_loss:  0.024148643016815186
p mean is: tensor(-0.7828, device='cuda:2')
epoch:  55000 quantization_loss:  0.0241401270031929
p mean is: tensor(-0.7841, device='cuda:2')
epoch:  56000 quantization_loss:  0.024141106754541397
p mean is: tensor(-0.7854, device='cuda:2')
epoch:  57000 quantization_loss:  0.024126794189214706
p mean is: tensor(-0.7867, device='cuda:2')
epoch:  58000 quantization_loss:  0.024131832644343376
p mean is: tensor(-0.7878, device='cuda:2')
epoch:  59000 quantization_loss:  0.024139301851391792
p mean is: tensor(-0.7889, device='cuda:2')
epoch:  60000 quantization_loss:  0.024126630276441574
p mean is: tensor(-0.7900, device='cuda:2')
epoch:  61000 quantization_loss:  0.024119434878230095
p mean is: tensor(-0.7911, device='cuda:2')
epoch:  62000 quantization_loss:  0.02411535382270813
p mean is: tensor(-0.7921, device='cuda:2')
epoch:  63000 quantization_loss:  0.024117110297083855
p mean is: tensor(-0.7929, device='cuda:2')
epoch:  64000 quantization_loss:  0.024108989164233208
p mean is: tensor(-0.7938, device='cuda:2')
epoch:  65000 quantization_loss:  0.02409932389855385
p mean is: tensor(-0.7947, device='cuda:2')
epoch:  66000 quantization_loss:  0.024104997515678406
p mean is: tensor(-0.7956, device='cuda:2')
epoch:  67000 quantization_loss:  0.024109169840812683
p mean is: tensor(-0.7964, device='cuda:2')
epoch:  68000 quantization_loss:  0.024105234071612358
p mean is: tensor(-0.7971, device='cuda:2')
epoch:  69000 quantization_loss:  0.02409973554313183
p mean is: tensor(-0.7979, device='cuda:2')
epoch:  70000 quantization_loss:  0.02410612814128399
p mean is: tensor(-0.7985, device='cuda:2')
epoch:  71000 quantization_loss:  0.024097109213471413
p mean is: tensor(-0.7991, device='cuda:2')
epoch:  72000 quantization_loss:  0.024095255881547928
p mean is: tensor(-0.7998, device='cuda:2')
epoch:  73000 quantization_loss:  0.02408679760992527
p mean is: tensor(-0.8004, device='cuda:2')
epoch:  74000 quantization_loss:  0.024091269820928574
p mean is: tensor(-0.8010, device='cuda:2')
epoch:  75000 quantization_loss:  0.02408653125166893
p mean is: tensor(-0.8017, device='cuda:2')
epoch:  76000 quantization_loss:  0.024085870012640953
p mean is: tensor(-0.8023, device='cuda:2')
epoch:  77000 quantization_loss:  0.024080675095319748
p mean is: tensor(-0.8028, device='cuda:2')
epoch:  78000 quantization_loss:  0.02408413589000702
p mean is: tensor(-0.8033, device='cuda:2')
epoch:  79000 quantization_loss:  0.024091027677059174
p mean is: tensor(-0.8038, device='cuda:2')
1.1.1.weight         | nonzeros =     976 /   12800             (  7.62%) | total_pruned =   11824 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       8 /      16             ( 50.00%) | total_pruned =       8 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =     117 /    6400             (  1.83%) | total_pruned =    6283 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       5 /      16             ( 31.25%) | total_pruned =      11 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =      88 /   12800             (  0.69%) | total_pruned =   12712 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      10 /      32             ( 31.25%) | total_pruned =      22 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =     145 /   25600             (  0.57%) | total_pruned =   25455 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       9 /      32             ( 28.12%) | total_pruned =      23 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =     178 /   51200             (  0.35%) | total_pruned =   51022 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      24 /      64             ( 37.50%) | total_pruned =      40 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =     243 /  102400             (  0.24%) | total_pruned =  102157 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =     106 /  204800             (  0.05%) | total_pruned =  204694 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      59 /     128             ( 46.09%) | total_pruned =      69 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =     329 /  409600             (  0.08%) | total_pruned =  409271 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      73 /     128             ( 57.03%) | total_pruned =      55 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =     523 /  409600             (  0.13%) | total_pruned =  409077 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    3242 /  409600             (  0.79%) | total_pruned =  406358 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =     104 /     128             ( 81.25%) | total_pruned =      24 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   10164 /  409600             (  2.48%) | total_pruned =  399436 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     104 /     128             ( 81.25%) | total_pruned =      24 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   27174 /  409600             (  6.63%) | total_pruned =  382426 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   24388 /  147456             ( 16.54%) | total_pruned =  123068 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   27649 /  147456             ( 18.75%) | total_pruned =  119807 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   24582 /  147456             ( 16.67%) | total_pruned =  122874 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   11008 /   73728             ( 14.93%) | total_pruned =   62720 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      37 /      64             ( 57.81%) | total_pruned =      27 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      37 /      64             ( 57.81%) | total_pruned =      27 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2985 /   18432             ( 16.19%) | total_pruned =   15447 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1284 /    4608             ( 27.86%) | total_pruned =    3324 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      29 /      48             ( 60.42%) | total_pruned =      19 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       0 /       3             (  0.00%) | total_pruned =       3 | shape = torch.Size([3])
alive: 136544, pruned : 2872323, total: 3008867, Compression rate :      22.04x  ( 95.46% pruned)
(3, 512, 512) (3, 512, 512) (3, 512, 512)
PSNR of output image is:  18.160990985712733
Experiment done
