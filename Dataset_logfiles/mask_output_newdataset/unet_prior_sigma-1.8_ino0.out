(3, 256, 256)
Noisy PSNR is '20.14193973579516'
(3, 256, 256) (3, 256, 256) torch.Size([1, 32, 256, 256])
Starting optimization with optimizer 'SAM'
Output directory: data/denoising/Dataset/mask/0/unet/det/-1.8/1e-09
epoch:  0 quantization_loss:  0.058509133756160736
p mean is: tensor(-0.0003, device='cuda:0')
epoch:  1000 quantization_loss:  0.052647948265075684
p mean is: tensor(-0.0079, device='cuda:0')
epoch:  2000 quantization_loss:  0.05157849192619324
p mean is: tensor(-0.0138, device='cuda:0')
epoch:  3000 quantization_loss:  0.05414782837033272
p mean is: tensor(-0.0198, device='cuda:0')
epoch:  4000 quantization_loss:  0.05288112163543701
p mean is: tensor(-0.0261, device='cuda:0')
epoch:  5000 quantization_loss:  0.05275898799300194
p mean is: tensor(-0.0324, device='cuda:0')
epoch:  6000 quantization_loss:  0.05179939791560173
p mean is: tensor(-0.0392, device='cuda:0')
epoch:  7000 quantization_loss:  0.05190875381231308
p mean is: tensor(-0.0460, device='cuda:0')
epoch:  8000 quantization_loss:  0.052140604704618454
p mean is: tensor(-0.0529, device='cuda:0')
epoch:  9000 quantization_loss:  0.05279230698943138
p mean is: tensor(-0.0603, device='cuda:0')
epoch:  10000 quantization_loss:  0.05145327001810074
p mean is: tensor(-0.0677, device='cuda:0')
epoch:  11000 quantization_loss:  0.051405176520347595
p mean is: tensor(-0.0751, device='cuda:0')
epoch:  12000 quantization_loss:  0.05158410593867302
p mean is: tensor(-0.0826, device='cuda:0')
epoch:  13000 quantization_loss:  0.04612536355853081
p mean is: tensor(-0.0906, device='cuda:0')
epoch:  14000 quantization_loss:  0.040848273783922195
p mean is: tensor(-0.1008, device='cuda:0')
epoch:  15000 quantization_loss:  0.035536933690309525
p mean is: tensor(-0.1149, device='cuda:0')
epoch:  16000 quantization_loss:  0.02946203388273716
p mean is: tensor(-0.1340, device='cuda:0')
epoch:  17000 quantization_loss:  0.026433350518345833
p mean is: tensor(-0.1595, device='cuda:0')
epoch:  18000 quantization_loss:  0.023907678201794624
p mean is: tensor(-0.1935, device='cuda:0')
epoch:  19000 quantization_loss:  0.022857854142785072
p mean is: tensor(-0.2379, device='cuda:0')
epoch:  20000 quantization_loss:  0.021472608670592308
p mean is: tensor(-0.2953, device='cuda:0')
epoch:  21000 quantization_loss:  0.020456107333302498
p mean is: tensor(-0.3665, device='cuda:0')
epoch:  22000 quantization_loss:  0.020208710804581642
p mean is: tensor(-0.4521, device='cuda:0')
epoch:  23000 quantization_loss:  0.01967165432870388
p mean is: tensor(-0.5506, device='cuda:0')
epoch:  24000 quantization_loss:  0.019505830481648445
p mean is: tensor(-0.6580, device='cuda:0')
epoch:  25000 quantization_loss:  0.01911972463130951
p mean is: tensor(-0.7690, device='cuda:0')
epoch:  26000 quantization_loss:  0.018810560926795006
p mean is: tensor(-0.8777, device='cuda:0')
epoch:  27000 quantization_loss:  0.018701691180467606
p mean is: tensor(-0.9794, device='cuda:0')
epoch:  28000 quantization_loss:  0.01834636740386486
p mean is: tensor(-1.0715, device='cuda:0')
epoch:  29000 quantization_loss:  0.018195580691099167
p mean is: tensor(-1.1529, device='cuda:0')
epoch:  30000 quantization_loss:  0.01795870065689087
p mean is: tensor(-1.2237, device='cuda:0')
epoch:  31000 quantization_loss:  0.01811283826828003
p mean is: tensor(-1.2852, device='cuda:0')
epoch:  32000 quantization_loss:  0.017693180590867996
p mean is: tensor(-1.3387, device='cuda:0')
epoch:  33000 quantization_loss:  0.0175468847155571
p mean is: tensor(-1.3854, device='cuda:0')
epoch:  34000 quantization_loss:  0.01749955676496029
p mean is: tensor(-1.4260, device='cuda:0')
epoch:  35000 quantization_loss:  0.017436902970075607
p mean is: tensor(-1.4617, device='cuda:0')
epoch:  36000 quantization_loss:  0.01695890724658966
p mean is: tensor(-1.4930, device='cuda:0')
epoch:  37000 quantization_loss:  0.016962548717856407
p mean is: tensor(-1.5206, device='cuda:0')
epoch:  38000 quantization_loss:  0.016903424635529518
p mean is: tensor(-1.5451, device='cuda:0')
epoch:  39000 quantization_loss:  0.01682192273437977
p mean is: tensor(-1.5667, device='cuda:0')
epoch:  40000 quantization_loss:  0.015301273204386234
p mean is: tensor(-1.5859, device='cuda:0')
epoch:  41000 quantization_loss:  0.01483733020722866
p mean is: tensor(-1.6030, device='cuda:0')
epoch:  42000 quantization_loss:  0.014761137776076794
p mean is: tensor(-1.6182, device='cuda:0')
epoch:  43000 quantization_loss:  0.01470969058573246
p mean is: tensor(-1.6318, device='cuda:0')
epoch:  44000 quantization_loss:  0.014688890427350998
p mean is: tensor(-1.6440, device='cuda:0')
epoch:  45000 quantization_loss:  0.014672904275357723
p mean is: tensor(-1.6550, device='cuda:0')
epoch:  46000 quantization_loss:  0.014650044031441212
p mean is: tensor(-1.6651, device='cuda:0')
epoch:  47000 quantization_loss:  0.014615751802921295
p mean is: tensor(-1.6741, device='cuda:0')
epoch:  48000 quantization_loss:  0.014593100175261497
p mean is: tensor(-1.6823, device='cuda:0')
epoch:  49000 quantization_loss:  0.014567511156201363
p mean is: tensor(-1.6898, device='cuda:0')
epoch:  50000 quantization_loss:  0.014566631056368351
p mean is: tensor(-1.6966, device='cuda:0')
epoch:  51000 quantization_loss:  0.014534499496221542
p mean is: tensor(-1.7028, device='cuda:0')
epoch:  52000 quantization_loss:  0.014535283669829369
p mean is: tensor(-1.7084, device='cuda:0')
epoch:  53000 quantization_loss:  0.014518499374389648
p mean is: tensor(-1.7136, device='cuda:0')
epoch:  54000 quantization_loss:  0.01450209878385067
p mean is: tensor(-1.7183, device='cuda:0')
epoch:  55000 quantization_loss:  0.014507967047393322
p mean is: tensor(-1.7226, device='cuda:0')
epoch:  56000 quantization_loss:  0.014488891698420048
p mean is: tensor(-1.7266, device='cuda:0')
epoch:  57000 quantization_loss:  0.01448475755751133
p mean is: tensor(-1.7302, device='cuda:0')
epoch:  58000 quantization_loss:  0.014468582347035408
p mean is: tensor(-1.7336, device='cuda:0')
epoch:  59000 quantization_loss:  0.014466249383985996
p mean is: tensor(-1.7368, device='cuda:0')
epoch:  60000 quantization_loss:  0.014452406205236912
p mean is: tensor(-1.7396, device='cuda:0')
epoch:  61000 quantization_loss:  0.014447852969169617
p mean is: tensor(-1.7423, device='cuda:0')
epoch:  62000 quantization_loss:  0.01444245595484972
p mean is: tensor(-1.7448, device='cuda:0')
epoch:  63000 quantization_loss:  0.014434556476771832
p mean is: tensor(-1.7471, device='cuda:0')
epoch:  64000 quantization_loss:  0.014429938979446888
p mean is: tensor(-1.7493, device='cuda:0')
epoch:  65000 quantization_loss:  0.0144274877384305
p mean is: tensor(-1.7513, device='cuda:0')
epoch:  66000 quantization_loss:  0.01442982628941536
p mean is: tensor(-1.7532, device='cuda:0')
epoch:  67000 quantization_loss:  0.014419936574995518
p mean is: tensor(-1.7549, device='cuda:0')
epoch:  68000 quantization_loss:  0.014455852098762989
p mean is: tensor(-1.7565, device='cuda:0')
epoch:  69000 quantization_loss:  0.014408353716135025
p mean is: tensor(-1.7581, device='cuda:0')
epoch:  70000 quantization_loss:  0.014409626834094524
p mean is: tensor(-1.7596, device='cuda:0')
epoch:  71000 quantization_loss:  0.014392321929335594
p mean is: tensor(-1.7610, device='cuda:0')
epoch:  72000 quantization_loss:  0.014392229728400707
p mean is: tensor(-1.7623, device='cuda:0')
epoch:  73000 quantization_loss:  0.0143892215564847
p mean is: tensor(-1.7635, device='cuda:0')
epoch:  74000 quantization_loss:  0.014391681179404259
p mean is: tensor(-1.7647, device='cuda:0')
epoch:  75000 quantization_loss:  0.014389637857675552
p mean is: tensor(-1.7658, device='cuda:0')
epoch:  76000 quantization_loss:  0.014380769804120064
p mean is: tensor(-1.7668, device='cuda:0')
epoch:  77000 quantization_loss:  0.01438244991004467
p mean is: tensor(-1.7679, device='cuda:0')
epoch:  78000 quantization_loss:  0.014376888051629066
p mean is: tensor(-1.7689, device='cuda:0')
epoch:  79000 quantization_loss:  0.014373569749295712
p mean is: tensor(-1.7698, device='cuda:0')
1.1.1.weight         | nonzeros =      17 /   12800             (  0.13%) | total_pruned =   12783 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       3 /      16             ( 18.75%) | total_pruned =      13 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =       9 /    6400             (  0.14%) | total_pruned =    6391 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       3 /      16             ( 18.75%) | total_pruned =      13 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =       5 /   12800             (  0.04%) | total_pruned =   12795 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =       5 /      32             ( 15.62%) | total_pruned =      27 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =       9 /   25600             (  0.04%) | total_pruned =   25591 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       3 /      32             (  9.38%) | total_pruned =      29 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =       7 /   51200             (  0.01%) | total_pruned =   51193 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =       6 /      64             (  9.38%) | total_pruned =      58 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =       5 /  102400             (  0.00%) | total_pruned =  102395 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =       6 /      64             (  9.38%) | total_pruned =      58 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  204800             (  0.00%) | total_pruned =  204800 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      21 /     128             ( 16.41%) | total_pruned =     107 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      29 /     128             ( 22.66%) | total_pruned =      99 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      46 /     128             ( 35.94%) | total_pruned =      82 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =      29 /  409600             (  0.01%) | total_pruned =  409571 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      54 /     128             ( 42.19%) | total_pruned =      74 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =     437 /  409600             (  0.11%) | total_pruned =  409163 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      74 /     128             ( 57.81%) | total_pruned =      54 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    4435 /  409600             (  1.08%) | total_pruned =  405165 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   15109 /  147456             ( 10.25%) | total_pruned =  132347 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   21191 /  147456             ( 14.37%) | total_pruned =  126265 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      86 /     128             ( 67.19%) | total_pruned =      42 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      86 /     128             ( 67.19%) | total_pruned =      42 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   18452 /  147456             ( 12.51%) | total_pruned =  129004 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      63 /     128             ( 49.22%) | total_pruned =      65 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      63 /     128             ( 49.22%) | total_pruned =      65 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    8087 /   73728             ( 10.97%) | total_pruned =   65641 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2622 /   18432             ( 14.23%) | total_pruned =   15810 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      19 /      32             ( 59.38%) | total_pruned =      13 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1110 /    4608             ( 24.09%) | total_pruned =    3498 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      15 /      16             ( 93.75%) | total_pruned =       1 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      28 /      48             ( 58.33%) | total_pruned =      20 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       0 /       3             (  0.00%) | total_pruned =       3 | shape = torch.Size([3])
alive: 72539, pruned : 2936328, total: 3008867, Compression rate :      41.48x  ( 97.59% pruned)
(3, 256, 256) (3, 256, 256) (3, 256, 256)
PSNR of output image is:  13.513700540387802
Experiment done
