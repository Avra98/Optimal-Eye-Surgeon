(3, 512, 512)
Noisy PSNR is '20.10622698828753'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Starting optimization with optimizer 'SAM'
Output directory: data/denoising/Dataset/mask/4/sparsity/unet/det/0.02/1e-09
epoch:  0 quantization_loss:  0.04537788778543472
p mean is: tensor(-0.0007, device='cuda:3')
epoch:  1000 quantization_loss:  0.039329200983047485
p mean is: tensor(-0.0345, device='cuda:3')
epoch:  2000 quantization_loss:  0.039384160190820694
p mean is: tensor(-0.0585, device='cuda:3')
epoch:  3000 quantization_loss:  0.038608841598033905
p mean is: tensor(-0.0816, device='cuda:3')
epoch:  4000 quantization_loss:  0.037760473787784576
p mean is: tensor(-0.1053, device='cuda:3')
epoch:  5000 quantization_loss:  0.03771085664629936
p mean is: tensor(-0.1307, device='cuda:3')
epoch:  6000 quantization_loss:  0.03830483928322792
p mean is: tensor(-0.1581, device='cuda:3')
epoch:  7000 quantization_loss:  0.037699319422245026
p mean is: tensor(-0.1878, device='cuda:3')
epoch:  8000 quantization_loss:  0.037709709256887436
p mean is: tensor(-0.2199, device='cuda:3')
epoch:  9000 quantization_loss:  0.034473054111003876
p mean is: tensor(-0.2544, device='cuda:3')
epoch:  10000 quantization_loss:  0.03242824599146843
p mean is: tensor(-0.2980, device='cuda:3')
epoch:  11000 quantization_loss:  0.029049035161733627
p mean is: tensor(-0.3539, device='cuda:3')
epoch:  12000 quantization_loss:  0.02656622789800167
p mean is: tensor(-0.4248, device='cuda:3')
epoch:  13000 quantization_loss:  0.025194982066750526
p mean is: tensor(-0.5153, device='cuda:3')
epoch:  14000 quantization_loss:  0.02441222593188286
p mean is: tensor(-0.6285, device='cuda:3')
epoch:  15000 quantization_loss:  0.023351160809397697
p mean is: tensor(-0.7650, device='cuda:3')
epoch:  16000 quantization_loss:  0.021863004192709923
p mean is: tensor(-0.9235, device='cuda:3')
epoch:  17000 quantization_loss:  0.02110925503075123
p mean is: tensor(-1.0972, device='cuda:3')
epoch:  18000 quantization_loss:  0.020445827394723892
p mean is: tensor(-1.2759, device='cuda:3')
epoch:  19000 quantization_loss:  0.019575003534555435
p mean is: tensor(-1.4499, device='cuda:3')
epoch:  20000 quantization_loss:  0.01887786015868187
p mean is: tensor(-1.6117, device='cuda:3')
epoch:  21000 quantization_loss:  0.018467912450432777
p mean is: tensor(-1.7583, device='cuda:3')
epoch:  22000 quantization_loss:  0.01812383532524109
p mean is: tensor(-1.8898, device='cuda:3')
epoch:  23000 quantization_loss:  0.017832577228546143
p mean is: tensor(-2.0074, device='cuda:3')
epoch:  24000 quantization_loss:  0.017462313175201416
p mean is: tensor(-2.1125, device='cuda:3')
epoch:  25000 quantization_loss:  0.017205916345119476
p mean is: tensor(-2.2067, device='cuda:3')
epoch:  26000 quantization_loss:  0.017077909782528877
p mean is: tensor(-2.2918, device='cuda:3')
epoch:  27000 quantization_loss:  0.016852112486958504
p mean is: tensor(-2.3689, device='cuda:3')
epoch:  28000 quantization_loss:  0.016699155792593956
p mean is: tensor(-2.4392, device='cuda:3')
epoch:  29000 quantization_loss:  0.016589123755693436
p mean is: tensor(-2.5037, device='cuda:3')
epoch:  30000 quantization_loss:  0.016453716903924942
p mean is: tensor(-2.5630, device='cuda:3')
epoch:  31000 quantization_loss:  0.016336802393198013
p mean is: tensor(-2.6177, device='cuda:3')
epoch:  32000 quantization_loss:  0.016247546300292015
p mean is: tensor(-2.6685, device='cuda:3')
epoch:  33000 quantization_loss:  0.016196653246879578
p mean is: tensor(-2.7157, device='cuda:3')
epoch:  34000 quantization_loss:  0.01599760539829731
p mean is: tensor(-2.7596, device='cuda:3')
epoch:  35000 quantization_loss:  0.015942370519042015
p mean is: tensor(-2.8007, device='cuda:3')
epoch:  36000 quantization_loss:  0.015866007655858994
p mean is: tensor(-2.8392, device='cuda:3')
epoch:  37000 quantization_loss:  0.015837939456105232
p mean is: tensor(-2.8756, device='cuda:3')
epoch:  38000 quantization_loss:  0.01575484871864319
p mean is: tensor(-2.9098, device='cuda:3')
epoch:  39000 quantization_loss:  0.015706012025475502
p mean is: tensor(-2.9422, device='cuda:3')
epoch:  40000 quantization_loss:  0.015867678448557854
p mean is: tensor(-2.9728, device='cuda:3')
epoch:  41000 quantization_loss:  0.015630800276994705
p mean is: tensor(-3.0018, device='cuda:3')
epoch:  42000 quantization_loss:  0.01559377834200859
p mean is: tensor(-3.0293, device='cuda:3')
epoch:  43000 quantization_loss:  0.015558801591396332
p mean is: tensor(-3.0556, device='cuda:3')
epoch:  44000 quantization_loss:  0.015517866238951683
p mean is: tensor(-3.0807, device='cuda:3')
epoch:  45000 quantization_loss:  0.01552288793027401
p mean is: tensor(-3.1045, device='cuda:3')
epoch:  46000 quantization_loss:  0.015488722361624241
p mean is: tensor(-3.1273, device='cuda:3')
epoch:  47000 quantization_loss:  0.015502252615988255
p mean is: tensor(-3.1491, device='cuda:3')
epoch:  48000 quantization_loss:  0.015466827899217606
p mean is: tensor(-3.1700, device='cuda:3')
epoch:  49000 quantization_loss:  0.015410581603646278
p mean is: tensor(-3.1901, device='cuda:3')
epoch:  50000 quantization_loss:  0.015394835732877254
p mean is: tensor(-3.2094, device='cuda:3')
epoch:  51000 quantization_loss:  0.015365594066679478
p mean is: tensor(-3.2279, device='cuda:3')
epoch:  52000 quantization_loss:  0.015367833897471428
p mean is: tensor(-3.2457, device='cuda:3')
epoch:  53000 quantization_loss:  0.015346014872193336
p mean is: tensor(-3.2627, device='cuda:3')
epoch:  54000 quantization_loss:  0.015317377634346485
p mean is: tensor(-3.2792, device='cuda:3')
epoch:  55000 quantization_loss:  0.01530696265399456
p mean is: tensor(-3.2950, device='cuda:3')
epoch:  56000 quantization_loss:  0.015301820822060108
p mean is: tensor(-3.3103, device='cuda:3')
epoch:  57000 quantization_loss:  0.015321663580834866
p mean is: tensor(-3.3251, device='cuda:3')
epoch:  58000 quantization_loss:  0.015289499424397945
p mean is: tensor(-3.3393, device='cuda:3')
epoch:  59000 quantization_loss:  0.015268547460436821
p mean is: tensor(-3.3531, device='cuda:3')
Number of elements to keep: 60177
Threshold value: 5.658431053161621
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.019999887000655064
Number of elements to keep: 60177
Threshold value: 5.658431053161621
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.019999887000655064
1.1.1.weight         | nonzeros =      65 /   12800             (  0.51%) | total_pruned =   12735 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       3 /      16             ( 18.75%) | total_pruned =      13 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =       4 /    6400             (  0.06%) | total_pruned =    6396 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       2 /      16             ( 12.50%) | total_pruned =      14 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =       0 /   12800             (  0.00%) | total_pruned =   12800 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =       3 /      32             (  9.38%) | total_pruned =      29 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =       0 /   25600             (  0.00%) | total_pruned =   25600 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       3 /      32             (  9.38%) | total_pruned =      29 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =       0 /   51200             (  0.00%) | total_pruned =   51200 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =       3 /      64             (  4.69%) | total_pruned =      61 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =       0 /  102400             (  0.00%) | total_pruned =  102400 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =       3 /      64             (  4.69%) | total_pruned =      61 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  204800             (  0.00%) | total_pruned =  204800 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      10 /     128             (  7.81%) | total_pruned =     118 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      19 /     128             ( 14.84%) | total_pruned =     109 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      50 /     128             ( 39.06%) | total_pruned =      78 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      72 /     128             ( 56.25%) | total_pruned =      56 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =      30 /  409600             (  0.01%) | total_pruned =  409570 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     110 /     128             ( 85.94%) | total_pruned =      18 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    1520 /  409600             (  0.37%) | total_pruned =  408080 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      77 /     128             ( 60.16%) | total_pruned =      51 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      77 /     128             ( 60.16%) | total_pruned =      51 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   13698 /  147456             (  9.29%) | total_pruned =  133758 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      77 /     128             ( 60.16%) | total_pruned =      51 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      77 /     128             ( 60.16%) | total_pruned =      51 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   15666 /  147456             ( 10.62%) | total_pruned =  131790 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   16006 /  147456             ( 10.85%) | total_pruned =  131450 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      87 /     128             ( 67.97%) | total_pruned =      41 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      87 /     128             ( 67.97%) | total_pruned =      41 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    8352 /   73728             ( 11.33%) | total_pruned =   65376 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      38 /      64             ( 59.38%) | total_pruned =      26 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      38 /      64             ( 59.38%) | total_pruned =      26 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2715 /   18432             ( 14.73%) | total_pruned =   15717 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1043 /    4608             ( 22.63%) | total_pruned =    3565 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      13 /      16             ( 81.25%) | total_pruned =       3 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      26 /      48             ( 54.17%) | total_pruned =      22 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       1 /       3             ( 33.33%) | total_pruned =       2 | shape = torch.Size([3])
alive: 60177, pruned : 2948690, total: 3008867, Compression rate :      50.00x  ( 98.00% pruned)
(3, 512, 512) (3, 512, 512) (3, 512, 512)
PSNR of output image is:  14.562483487069276
Experiment done
