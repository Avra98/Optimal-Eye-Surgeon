(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '10.623957405366065'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/3/sparsity/0.5/det/0.8/1e-09
epoch:  0 quantization_loss:  0.03604958951473236
p mean is: tensor(-0.0003, device='cuda:3')
epoch:  1000 quantization_loss:  0.029299871996045113
p mean is: tensor(-0.0136, device='cuda:3')
epoch:  2000 quantization_loss:  0.030099542811512947
p mean is: tensor(-0.0227, device='cuda:3')
epoch:  3000 quantization_loss:  0.028786003589630127
p mean is: tensor(-0.0314, device='cuda:3')
epoch:  4000 quantization_loss:  0.028504174202680588
p mean is: tensor(-0.0401, device='cuda:3')
epoch:  5000 quantization_loss:  0.028114553540945053
p mean is: tensor(-0.0488, device='cuda:3')
epoch:  6000 quantization_loss:  0.027812181040644646
p mean is: tensor(-0.0576, device='cuda:3')
epoch:  7000 quantization_loss:  0.024148711934685707
p mean is: tensor(-0.0667, device='cuda:3')
epoch:  8000 quantization_loss:  0.01931013911962509
p mean is: tensor(-0.0773, device='cuda:3')
epoch:  9000 quantization_loss:  0.015423832461237907
p mean is: tensor(-0.0907, device='cuda:3')
epoch:  10000 quantization_loss:  0.014223822392523289
p mean is: tensor(-0.1089, device='cuda:3')
epoch:  11000 quantization_loss:  0.013312822207808495
p mean is: tensor(-0.1334, device='cuda:3')
epoch:  12000 quantization_loss:  0.01218365877866745
p mean is: tensor(-0.1656, device='cuda:3')
epoch:  13000 quantization_loss:  0.01109252404421568
p mean is: tensor(-0.2068, device='cuda:3')
epoch:  14000 quantization_loss:  0.010522807016968727
p mean is: tensor(-0.2579, device='cuda:3')
epoch:  15000 quantization_loss:  0.009851925075054169
p mean is: tensor(-0.3190, device='cuda:3')
epoch:  16000 quantization_loss:  0.008794247172772884
p mean is: tensor(-0.3888, device='cuda:3')
epoch:  17000 quantization_loss:  0.008610285818576813
p mean is: tensor(-0.4643, device='cuda:3')
epoch:  18000 quantization_loss:  0.008245746605098248
p mean is: tensor(-0.5422, device='cuda:3')
epoch:  19000 quantization_loss:  0.008053218014538288
p mean is: tensor(-0.6190, device='cuda:3')
epoch:  20000 quantization_loss:  0.007880279794335365
p mean is: tensor(-0.6917, device='cuda:3')
epoch:  21000 quantization_loss:  0.007655886933207512
p mean is: tensor(-0.7585, device='cuda:3')
epoch:  22000 quantization_loss:  0.007589844521135092
p mean is: tensor(-0.8186, device='cuda:3')
epoch:  23000 quantization_loss:  0.007441658992320299
p mean is: tensor(-0.8720, device='cuda:3')
epoch:  24000 quantization_loss:  0.007287510205060244
p mean is: tensor(-0.9190, device='cuda:3')
epoch:  25000 quantization_loss:  0.007238042540848255
p mean is: tensor(-0.9601, device='cuda:3')
epoch:  26000 quantization_loss:  0.007191253360360861
p mean is: tensor(-0.9960, device='cuda:3')
epoch:  27000 quantization_loss:  0.007095984648913145
p mean is: tensor(-1.0273, device='cuda:3')
epoch:  28000 quantization_loss:  0.007035105489194393
p mean is: tensor(-1.0548, device='cuda:3')
epoch:  29000 quantization_loss:  0.007021316327154636
p mean is: tensor(-1.0789, device='cuda:3')
epoch:  30000 quantization_loss:  0.0069350008852779865
p mean is: tensor(-1.1001, device='cuda:3')
epoch:  31000 quantization_loss:  0.007022515404969454
p mean is: tensor(-1.1187, device='cuda:3')
epoch:  32000 quantization_loss:  0.006884387694299221
p mean is: tensor(-1.1353, device='cuda:3')
epoch:  33000 quantization_loss:  0.006827096454799175
p mean is: tensor(-1.1499, device='cuda:3')
epoch:  34000 quantization_loss:  0.006782855838537216
p mean is: tensor(-1.1629, device='cuda:3')
epoch:  35000 quantization_loss:  0.0067456504330039024
p mean is: tensor(-1.1745, device='cuda:3')
epoch:  36000 quantization_loss:  0.00672505097463727
p mean is: tensor(-1.1850, device='cuda:3')
epoch:  37000 quantization_loss:  0.0067042335867881775
p mean is: tensor(-1.1944, device='cuda:3')
epoch:  38000 quantization_loss:  0.0066705550998449326
p mean is: tensor(-1.2028, device='cuda:3')
epoch:  39000 quantization_loss:  0.006653038319200277
p mean is: tensor(-1.2104, device='cuda:3')
epoch:  40000 quantization_loss:  0.006642194464802742
p mean is: tensor(-1.2173, device='cuda:3')
epoch:  41000 quantization_loss:  0.006615399848669767
p mean is: tensor(-1.2234, device='cuda:3')
epoch:  42000 quantization_loss:  0.0065916553139686584
p mean is: tensor(-1.2291, device='cuda:3')
epoch:  43000 quantization_loss:  0.0065828245133161545
p mean is: tensor(-1.2343, device='cuda:3')
epoch:  44000 quantization_loss:  0.006568084470927715
p mean is: tensor(-1.2390, device='cuda:3')
epoch:  45000 quantization_loss:  0.006539473310112953
p mean is: tensor(-1.2434, device='cuda:3')
epoch:  46000 quantization_loss:  0.00652898708358407
p mean is: tensor(-1.2473, device='cuda:3')
epoch:  47000 quantization_loss:  0.006516008172184229
p mean is: tensor(-1.2510, device='cuda:3')
epoch:  48000 quantization_loss:  0.006516722962260246
p mean is: tensor(-1.2544, device='cuda:3')
epoch:  49000 quantization_loss:  0.006494477391242981
p mean is: tensor(-1.2575, device='cuda:3')
epoch:  50000 quantization_loss:  0.006490589585155249
p mean is: tensor(-1.2605, device='cuda:3')
epoch:  51000 quantization_loss:  0.006478665396571159
p mean is: tensor(-1.2633, device='cuda:3')
epoch:  52000 quantization_loss:  0.006475592963397503
p mean is: tensor(-1.2659, device='cuda:3')
epoch:  53000 quantization_loss:  0.0064643449150025845
p mean is: tensor(-1.2683, device='cuda:3')
epoch:  54000 quantization_loss:  0.006465479265898466
p mean is: tensor(-1.2705, device='cuda:3')
epoch:  55000 quantization_loss:  0.006462960038334131
p mean is: tensor(-1.2726, device='cuda:3')
epoch:  56000 quantization_loss:  0.006439156364649534
p mean is: tensor(-1.2746, device='cuda:3')
epoch:  57000 quantization_loss:  0.006439299322664738
p mean is: tensor(-1.2765, device='cuda:3')
epoch:  58000 quantization_loss:  0.006432830356061459
p mean is: tensor(-1.2783, device='cuda:3')
epoch:  59000 quantization_loss:  0.006433792412281036
p mean is: tensor(-1.2801, device='cuda:3')
Number of elements to keep: 2407093
Threshold value: -1.3474512100219727
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.7999998005893912
here
Number of elements to keep: 150443
Threshold value: -0.4692308306694031
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
1.1.1.weight         | nonzeros =    9207 /   12800             ( 71.93%) | total_pruned =    3593 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.2.weight           | nonzeros =       6 /      16             ( 37.50%) | total_pruned =      10 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =    4953 /    6400             ( 77.39%) | total_pruned =    1447 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
1.5.weight           | nonzeros =      10 /      16             ( 62.50%) | total_pruned =       6 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =   10002 /   12800             ( 78.14%) | total_pruned =    2798 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =   20694 /   25600             ( 80.84%) | total_pruned =    4906 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      15 /      32             ( 46.88%) | total_pruned =      17 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =   43178 /   51200             ( 84.33%) | total_pruned =    8022 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      26 /      64             ( 40.62%) | total_pruned =      38 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =   88147 /  102400             ( 86.08%) | total_pruned =   14253 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      27 /      64             ( 42.19%) | total_pruned =      37 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =  180016 /  204800             ( 87.90%) | total_pruned =   24784 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      63 /     128             ( 49.22%) | total_pruned =      65 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =  366152 /  409600             ( 89.39%) | total_pruned =   43448 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      58 /     128             ( 45.31%) | total_pruned =      70 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  359802 /  409600             ( 87.84%) | total_pruned =   49798 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      75 /     128             ( 58.59%) | total_pruned =      53 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  334437 /  409600             ( 81.65%) | total_pruned =   75163 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =  297081 /  409600             ( 72.53%) | total_pruned =  112519 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     105 /     128             ( 82.03%) | total_pruned =      23 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =  274614 /  409600             ( 67.04%) | total_pruned =  134986 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      92 /     128             ( 71.88%) | total_pruned =      36 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  110674 /  147456             ( 75.06%) | total_pruned =   36782 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =  113979 /  147456             ( 77.30%) | total_pruned =   33477 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      84 /     128             ( 65.62%) | total_pruned =      44 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =  110950 /  147456             ( 75.24%) | total_pruned =   36506 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =     128 /     128             (100.00%) | total_pruned =       0 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   60208 /   73728             ( 81.66%) | total_pruned =   13520 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =      64 /      64             (100.00%) | total_pruned =       0 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      29 /      64             ( 45.31%) | total_pruned =      35 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      29 /      64             ( 45.31%) | total_pruned =      35 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =   15018 /   18432             ( 81.48%) | total_pruned =    3414 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =      32 /      32             (100.00%) | total_pruned =       0 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      18 /      32             ( 56.25%) | total_pruned =      14 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      18 /      32             ( 56.25%) | total_pruned =      14 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    3085 /    4608             ( 66.95%) | total_pruned =    1523 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.weight             | nonzeros =      15 /      16             ( 93.75%) | total_pruned =       1 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      28 /      48             ( 58.33%) | total_pruned =      20 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       3 /       3             (100.00%) | total_pruned =       0 | shape = torch.Size([3])
alive: 2404997, pruned : 603870, total: 3008867, Compression rate :       1.25x  ( 20.07% pruned)
PSNR of output image is:  18.833866917615325
Experiment done
