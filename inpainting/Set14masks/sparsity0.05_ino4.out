(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '8.733180714612041'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/4/sparsity/0.5/det/0.05/1e-09
epoch:  0 quantization_loss:  0.029103277251124382
p mean is: tensor(-0.0002, device='cuda:4')
epoch:  1000 quantization_loss:  0.02629719488322735
p mean is: tensor(-0.0196, device='cuda:4')
epoch:  2000 quantization_loss:  0.026077458634972572
p mean is: tensor(-0.0383, device='cuda:4')
epoch:  3000 quantization_loss:  0.02604021318256855
p mean is: tensor(-0.0590, device='cuda:4')
epoch:  4000 quantization_loss:  0.025911258533596992
p mean is: tensor(-0.0823, device='cuda:4')
epoch:  5000 quantization_loss:  0.025972582399845123
p mean is: tensor(-0.1072, device='cuda:4')
epoch:  6000 quantization_loss:  0.025416281074285507
p mean is: tensor(-0.1327, device='cuda:4')
epoch:  7000 quantization_loss:  0.023632023483514786
p mean is: tensor(-0.1567, device='cuda:4')
epoch:  8000 quantization_loss:  0.02149771712720394
p mean is: tensor(-0.1848, device='cuda:4')
epoch:  9000 quantization_loss:  0.018796812742948532
p mean is: tensor(-0.2188, device='cuda:4')
epoch:  10000 quantization_loss:  0.016068032011389732
p mean is: tensor(-0.2582, device='cuda:4')
epoch:  11000 quantization_loss:  0.015260337851941586
p mean is: tensor(-0.3044, device='cuda:4')
epoch:  12000 quantization_loss:  0.014297202229499817
p mean is: tensor(-0.3582, device='cuda:4')
epoch:  13000 quantization_loss:  0.013357204385101795
p mean is: tensor(-0.4195, device='cuda:4')
epoch:  14000 quantization_loss:  0.012479431927204132
p mean is: tensor(-0.4864, device='cuda:4')
epoch:  15000 quantization_loss:  0.01122172363102436
p mean is: tensor(-0.5559, device='cuda:4')
epoch:  16000 quantization_loss:  0.010777117684483528
p mean is: tensor(-0.6250, device='cuda:4')
epoch:  17000 quantization_loss:  0.010420388542115688
p mean is: tensor(-0.6919, device='cuda:4')
epoch:  18000 quantization_loss:  0.009642899967730045
p mean is: tensor(-0.7549, device='cuda:4')
epoch:  19000 quantization_loss:  0.009438162669539452
p mean is: tensor(-0.8126, device='cuda:4')
epoch:  20000 quantization_loss:  0.008928663097321987
p mean is: tensor(-0.8645, device='cuda:4')
epoch:  21000 quantization_loss:  0.008603602647781372
p mean is: tensor(-0.9105, device='cuda:4')
epoch:  22000 quantization_loss:  0.008394326083362103
p mean is: tensor(-0.9509, device='cuda:4')
epoch:  23000 quantization_loss:  0.008230009116232395
p mean is: tensor(-0.9866, device='cuda:4')
epoch:  24000 quantization_loss:  0.00811892468482256
p mean is: tensor(-1.0182, device='cuda:4')
epoch:  25000 quantization_loss:  0.007985091768205166
p mean is: tensor(-1.0462, device='cuda:4')
epoch:  26000 quantization_loss:  0.007894284091889858
p mean is: tensor(-1.0708, device='cuda:4')
epoch:  27000 quantization_loss:  0.007813840173184872
p mean is: tensor(-1.0926, device='cuda:4')
epoch:  28000 quantization_loss:  0.007671026978641748
p mean is: tensor(-1.1120, device='cuda:4')
epoch:  29000 quantization_loss:  0.0076617649756371975
p mean is: tensor(-1.1293, device='cuda:4')
epoch:  30000 quantization_loss:  0.007580205332487822
p mean is: tensor(-1.1446, device='cuda:4')
epoch:  31000 quantization_loss:  0.007471153512597084
p mean is: tensor(-1.1583, device='cuda:4')
epoch:  32000 quantization_loss:  0.0073971194215118885
p mean is: tensor(-1.1706, device='cuda:4')
epoch:  33000 quantization_loss:  0.0074641103856265545
p mean is: tensor(-1.1816, device='cuda:4')
epoch:  34000 quantization_loss:  0.007324789185076952
p mean is: tensor(-1.1914, device='cuda:4')
epoch:  35000 quantization_loss:  0.007279271725565195
p mean is: tensor(-1.2003, device='cuda:4')
epoch:  36000 quantization_loss:  0.007234006188809872
p mean is: tensor(-1.2084, device='cuda:4')
epoch:  37000 quantization_loss:  0.007263809442520142
p mean is: tensor(-1.2156, device='cuda:4')
epoch:  38000 quantization_loss:  0.007174530997872353
p mean is: tensor(-1.2222, device='cuda:4')
epoch:  39000 quantization_loss:  0.0071361553855240345
p mean is: tensor(-1.2284, device='cuda:4')
epoch:  40000 quantization_loss:  0.0071729253977537155
p mean is: tensor(-1.2339, device='cuda:4')
epoch:  41000 quantization_loss:  0.007097150199115276
p mean is: tensor(-1.2391, device='cuda:4')
epoch:  42000 quantization_loss:  0.007065551821142435
p mean is: tensor(-1.2438, device='cuda:4')
epoch:  43000 quantization_loss:  0.007066110614687204
p mean is: tensor(-1.2482, device='cuda:4')
epoch:  44000 quantization_loss:  0.007037132978439331
p mean is: tensor(-1.2523, device='cuda:4')
epoch:  45000 quantization_loss:  0.007065450772643089
p mean is: tensor(-1.2559, device='cuda:4')
epoch:  46000 quantization_loss:  0.0070082517340779305
p mean is: tensor(-1.2593, device='cuda:4')
epoch:  47000 quantization_loss:  0.006989916320890188
p mean is: tensor(-1.2626, device='cuda:4')
epoch:  48000 quantization_loss:  0.006985367741435766
p mean is: tensor(-1.2657, device='cuda:4')
epoch:  49000 quantization_loss:  0.00697701470926404
p mean is: tensor(-1.2685, device='cuda:4')
epoch:  50000 quantization_loss:  0.006961347535252571
p mean is: tensor(-1.2712, device='cuda:4')
epoch:  51000 quantization_loss:  0.006958382204174995
p mean is: tensor(-1.2738, device='cuda:4')
epoch:  52000 quantization_loss:  0.006945449858903885
p mean is: tensor(-1.2761, device='cuda:4')
epoch:  53000 quantization_loss:  0.00693521136417985
p mean is: tensor(-1.2785, device='cuda:4')
epoch:  54000 quantization_loss:  0.006937022320926189
p mean is: tensor(-1.2807, device='cuda:4')
epoch:  55000 quantization_loss:  0.006938697304576635
p mean is: tensor(-1.2827, device='cuda:4')
epoch:  56000 quantization_loss:  0.0069201611913740635
p mean is: tensor(-1.2848, device='cuda:4')
epoch:  57000 quantization_loss:  0.006915077101439238
p mean is: tensor(-1.2867, device='cuda:4')
epoch:  58000 quantization_loss:  0.006904545705765486
p mean is: tensor(-1.2885, device='cuda:4')
epoch:  59000 quantization_loss:  0.006901431828737259
p mean is: tensor(-1.2902, device='cuda:4')
Number of elements to keep: 150443
Threshold value: -0.3599072992801666
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
here
Number of elements to keep: 150443
Threshold value: -0.3599072992801666
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
1.1.1.weight         | nonzeros =    1513 /   12800             ( 11.82%) | total_pruned =   11287 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =     235 /    6400             (  3.67%) | total_pruned =    6165 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =     193 /   12800             (  1.51%) | total_pruned =   12607 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      14 /      32             ( 43.75%) | total_pruned =      18 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =     265 /   25600             (  1.04%) | total_pruned =   25335 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =     241 /   51200             (  0.47%) | total_pruned =   50959 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      33 /      64             ( 51.56%) | total_pruned =      31 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =     527 /  102400             (  0.51%) | total_pruned =  101873 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      29 /      64             ( 45.31%) | total_pruned =      35 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =     457 /  204800             (  0.22%) | total_pruned =  204343 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      73 /     128             ( 57.03%) | total_pruned =      55 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =     533 /  409600             (  0.13%) | total_pruned =  409067 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      69 /     128             ( 53.91%) | total_pruned =      59 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =     698 /  409600             (  0.17%) | total_pruned =  408902 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      85 /     128             ( 66.41%) | total_pruned =      43 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    4533 /  409600             (  1.11%) | total_pruned =  405067 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      85 /     128             ( 66.41%) | total_pruned =      43 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   12494 /  409600             (  3.05%) | total_pruned =  397106 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     100 /     128             ( 78.12%) | total_pruned =      28 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   36212 /  409600             (  8.84%) | total_pruned =  373388 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      91 /     128             ( 71.09%) | total_pruned =      37 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   32910 /  147456             ( 22.32%) | total_pruned =  114546 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =     101 /     128             ( 78.91%) | total_pruned =      27 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =     101 /     128             ( 78.91%) | total_pruned =      27 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   30636 /  147456             ( 20.78%) | total_pruned =  116820 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   17013 /  147456             ( 11.54%) | total_pruned =  130443 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      55 /     128             ( 42.97%) | total_pruned =      73 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      55 /     128             ( 42.97%) | total_pruned =      73 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    6875 /   73728             (  9.32%) | total_pruned =   66853 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2541 /   18432             ( 13.79%) | total_pruned =   15891 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      20 /      32             ( 62.50%) | total_pruned =      12 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      20 /      32             ( 62.50%) | total_pruned =      12 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1246 /    4608             ( 27.04%) | total_pruned =    3362 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      29 /      48             ( 60.42%) | total_pruned =      19 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       2 /       3             ( 66.67%) | total_pruned =       1 | shape = torch.Size([3])
alive: 150443, pruned : 2858424, total: 3008867, Compression rate :      20.00x  ( 95.00% pruned)
PSNR of output image is:  18.59019407951103
Experiment done
