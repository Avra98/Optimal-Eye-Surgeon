(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '9.802327998743145'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/11/sparsity/0.5/det/0.02/1e-09
epoch:  0 quantization_loss:  0.03394749015569687
p mean is: tensor(-0.0002, device='cuda:5')
epoch:  1000 quantization_loss:  0.019814113155007362
p mean is: tensor(-0.0184, device='cuda:5')
epoch:  2000 quantization_loss:  0.019024904817342758
p mean is: tensor(-0.0328, device='cuda:5')
epoch:  3000 quantization_loss:  0.01938503421843052
p mean is: tensor(-0.0479, device='cuda:5')
epoch:  4000 quantization_loss:  0.01848953403532505
p mean is: tensor(-0.0638, device='cuda:5')
epoch:  5000 quantization_loss:  0.01829615980386734
p mean is: tensor(-0.0810, device='cuda:5')
epoch:  6000 quantization_loss:  0.018072614446282387
p mean is: tensor(-0.0997, device='cuda:5')
epoch:  7000 quantization_loss:  0.017633315175771713
p mean is: tensor(-0.1196, device='cuda:5')
epoch:  8000 quantization_loss:  0.01594577357172966
p mean is: tensor(-0.1401, device='cuda:5')
epoch:  9000 quantization_loss:  0.015029441565275192
p mean is: tensor(-0.1641, device='cuda:5')
epoch:  10000 quantization_loss:  0.014203524217009544
p mean is: tensor(-0.1947, device='cuda:5')
epoch:  11000 quantization_loss:  0.01350545696914196
p mean is: tensor(-0.2323, device='cuda:5')
epoch:  12000 quantization_loss:  0.01268050167709589
p mean is: tensor(-0.2775, device='cuda:5')
epoch:  13000 quantization_loss:  0.012074444442987442
p mean is: tensor(-0.3311, device='cuda:5')
epoch:  14000 quantization_loss:  0.01159624196588993
p mean is: tensor(-0.3928, device='cuda:5')
epoch:  15000 quantization_loss:  0.011030146852135658
p mean is: tensor(-0.4613, device='cuda:5')
epoch:  16000 quantization_loss:  0.010371415875852108
p mean is: tensor(-0.5338, device='cuda:5')
epoch:  17000 quantization_loss:  0.009829121641814709
p mean is: tensor(-0.6070, device='cuda:5')
epoch:  18000 quantization_loss:  0.009486968629062176
p mean is: tensor(-0.6778, device='cuda:5')
epoch:  19000 quantization_loss:  0.009154785424470901
p mean is: tensor(-0.7442, device='cuda:5')
epoch:  20000 quantization_loss:  0.008924034424126148
p mean is: tensor(-0.8051, device='cuda:5')
epoch:  21000 quantization_loss:  0.008587067015469074
p mean is: tensor(-0.8598, device='cuda:5')
epoch:  22000 quantization_loss:  0.008453723974525928
p mean is: tensor(-0.9084, device='cuda:5')
epoch:  23000 quantization_loss:  0.008280236274003983
p mean is: tensor(-0.9514, device='cuda:5')
epoch:  24000 quantization_loss:  0.00804409384727478
p mean is: tensor(-0.9892, device='cuda:5')
epoch:  25000 quantization_loss:  0.007890322245657444
p mean is: tensor(-1.0225, device='cuda:5')
epoch:  26000 quantization_loss:  0.007832402363419533
p mean is: tensor(-1.0517, device='cuda:5')
epoch:  27000 quantization_loss:  0.007721354253590107
p mean is: tensor(-1.0773, device='cuda:5')
epoch:  28000 quantization_loss:  0.007627971936017275
p mean is: tensor(-1.1000, device='cuda:5')
epoch:  29000 quantization_loss:  0.007552990224212408
p mean is: tensor(-1.1199, device='cuda:5')
epoch:  30000 quantization_loss:  0.007478869520127773
p mean is: tensor(-1.1374, device='cuda:5')
epoch:  31000 quantization_loss:  0.007481429260224104
p mean is: tensor(-1.1530, device='cuda:5')
epoch:  32000 quantization_loss:  0.007386747747659683
p mean is: tensor(-1.1667, device='cuda:5')
epoch:  33000 quantization_loss:  0.007329458370804787
p mean is: tensor(-1.1789, device='cuda:5')
epoch:  34000 quantization_loss:  0.007249852642416954
p mean is: tensor(-1.1898, device='cuda:5')
epoch:  35000 quantization_loss:  0.007220766041427851
p mean is: tensor(-1.1995, device='cuda:5')
epoch:  36000 quantization_loss:  0.0071179671213030815
p mean is: tensor(-1.2082, device='cuda:5')
epoch:  37000 quantization_loss:  0.007063824217766523
p mean is: tensor(-1.2160, device='cuda:5')
epoch:  38000 quantization_loss:  0.007024004589766264
p mean is: tensor(-1.2229, device='cuda:5')
epoch:  39000 quantization_loss:  0.00700586661696434
p mean is: tensor(-1.2292, device='cuda:5')
epoch:  40000 quantization_loss:  0.006976297125220299
p mean is: tensor(-1.2350, device='cuda:5')
epoch:  41000 quantization_loss:  0.006938997656106949
p mean is: tensor(-1.2402, device='cuda:5')
epoch:  42000 quantization_loss:  0.006923983339220285
p mean is: tensor(-1.2450, device='cuda:5')
epoch:  43000 quantization_loss:  0.0069012087769806385
p mean is: tensor(-1.2495, device='cuda:5')
epoch:  44000 quantization_loss:  0.006882962770760059
p mean is: tensor(-1.2535, device='cuda:5')
epoch:  45000 quantization_loss:  0.006877609994262457
p mean is: tensor(-1.2572, device='cuda:5')
epoch:  46000 quantization_loss:  0.0068845138885080814
p mean is: tensor(-1.2606, device='cuda:5')
epoch:  47000 quantization_loss:  0.006842305883765221
p mean is: tensor(-1.2638, device='cuda:5')
epoch:  48000 quantization_loss:  0.006839079316705465
p mean is: tensor(-1.2669, device='cuda:5')
epoch:  49000 quantization_loss:  0.006832071114331484
p mean is: tensor(-1.2696, device='cuda:5')
epoch:  50000 quantization_loss:  0.006822899915277958
p mean is: tensor(-1.2722, device='cuda:5')
epoch:  51000 quantization_loss:  0.006803666241466999
p mean is: tensor(-1.2747, device='cuda:5')
epoch:  52000 quantization_loss:  0.00679802056401968
p mean is: tensor(-1.2770, device='cuda:5')
epoch:  53000 quantization_loss:  0.006793884094804525
p mean is: tensor(-1.2791, device='cuda:5')
epoch:  54000 quantization_loss:  0.006793217267841101
p mean is: tensor(-1.2811, device='cuda:5')
epoch:  55000 quantization_loss:  0.006785442586988211
p mean is: tensor(-1.2831, device='cuda:5')
epoch:  56000 quantization_loss:  0.006777891889214516
p mean is: tensor(-1.2848, device='cuda:5')
epoch:  57000 quantization_loss:  0.006777648814022541
p mean is: tensor(-1.2865, device='cuda:5')
epoch:  58000 quantization_loss:  0.006766641978174448
p mean is: tensor(-1.2882, device='cuda:5')
epoch:  59000 quantization_loss:  0.006766867823898792
p mean is: tensor(-1.2897, device='cuda:5')
Number of elements to keep: 60177
Threshold value: 5.28193473815918
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.019999887000655064
here
Number of elements to keep: 150443
Threshold value: -0.5787660479545593
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
1.1.1.weight         | nonzeros =      54 /   12800             (  0.42%) | total_pruned =   12746 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =       0 /    6400             (  0.00%) | total_pruned =    6400 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =       0 /   12800             (  0.00%) | total_pruned =   12800 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =       4 /      32             ( 12.50%) | total_pruned =      28 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =       0 /   25600             (  0.00%) | total_pruned =   25600 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =       4 /      32             ( 12.50%) | total_pruned =      28 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =       0 /   51200             (  0.00%) | total_pruned =   51200 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =       5 /      64             (  7.81%) | total_pruned =      59 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =       0 /  102400             (  0.00%) | total_pruned =  102400 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      17 /      64             ( 26.56%) | total_pruned =      47 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  204800             (  0.00%) | total_pruned =  204800 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      18 /     128             ( 14.06%) | total_pruned =     110 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      37 /     128             ( 28.91%) | total_pruned =      91 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      76 /     128             ( 59.38%) | total_pruned =      52 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      97 /     128             ( 75.78%) | total_pruned =      31 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  409600             (  0.00%) | total_pruned =  409600 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      94 /     128             ( 73.44%) | total_pruned =      34 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =     604 /  409600             (  0.15%) | total_pruned =  408996 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   16908 /  147456             ( 11.47%) | total_pruned =  130548 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      81 /     128             ( 63.28%) | total_pruned =      47 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   19058 /  147456             ( 12.92%) | total_pruned =  128398 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   13174 /  147456             (  8.93%) | total_pruned =  134282 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      58 /     128             ( 45.31%) | total_pruned =      70 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      58 /     128             ( 45.31%) | total_pruned =      70 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    5622 /   73728             (  7.63%) | total_pruned =   68106 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      32 /      64             ( 50.00%) | total_pruned =      32 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      32 /      64             ( 50.00%) | total_pruned =      32 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2379 /   18432             ( 12.91%) | total_pruned =   16053 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1249 /    4608             ( 27.11%) | total_pruned =    3359 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      15 /      16             ( 93.75%) | total_pruned =       1 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      30 /      48             ( 62.50%) | total_pruned =      18 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       0 /       3             (  0.00%) | total_pruned =       3 | shape = torch.Size([3])
alive: 60177, pruned : 2948690, total: 3008867, Compression rate :      50.00x  ( 98.00% pruned)
PSNR of output image is:  12.824869366173125
Experiment done
