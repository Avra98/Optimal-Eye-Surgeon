(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '9.111373192491204'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/9/sparsity/0.5/det/0.04/1e-09
epoch:  0 quantization_loss:  0.027892811223864555
p mean is: tensor(-0.0002, device='cuda:7')
epoch:  1000 quantization_loss:  0.024502744898200035
p mean is: tensor(-0.0157, device='cuda:7')
epoch:  2000 quantization_loss:  0.023973137140274048
p mean is: tensor(-0.0290, device='cuda:7')
epoch:  3000 quantization_loss:  0.024219220504164696
p mean is: tensor(-0.0425, device='cuda:7')
epoch:  4000 quantization_loss:  0.023936482146382332
p mean is: tensor(-0.0562, device='cuda:7')
epoch:  5000 quantization_loss:  0.024253616109490395
p mean is: tensor(-0.0702, device='cuda:7')
epoch:  6000 quantization_loss:  0.024567630141973495
p mean is: tensor(-0.0844, device='cuda:7')
epoch:  7000 quantization_loss:  0.017765896394848824
p mean is: tensor(-0.0989, device='cuda:7')
epoch:  8000 quantization_loss:  0.015181106515228748
p mean is: tensor(-0.1176, device='cuda:7')
epoch:  9000 quantization_loss:  0.012285399250686169
p mean is: tensor(-0.1422, device='cuda:7')
epoch:  10000 quantization_loss:  0.009826277382671833
p mean is: tensor(-0.1734, device='cuda:7')
epoch:  11000 quantization_loss:  0.00861459318548441
p mean is: tensor(-0.2126, device='cuda:7')
epoch:  12000 quantization_loss:  0.008068887516856194
p mean is: tensor(-0.2606, device='cuda:7')
epoch:  13000 quantization_loss:  0.007608582265675068
p mean is: tensor(-0.3176, device='cuda:7')
epoch:  14000 quantization_loss:  0.007045940961688757
p mean is: tensor(-0.3828, device='cuda:7')
epoch:  15000 quantization_loss:  0.0063431779853999615
p mean is: tensor(-0.4540, device='cuda:7')
epoch:  16000 quantization_loss:  0.005901625845581293
p mean is: tensor(-0.5276, device='cuda:7')
epoch:  17000 quantization_loss:  0.005649670958518982
p mean is: tensor(-0.6005, device='cuda:7')
epoch:  18000 quantization_loss:  0.005384716205298901
p mean is: tensor(-0.6706, device='cuda:7')
epoch:  19000 quantization_loss:  0.0051459018141031265
p mean is: tensor(-0.7359, device='cuda:7')
epoch:  20000 quantization_loss:  0.005028580781072378
p mean is: tensor(-0.7953, device='cuda:7')
epoch:  21000 quantization_loss:  0.004839105531573296
p mean is: tensor(-0.8490, device='cuda:7')
epoch:  22000 quantization_loss:  0.004716453142464161
p mean is: tensor(-0.8966, device='cuda:7')
epoch:  23000 quantization_loss:  0.004588920157402754
p mean is: tensor(-0.9389, device='cuda:7')
epoch:  24000 quantization_loss:  0.004474792629480362
p mean is: tensor(-0.9762, device='cuda:7')
epoch:  25000 quantization_loss:  0.004411873873323202
p mean is: tensor(-1.0090, device='cuda:7')
epoch:  26000 quantization_loss:  0.004352417308837175
p mean is: tensor(-1.0379, device='cuda:7')
epoch:  27000 quantization_loss:  0.004250132013112307
p mean is: tensor(-1.0634, device='cuda:7')
epoch:  28000 quantization_loss:  0.0042344555258750916
p mean is: tensor(-1.0858, device='cuda:7')
epoch:  29000 quantization_loss:  0.004154267720878124
p mean is: tensor(-1.1058, device='cuda:7')
epoch:  30000 quantization_loss:  0.00405162526294589
p mean is: tensor(-1.1235, device='cuda:7')
epoch:  31000 quantization_loss:  0.004037213046103716
p mean is: tensor(-1.1392, device='cuda:7')
epoch:  32000 quantization_loss:  0.004014287609606981
p mean is: tensor(-1.1532, device='cuda:7')
epoch:  33000 quantization_loss:  0.0039457892999053
p mean is: tensor(-1.1656, device='cuda:7')
epoch:  34000 quantization_loss:  0.003931276500225067
p mean is: tensor(-1.1767, device='cuda:7')
epoch:  35000 quantization_loss:  0.0038794241845607758
p mean is: tensor(-1.1868, device='cuda:7')
epoch:  36000 quantization_loss:  0.003845701925456524
p mean is: tensor(-1.1959, device='cuda:7')
epoch:  37000 quantization_loss:  0.0038402886129915714
p mean is: tensor(-1.2041, device='cuda:7')
epoch:  38000 quantization_loss:  0.0037292505148798227
p mean is: tensor(-1.2116, device='cuda:7')
epoch:  39000 quantization_loss:  0.003690015524625778
p mean is: tensor(-1.2182, device='cuda:7')
epoch:  40000 quantization_loss:  0.0037269736640155315
p mean is: tensor(-1.2243, device='cuda:7')
epoch:  41000 quantization_loss:  0.003716543549671769
p mean is: tensor(-1.2299, device='cuda:7')
epoch:  42000 quantization_loss:  0.0037163556553423405
p mean is: tensor(-1.2349, device='cuda:7')
epoch:  43000 quantization_loss:  0.003671384882181883
p mean is: tensor(-1.2395, device='cuda:7')
epoch:  44000 quantization_loss:  0.003587146056815982
p mean is: tensor(-1.2438, device='cuda:7')
epoch:  45000 quantization_loss:  0.0036660463083535433
p mean is: tensor(-1.2478, device='cuda:7')
epoch:  46000 quantization_loss:  0.003645755350589752
p mean is: tensor(-1.2515, device='cuda:7')
epoch:  47000 quantization_loss:  0.0036414091009646654
p mean is: tensor(-1.2549, device='cuda:7')
epoch:  48000 quantization_loss:  0.003630331251770258
p mean is: tensor(-1.2582, device='cuda:7')
epoch:  49000 quantization_loss:  0.003524675965309143
p mean is: tensor(-1.2612, device='cuda:7')
epoch:  50000 quantization_loss:  0.003606663318350911
p mean is: tensor(-1.2640, device='cuda:7')
epoch:  51000 quantization_loss:  0.003618380753323436
p mean is: tensor(-1.2666, device='cuda:7')
epoch:  52000 quantization_loss:  0.00356690539047122
p mean is: tensor(-1.2691, device='cuda:7')
epoch:  53000 quantization_loss:  0.0036107401829212904
p mean is: tensor(-1.2714, device='cuda:7')
epoch:  54000 quantization_loss:  0.0035052811726927757
p mean is: tensor(-1.2736, device='cuda:7')
epoch:  55000 quantization_loss:  0.003495554206892848
p mean is: tensor(-1.2757, device='cuda:7')
epoch:  56000 quantization_loss:  0.0035565088037401438
p mean is: tensor(-1.2778, device='cuda:7')
epoch:  57000 quantization_loss:  0.0034599239006638527
p mean is: tensor(-1.2798, device='cuda:7')
epoch:  58000 quantization_loss:  0.003461067331954837
p mean is: tensor(-1.2816, device='cuda:7')
epoch:  59000 quantization_loss:  0.003521772800013423
p mean is: tensor(-1.2834, device='cuda:7')
Number of elements to keep: 120354
Threshold value: 0.6042529940605164
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.03999977400131013
here
Number of elements to keep: 150443
Threshold value: -0.3282230496406555
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
1.1.1.weight         | nonzeros =    1025 /   12800             (  8.01%) | total_pruned =   11775 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       7 /      16             ( 43.75%) | total_pruned =       9 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =      95 /    6400             (  1.48%) | total_pruned =    6305 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       6 /      16             ( 37.50%) | total_pruned =      10 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =       9 /   12800             (  0.07%) | total_pruned =   12791 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      16 /      32             ( 50.00%) | total_pruned =      16 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =      22 /   25600             (  0.09%) | total_pruned =   25578 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      15 /      32             ( 46.88%) | total_pruned =      17 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =       0 /   51200             (  0.00%) | total_pruned =   51200 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =       4 /  102400             (  0.00%) | total_pruned =  102396 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      35 /      64             ( 54.69%) | total_pruned =      29 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =       0 /  204800             (  0.00%) | total_pruned =  204800 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      68 /     128             ( 53.12%) | total_pruned =      60 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =       1 /  409600             (  0.00%) | total_pruned =  409599 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      75 /     128             ( 58.59%) | total_pruned =      53 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =       5 /  409600             (  0.00%) | total_pruned =  409595 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      98 /     128             ( 76.56%) | total_pruned =      30 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =     402 /  409600             (  0.10%) | total_pruned =  409198 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      97 /     128             ( 75.78%) | total_pruned =      31 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =    3458 /  409600             (  0.84%) | total_pruned =  406142 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     109 /     128             ( 85.16%) | total_pruned =      19 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   23888 /  409600             (  5.83%) | total_pruned =  385712 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      88 /     128             ( 68.75%) | total_pruned =      40 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25164 /  147456             ( 17.07%) | total_pruned =  122292 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      80 /     128             ( 62.50%) | total_pruned =      48 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   26984 /  147456             ( 18.30%) | total_pruned =  120472 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      90 /     128             ( 70.31%) | total_pruned =      38 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   25007 /  147456             ( 16.96%) | total_pruned =  122449 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      78 /     128             ( 60.94%) | total_pruned =      50 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      78 /     128             ( 60.94%) | total_pruned =      50 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =    9060 /   73728             ( 12.29%) | total_pruned =   64668 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      31 /      64             ( 48.44%) | total_pruned =      33 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    2626 /   18432             ( 14.25%) | total_pruned =   15806 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      21 /      32             ( 65.62%) | total_pruned =      11 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1225 /    4608             ( 26.58%) | total_pruned =    3383 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      30 /      48             ( 62.50%) | total_pruned =      18 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       0 /       3             (  0.00%) | total_pruned =       3 | shape = torch.Size([3])
alive: 120354, pruned : 2888513, total: 3008867, Compression rate :      25.00x  ( 96.00% pruned)
PSNR of output image is:  13.101622563966393
Experiment done
