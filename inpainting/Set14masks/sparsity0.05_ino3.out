(3, 512, 512)
(3, 512, 512)
Noisy PSNR is '10.638798788917573'
(3, 512, 512) (3, 512, 512) torch.Size([1, 32, 512, 512])
Output directory: data/inpainting/Set14/mask/3/sparsity/0.5/det/0.05/1e-09
epoch:  0 quantization_loss:  0.04233852028846741
p mean is: tensor(-0.0002, device='cuda:3')
epoch:  1000 quantization_loss:  0.031160691753029823
p mean is: tensor(-0.0135, device='cuda:3')
epoch:  2000 quantization_loss:  0.029351964592933655
p mean is: tensor(-0.0225, device='cuda:3')
epoch:  3000 quantization_loss:  0.029231179505586624
p mean is: tensor(-0.0308, device='cuda:3')
epoch:  4000 quantization_loss:  0.029739554971456528
p mean is: tensor(-0.0389, device='cuda:3')
epoch:  5000 quantization_loss:  0.029475359246134758
p mean is: tensor(-0.0471, device='cuda:3')
epoch:  6000 quantization_loss:  0.029309144243597984
p mean is: tensor(-0.0559, device='cuda:3')
epoch:  7000 quantization_loss:  0.027221865952014923
p mean is: tensor(-0.0651, device='cuda:3')
epoch:  8000 quantization_loss:  0.025338422507047653
p mean is: tensor(-0.0749, device='cuda:3')
epoch:  9000 quantization_loss:  0.019329257309436798
p mean is: tensor(-0.0870, device='cuda:3')
epoch:  10000 quantization_loss:  0.016931340098381042
p mean is: tensor(-0.1021, device='cuda:3')
epoch:  11000 quantization_loss:  0.01612755097448826
p mean is: tensor(-0.1220, device='cuda:3')
epoch:  12000 quantization_loss:  0.013930673711001873
p mean is: tensor(-0.1484, device='cuda:3')
epoch:  13000 quantization_loss:  0.013409065082669258
p mean is: tensor(-0.1830, device='cuda:3')
epoch:  14000 quantization_loss:  0.012459556572139263
p mean is: tensor(-0.2265, device='cuda:3')
epoch:  15000 quantization_loss:  0.011841552332043648
p mean is: tensor(-0.2792, device='cuda:3')
epoch:  16000 quantization_loss:  0.011481131426990032
p mean is: tensor(-0.3408, device='cuda:3')
epoch:  17000 quantization_loss:  0.01057517621666193
p mean is: tensor(-0.4094, device='cuda:3')
epoch:  18000 quantization_loss:  0.009997675195336342
p mean is: tensor(-0.4823, device='cuda:3')
epoch:  19000 quantization_loss:  0.009793889708817005
p mean is: tensor(-0.5566, device='cuda:3')
epoch:  20000 quantization_loss:  0.009620863944292068
p mean is: tensor(-0.6295, device='cuda:3')
epoch:  21000 quantization_loss:  0.009259750135242939
p mean is: tensor(-0.6984, device='cuda:3')
epoch:  22000 quantization_loss:  0.009291447699069977
p mean is: tensor(-0.7620, device='cuda:3')
epoch:  23000 quantization_loss:  0.00918913446366787
p mean is: tensor(-0.8194, device='cuda:3')
epoch:  24000 quantization_loss:  0.008874684572219849
p mean is: tensor(-0.8706, device='cuda:3')
epoch:  25000 quantization_loss:  0.008790519088506699
p mean is: tensor(-0.9159, device='cuda:3')
epoch:  26000 quantization_loss:  0.00864732451736927
p mean is: tensor(-0.9558, device='cuda:3')
epoch:  27000 quantization_loss:  0.008598863147199154
p mean is: tensor(-0.9909, device='cuda:3')
epoch:  28000 quantization_loss:  0.008483457379043102
p mean is: tensor(-1.0218, device='cuda:3')
epoch:  29000 quantization_loss:  0.008483761921525002
p mean is: tensor(-1.0490, device='cuda:3')
epoch:  30000 quantization_loss:  0.008384955115616322
p mean is: tensor(-1.0728, device='cuda:3')
epoch:  31000 quantization_loss:  0.008322433568537235
p mean is: tensor(-1.0939, device='cuda:3')
epoch:  32000 quantization_loss:  0.0082689318805933
p mean is: tensor(-1.1126, device='cuda:3')
epoch:  33000 quantization_loss:  0.008236746303737164
p mean is: tensor(-1.1291, device='cuda:3')
epoch:  34000 quantization_loss:  0.00820500124245882
p mean is: tensor(-1.1437, device='cuda:3')
epoch:  35000 quantization_loss:  0.008142665959894657
p mean is: tensor(-1.1568, device='cuda:3')
epoch:  36000 quantization_loss:  0.008119420148432255
p mean is: tensor(-1.1684, device='cuda:3')
epoch:  37000 quantization_loss:  0.008115449920296669
p mean is: tensor(-1.1789, device='cuda:3')
epoch:  38000 quantization_loss:  0.008067476563155651
p mean is: tensor(-1.1883, device='cuda:3')
epoch:  39000 quantization_loss:  0.008197760209441185
p mean is: tensor(-1.1967, device='cuda:3')
epoch:  40000 quantization_loss:  0.00801100954413414
p mean is: tensor(-1.2044, device='cuda:3')
epoch:  41000 quantization_loss:  0.008021088317036629
p mean is: tensor(-1.2113, device='cuda:3')
epoch:  42000 quantization_loss:  0.007969039492309093
p mean is: tensor(-1.2175, device='cuda:3')
epoch:  43000 quantization_loss:  0.007951983250677586
p mean is: tensor(-1.2233, device='cuda:3')
epoch:  44000 quantization_loss:  0.007945714518427849
p mean is: tensor(-1.2284, device='cuda:3')
epoch:  45000 quantization_loss:  0.00793501827865839
p mean is: tensor(-1.2332, device='cuda:3')
epoch:  46000 quantization_loss:  0.007900838740170002
p mean is: tensor(-1.2375, device='cuda:3')
epoch:  47000 quantization_loss:  0.007880057208240032
p mean is: tensor(-1.2415, device='cuda:3')
epoch:  48000 quantization_loss:  0.00788224209100008
p mean is: tensor(-1.2453, device='cuda:3')
epoch:  49000 quantization_loss:  0.007861355319619179
p mean is: tensor(-1.2487, device='cuda:3')
epoch:  50000 quantization_loss:  0.007839061319828033
p mean is: tensor(-1.2520, device='cuda:3')
epoch:  51000 quantization_loss:  0.007837090641260147
p mean is: tensor(-1.2549, device='cuda:3')
epoch:  52000 quantization_loss:  0.007831044495105743
p mean is: tensor(-1.2577, device='cuda:3')
epoch:  53000 quantization_loss:  0.007807436864823103
p mean is: tensor(-1.2603, device='cuda:3')
epoch:  54000 quantization_loss:  0.007806031499058008
p mean is: tensor(-1.2628, device='cuda:3')
epoch:  55000 quantization_loss:  0.0077912770211696625
p mean is: tensor(-1.2651, device='cuda:3')
epoch:  56000 quantization_loss:  0.007786555215716362
p mean is: tensor(-1.2672, device='cuda:3')
epoch:  57000 quantization_loss:  0.007781067863106728
p mean is: tensor(-1.2693, device='cuda:3')
epoch:  58000 quantization_loss:  0.00778218312188983
p mean is: tensor(-1.2712, device='cuda:3')
epoch:  59000 quantization_loss:  0.007761387154459953
p mean is: tensor(-1.2731, device='cuda:3')
Number of elements to keep: 150443
Threshold value: -0.4625457525253296
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
here
Number of elements to keep: 150443
Threshold value: -0.4625457525253296
Number of elements equal to threshold: 1
Number of elements to randomly select: 1
Actual sparsity achieved: 0.04999988367714492
1.1.1.weight         | nonzeros =    1251 /   12800             (  9.77%) | total_pruned =   11549 | shape = torch.Size([16, 32, 5, 5])
1.1.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.2.weight           | nonzeros =       9 /      16             ( 56.25%) | total_pruned =       7 | shape = torch.Size([16])
1.2.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.4.1.weight         | nonzeros =     162 /    6400             (  2.53%) | total_pruned =    6238 | shape = torch.Size([16, 16, 5, 5])
1.4.1.bias           | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.5.weight           | nonzeros =       5 /      16             ( 31.25%) | total_pruned =      11 | shape = torch.Size([16])
1.5.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
1.7.1.1.1.weight     | nonzeros =     138 /   12800             (  1.08%) | total_pruned =   12662 | shape = torch.Size([32, 16, 5, 5])
1.7.1.1.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.2.weight       | nonzeros =      14 /      32             ( 43.75%) | total_pruned =      18 | shape = torch.Size([32])
1.7.1.2.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.4.1.weight     | nonzeros =     203 /   25600             (  0.79%) | total_pruned =   25397 | shape = torch.Size([32, 32, 5, 5])
1.7.1.4.1.bias       | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.5.weight       | nonzeros =      11 /      32             ( 34.38%) | total_pruned =      21 | shape = torch.Size([32])
1.7.1.5.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.1.7.1.1.1.weight | nonzeros =     295 /   51200             (  0.58%) | total_pruned =   50905 | shape = torch.Size([64, 32, 5, 5])
1.7.1.7.1.1.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.2.weight   | nonzeros =      22 /      64             ( 34.38%) | total_pruned =      42 | shape = torch.Size([64])
1.7.1.7.1.2.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.4.1.weight | nonzeros =     557 /  102400             (  0.54%) | total_pruned =  101843 | shape = torch.Size([64, 64, 5, 5])
1.7.1.7.1.4.1.bias   | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.5.weight   | nonzeros =      26 /      64             ( 40.62%) | total_pruned =      38 | shape = torch.Size([64])
1.7.1.7.1.5.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.1.7.1.1.1.weight | nonzeros =     240 /  204800             (  0.12%) | total_pruned =  204560 | shape = torch.Size([128, 64, 5, 5])
1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.weight | nonzeros =      53 /     128             ( 41.41%) | total_pruned =      75 | shape = torch.Size([128])
1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.4.1.weight | nonzeros =     668 /  409600             (  0.16%) | total_pruned =  408932 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.weight | nonzeros =      64 /     128             ( 50.00%) | total_pruned =      64 | shape = torch.Size([128])
1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =    1002 /  409600             (  0.24%) | total_pruned =  408598 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.weight | nonzeros =      74 /     128             ( 57.81%) | total_pruned =      54 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =    4293 /  409600             (  1.05%) | total_pruned =  405307 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      93 /     128             ( 72.66%) | total_pruned =      35 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.1.1.weight | nonzeros =   12834 /  409600             (  3.13%) | total_pruned =  396766 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.1.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.weight | nonzeros =     102 /     128             ( 79.69%) | total_pruned =      26 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.4.1.weight | nonzeros =   35795 /  409600             (  8.74%) | total_pruned =  373805 | shape = torch.Size([128, 128, 5, 5])
1.7.1.7.1.7.1.7.1.7.1.4.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.weight | nonzeros =      85 /     128             ( 66.41%) | total_pruned =      43 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.1.5.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.weight | nonzeros =      85 /     128             ( 66.41%) | total_pruned =      43 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25981 /  147456             ( 17.62%) | total_pruned =  121475 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.weight | nonzeros =      83 /     128             ( 64.84%) | total_pruned =      45 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.2.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.3.1.weight | nonzeros =   25118 /  147456             ( 17.03%) | total_pruned =  122338 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.1.7.4.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.2.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.2.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.3.1.weight | nonzeros =   22977 /  147456             ( 15.58%) | total_pruned =  124479 | shape = torch.Size([128, 128, 3, 3])
1.7.1.7.1.7.3.1.bias | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.1.7.4.weight | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.1.7.4.bias   | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.2.weight     | nonzeros =      79 /     128             ( 61.72%) | total_pruned =      49 | shape = torch.Size([128])
1.7.1.7.2.bias       | nonzeros =       0 /     128             (  0.00%) | total_pruned =     128 | shape = torch.Size([128])
1.7.1.7.3.1.weight   | nonzeros =   12583 /   73728             ( 17.07%) | total_pruned =   61145 | shape = torch.Size([64, 128, 3, 3])
1.7.1.7.3.1.bias     | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.1.7.4.weight     | nonzeros =      42 /      64             ( 65.62%) | total_pruned =      22 | shape = torch.Size([64])
1.7.1.7.4.bias       | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.2.weight         | nonzeros =      42 /      64             ( 65.62%) | total_pruned =      22 | shape = torch.Size([64])
1.7.2.bias           | nonzeros =       0 /      64             (  0.00%) | total_pruned =      64 | shape = torch.Size([64])
1.7.3.1.weight       | nonzeros =    3652 /   18432             ( 19.81%) | total_pruned =   14780 | shape = torch.Size([32, 64, 3, 3])
1.7.3.1.bias         | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
1.7.4.weight         | nonzeros =      22 /      32             ( 68.75%) | total_pruned =      10 | shape = torch.Size([32])
1.7.4.bias           | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
2.weight             | nonzeros =      22 /      32             ( 68.75%) | total_pruned =      10 | shape = torch.Size([32])
2.bias               | nonzeros =       0 /      32             (  0.00%) | total_pruned =      32 | shape = torch.Size([32])
3.1.weight           | nonzeros =    1395 /    4608             ( 30.27%) | total_pruned =    3213 | shape = torch.Size([16, 32, 3, 3])
3.1.bias             | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
4.weight             | nonzeros =      16 /      16             (100.00%) | total_pruned =       0 | shape = torch.Size([16])
4.bias               | nonzeros =       0 /      16             (  0.00%) | total_pruned =      16 | shape = torch.Size([16])
6.1.weight           | nonzeros =      29 /      48             ( 60.42%) | total_pruned =      19 | shape = torch.Size([3, 16, 1, 1])
6.1.bias             | nonzeros =       1 /       3             ( 33.33%) | total_pruned =       2 | shape = torch.Size([3])
alive: 150443, pruned : 2858424, total: 3008867, Compression rate :      20.00x  ( 95.00% pruned)
PSNR of output image is:  18.085300364535478
Experiment done
